<!DOCTYPE html><html lang="en" class="light" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>SimPEG User Tutorials</title><link rel="stylesheet" href="/user-tutorials/build/_assets/app-LVHQOBTF.css"/><link rel="stylesheet" href="/user-tutorials/build/_assets/thebe-core-SJEQ5G4L.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><script defer="" data-domain="simpeg.xyz" src="https://plausible.io/js/plausible.js"></script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 fixed w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-wrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 013.75 6h16.5a.75.75 0 010 1.5H3.75A.75.75 0 013 6.75zM3 12a.75.75 0 01.75-.75h16.5a.75.75 0 010 1.5H3.75A.75.75 0 013 12zm0 5.25a.75.75 0 01.75-.75h16.5a.75.75 0 010 1.5H3.75a.75.75 0 01-.75-.75z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/user-tutorials/"><span class="text-md sm:text-xl tracking-tight sm:mr-5">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button class="theme rounded-full border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Change theme to dark mode." aria-label="Change theme to dark mode."><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="h-full w-full p-0.5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z"></path></svg></button><div class="block sm:hidden"><div class="relative" data-headlessui-state=""><div><button class="flex text-sm bg-transparent rounded-full focus:outline-none" id="headlessui-menu-button-:Rciop:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Open Menu</span><div class="flex items-center text-stone-200 hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="2rem" height="2rem" class="p-1"><path fill-rule="evenodd" d="M10.5 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zm0 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zm0 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0z" clip-rule="evenodd"></path></svg></div></button></div></div></div><div class="hidden sm:block"><a href="https://mystmd.org/guide" target="_blank" rel="noopener noreferrer" class="inline-block px-4 py-2 mx-1 mt-0 leading-none border rounded text-md border-stone-700 dark:border-white text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 hover:bg-neutral-100">Learn More</a></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><nav aria-label="Table of Contents" class="flex-grow overflow-y-auto transition-opacity mt-6 pb-3 ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="SimPEG User Tutorials" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/user-tutorials/">SimPEG User Tutorials</a><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Gravity" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/gravity-index">Gravity</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:R2d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R2d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Magnetics" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/magnetics-index">Magnetics</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:R3d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R3d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Direct Current Resistivity" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/dcr-index">Direct Current Resistivity</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:R4d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R4d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Induced Polarization" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/ip-index">Induced Polarization</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:R5d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R5d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Frequency-Domain Electromagnetics" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/fdem-index">Frequency-Domain Electromagnetics</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:R6d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R6d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Time-Domain Electromagnetics" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/tdem-index">Time-Domain Electromagnetics</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:R7d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R7d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Uncertainty and Resolution analysis" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/uran-index">Uncertainty and Resolution analysis</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:R8d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R8d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav><div class="flex-none py-4 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><article class="article content article-grid grid-gap" style="margin-top:60px"><main class="article-grid subgrid-gap col-screen"><div class="sticky z-10 hidden h-0 col-margin-right-inset lg:block" style="top:60px"><nav></nav></div><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="pt-5 mb-8"><div class="flex items-center h-6 mt-3 mb-5 text-sm font-light"><div class="flex-grow"></div><a href="https://github.com/simpeg/user-tutorials" title="GitHub Repository: simpeg/user-tutorials" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block"><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative" id="headlessui-menu-button-:R1khtop:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="ml-2 -mr-1"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">1D Forward Simulation for a Single Sounding</h1></div><div id="skip-to-article"></div><div id="Gowwa0HZ0u" class="relative group/block article-grid subgrid-gap col-screen"><aside class="my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden rounded border-l-4 border-green-600"><div class="m-0 font-medium py-1 flex min-w-0 text-lg text-green-600 bg-green-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none text-green-600"><path stroke-linecap="round" stroke-linejoin="round" d="M12 18v-5.25m0 0a6.01 6.01 0 001.5-.189m-1.5.189a6.01 6.01 0 01-1.5-.189m3.75 7.478a12.06 12.06 0 01-4.5 0m3.75 2.383a14.406 14.406 0 01-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 10-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"></path></svg><div class="text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Introductory notebook</div></div><div class="px-4 py-1"><p>This tutorial teaches basic functionality within SimPEG and is a good entry point for new users.</p></div></aside></div><div id="RWAWy6IgSV" class="relative group/block article-grid subgrid-gap col-screen"><aside class="my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden rounded border-l-4 border-green-600"><div class="m-0 font-medium py-1 flex min-w-0 text-lg text-green-600 bg-green-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none text-green-600"><path stroke-linecap="round" stroke-linejoin="round" d="M12 18v-5.25m0 0a6.01 6.01 0 001.5-.189m-1.5.189a6.01 6.01 0 01-1.5-.189m3.75 7.478a12.06 12.06 0 01-4.5 0m3.75 2.383a14.406 14.406 0 01-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 10-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"></path></svg><div class="text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Light-weight notebook</div></div><div class="px-4 py-1"><p>This tutorial requires minimal computational resources and can be executed quickly in the background while other computer processes are running.</p></div></aside></div><div id="NNZHS6BuIS" class="relative group/block article-grid subgrid-gap col-screen"><p><strong>Author:</strong> Devin C. Cowan</p><p><strong>Keywords:</strong> TDEM, forward simulation, waveforms, 1D sounding, wires mapping.</p><p><strong>Summary:</strong> In this tutorial, we present the fundamentals of simulating TDEM data in SimPEG. We use the module <a target="_blank" href="https://docs.simpeg.xyz/content/api/SimPEG.electromagnetics.time_domain.html#module-simpeg.electromagnetics.time_domain" rel="noreferrer">SimPEG<wbr/>.electromagnetics<wbr/>.static<wbr/>.time<wbr/>_domain</a> to simulate TDEM data for a 1D sounding. The <a target="_blank" href="https://docs.simpeg.xyz/content/api/generated/SimPEG.electromagnetics.time_domain.Simulation1DLayered.html#SimPEG.electromagnetics.time_domain.Simulation1DLayered" rel="noreferrer">Simulation1DLayered</a> class is used to solve the problem via a semi-analytic Hankel transform solution. Note that most of what is learned here can be applied to simulating 3D TDEM data.</p><p>The tutorial is organized into 3 parts. In <strong>part 1,</strong> we focus on the most fundamental aspects of simulating TDEM data. For a step-off waveform, we simulate TDEM data for a conductive and non-permeable layered Earth. In <strong>part 2,</strong> we demonstrate how to include dispersive electromagnetic properties in the 1D TDEM simulation. And in <strong>part 3,</strong> we demonstrate how data can be simulated for user-specified transmitter waveforms.</p><p><strong>Learning Objectives:</strong></p><ul><li>The fundamentals of simulating TDEM data with SimPEG.</li><li>Understanding the way in which TDEM surveys are created in SimPEG, which includes:<ul><li>Defining receivers</li><li>Defining controlled sources</li><li>Organizing sources and receivers into a survey object</li></ul></li><li>Defining the Earth’s electrical properties in terms of conductivity OR resistivity.</li><li>Defining the Earth’s electrical properties in terms of conductivity OR resistivity.</li><li>The ways in which we can define 1D layered Earth models.</li><li>Simulating TDEM data for different transmitter waveforms</li><li>Simulating TDEM data for dispersive electromagnetic properties (i.e. induced polarization, superparamagnetism)</li></ul></div><div id="B1pM6khOB3" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="importing-modules" class="relative group"><span class="heading-text">Importing Modules</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#importing-modules" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Here, we import all of the functionality required to run the notebook for the tutorial exercise. All of the functionality specific to TDEM is imported from <a target="_blank" href="https://docs.simpeg.xyz/content/api/SimPEG.electromagnetics.time_domain.html#module-simpeg.electromagnetics.time_domain" rel="noreferrer">SimPEG<wbr/>.electromagnetics<wbr/>.time<wbr/>_domain</a>.
We also import some useful utility functions from <a target="_blank" href="https://docs.simpeg.xyz/content/api/SimPEG.utils.html#module-simpeg.utils" rel="noreferrer">SimPEG.utils</a>.</p></div><div id="iQIf56Bo93" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># SimPEG functionality
import SimPEG.electromagnetics.time_domain as tdem
from SimPEG import maps
from SimPEG.utils import plot_1d_layer_model

# Common Python functionality
import os
import numpy as np
from scipy.constants import mu_0
import matplotlib as mpl
import matplotlib.pyplot as plt

mpl.rcParams.update({&quot;font.size&quot;: 14})

write_output = False  # Optional</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="pgwsTpDeS4Kh1q_LBm5rS" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="wEBpCbvoGS" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="part-1-step-off-response-for-a-conductive-layer" class="relative group"><span class="heading-text">Part 1: Step-Off Response for a Conductive Layer</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#part-1-step-off-response-for-a-conductive-layer" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>In this part of the tutorial, we focus on the most fundamental aspects of simulating TDEM data in SimPEG. Here, the survey consists of a single circular loop located 1 m above the Earth’s surface. The vertical B-field is simulated at the loop’s centre for a step-off waveform.</p></div><div id="qsSqK4uqwE" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="defining-the-survey" class="relative group"><span class="heading-text">Defining the Survey</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#defining-the-survey" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>TDEM surveys within SimPEG require the user to create and connect four types of objects:</p><ul><li><strong>receivers:</strong> There are a multitude of TDEM receiver classes within SimPEG, each of which is used to simulate data corresponding to a different field measurement; e.g. <a target="_blank" href="https://docs.simpeg.xyz/content/api/generated/SimPEG.electromagnetics.time_domain.receivers.PointMagneticField.html#simpeg.electromagnetics.time_domain.receivers.pointmagneticfield" rel="noreferrer">PointMagneticField</a>, <a target="_blank" href="https://docs.simpeg.xyz/content/api/generated/SimPEG.electromagnetics.time_domain.receivers.PointMagneticFluxTimeDerivative.html#simpeg.electromagnetics.time_domain.receivers.pointmagneticfluxtimederivative" rel="noreferrer">PointMagneticFluxTimeDerivative</a> and <a target="_blank" href="https://docs.simpeg.xyz/content/api/generated/SimPEG.electromagnetics.time_domain.receivers.PointElectricField.html#simpeg.electromagnetics.time_domain.receivers.pointelectricfield" rel="noreferrer">PointElectricField</a>. The properties for each TDEM receiver object generally include: the orientation of the field being measured (x, y, z, other), the time channels, the data type, and one or more associated observation locations.</li><li><strong>sources:</strong> There are a multitude of TDEM source classes within SimPEG, each of which corresponds to a different geometry; e.g. <a target="_blank" href="https://docs.simpeg.xyz/content/api/generated/SimPEG.electromagnetics.time_domain.sources.MagDipole.html#simpeg.electromagnetics.time_domain.sources.magdipole" rel="noreferrer">MagDipole</a> and <a target="_blank" href="https://docs.simpeg.xyz/content/api/generated/SimPEG.electromagnetics.time_domain.sources.LineCurrent.html#simpeg.electromagnetics.time_domain.sources.linecurrent" rel="noreferrer">LineCurrent</a>. Source classes generally require the user to define the its current waveform, location and geometry.</li><li><strong>waveforms:</strong> The waveform defining the time-dependent current in the source is defined by an object in SimPEG. Some waveform classes include <a target="_blank" href="https://docs.simpeg.xyz/content/api/generated/SimPEG.electromagnetics.time_domain.sources.StepOffWaveform.html#simpeg.electromagnetics.time_domain.sources.stepoffwaveform" rel="noreferrer">StepOffWaveform</a>, <a target="_blank" href="https://docs.simpeg.xyz/content/api/generated/SimPEG.electromagnetics.time_domain.sources.VTEMWaveform.html#simpeg.electromagnetics.time_domain.sources.vtemwaveform" rel="noreferrer">VTEMWaveform</a> and <a target="_blank" href="https://docs.simpeg.xyz/content/api/generated/SimPEG.electromagnetics.time_domain.sources.RawWaveform.html#simpeg.electromagnetics.time_domain.sources.rawwaveform" rel="noreferrer">RawWaveform</a></li><li><strong>survey:</strong> the object which stores and organizes all of the sources and receivers.</li></ul><p>For a full list of <em>source types</em>, <em>waveform types</em> and <em>receiver types</em>, please visit API documentation for <a target="_blank" href="https://docs.simpeg.xyz/content/api/SimPEG.electromagnetics.time_domain.html#module-simpeg.electromagnetics.time_domain" rel="noreferrer">SimPEG<wbr/>.electromagnetics<wbr/>.time<wbr/>_domain</a>.</p><p><strong>Topography:</strong> When generating the survey for a 1D forward simulation, sources and receivers <strong>must</strong> be located <strong>above</strong> the Earth’s surface. By default, the Earth’s surface is at z = 0 m when defining the 1D simulation. So for 1D FDEM problems, it is easiest to define the z-locations of all sources and receivers as flight heights.</p><p><strong>For this tutorial</strong>, the survey consists of a circular source loop 1 m above the surface that uses a step-off waveform. The vertical component of the magnetic flux density is measured at the loop’s center at a number of time channels.</p></div><div id="vEENQSPCle" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Source properties
source_location = np.array([0.0, 0.0, 1.0])  # (3, ) numpy.array_like
source_orientation = &quot;z&quot;  # &quot;x&quot;, &quot;y&quot; or &quot;z&quot;
source_current = 1.0  # maximum on-time current (A)
source_radius = 10.0  # source loop radius (m)

# Receiver properties
receiver_locations = np.array([0.0, 0.0, 1.0])  # or (N, 3) numpy.ndarray
receiver_orientation = &quot;z&quot;  # &quot;x&quot;, &quot;y&quot; or &quot;z&quot;
times = np.logspace(-5, -2, 31)  # time channels (s)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="shHjmE-dl3txMqcxfPb40" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="f7OXiR2m7I" class="relative group/block article-grid subgrid-gap col-screen"><p>A waveform must be assigned as a property of each TDEM source object. Here, we define a step-off waveform. By default, the off-time for the step-off waveform begins at 0 s. However, the keyword argument <code>off_time</code> can be used to change the start of the off-time.</p></div><div id="oaRjFbpeUb" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">stepoff_waveform = tdem.sources.StepOffWaveform(off_time=0.0)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="-1p-mXu8NkBURB89KfbER" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="Lrw02Kfszb" class="relative group/block article-grid subgrid-gap col-screen"><p>The most general way to generate TDEM surveys is to loop over all sources. A new source object must be created whenever the source location and/or geometry differs. For each source, we define and assign the associated receivers. A different receiver object must be created whenever geometry, data type and/or time channels differ. However, identical data being collected at a multitude of observation locations can be defined using a single receiver object.</p><p><strong>For this tutorial</strong>, we only have a single source. And this source only has a single receiver. More complicated survey geometries are used in the <a target="_blank" href="fwd_tdem_cyl.ipynb" rel="noreferrer">3D Forward Simulation of TDEM Data on Cylindrical Mesh for a Galvanic Source</a> and <a target="_blank" href="/user-tutorials/build/fwd_tdem_3d-e0553bd4fe0c42c7ac3ea78f6559fc2d.ipynb" rel="noreferrer">Forward Simulation of 3D Airborne TDEM Data on a Tree Mesh</a> tutorials. These tutorials demonstrate the more general construction of TDEM surveys.</p></div><div id="G7LxHPZB28" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Define receiver list. In our case, we have only a single receiver for each source.
# When simulating the response for multiple data types for the same source,
# the list consists of multiple receiver objects.
receiver_list = []
receiver_list.append(
    tdem.receivers.PointMagneticFluxDensity(
        receiver_locations, times, orientation=receiver_orientation
    )
)

# Define source list. In our case, we have only a single source.
source_list = [
    tdem.sources.CircularLoop(
        receiver_list=receiver_list,
        location=source_location,
        waveform=stepoff_waveform,
        current=source_current,
        radius=source_radius,
    )
]

# Define the survey
survey = tdem.Survey(source_list)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="S5qeOrdYr_vRzHjbzg3K9" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="KxdFbYAqSx" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="defining-a-1d-layered-earth-and-the-model" class="relative group"><span class="heading-text">Defining a 1D Layered Earth and the Model</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#defining-a-1d-layered-earth-and-the-model" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>In SimPEG, a 1D layered Earth is defined by the set of layer thicknesses and the physical properties for each layer. Thicknesses and physical property values are defined from the top layer down. If we have N layers, we define N physical property values and N-1 layer thicknesses. The lowest layer is assumed to extend to infinity. In the case of a halfspace, the layer thicknesses would be an empty array.</p></div><div id="bcVW6OqG2z" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Layer conductivities
layer_conductivities = np.r_[0.1, 1.0, 0.1]

# Layer thicknesses
layer_thicknesses = np.r_[40.0, 40.0]

# Number of layers
n_layers = len(layer_conductivities)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="uyjnc3iUChYvZZRlIDRLD" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="BCthwjMC5z" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">fig = plt.figure(figsize=(4, 5))
ax1 = fig.add_axes([0.1, 0.1, 0.8, 0.8])
ax1 = plot_1d_layer_model(layer_thicknesses, layer_conductivities, scale=&quot;log&quot;, ax=ax1)
ax1.grid(which=&quot;both&quot;)
ax1.set_xlabel(r&quot;Conductivity ($S/m$)&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="oIMPRGIttZcdlOkaQDbGr" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/user-tutorials/build/c0abd137598f4336b2d6c9d888fbfe56.png" alt="&lt;Figure size 400x500 with 1 Axes&gt;"/></div></div><div id="t13u6pJbCe" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="models-and-mappings-for-1d-simulations" class="relative group"><span class="heading-text">Models and Mappings for 1D Simulations</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#models-and-mappings-for-1d-simulations" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>In SimPEG, the term ‘model’ is not necessarily synonymous with a set of physical property values. For example, the model may be defined as the logarithms of the physical property values, or be the parameters defining a layered Earth geometry. Models in SimPEG are 1D <a target="_blank" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" rel="noreferrer">numpy.ndarray</a> whose lengths are equal to the number of model parameters. For 1D TDEM simulations, we can characterize the Earth’s electric properties according to electrical conductivity or electrical resistivity.</p><p>Classes within the <code>SimPEG.maps</code> module are used to define the mapping that connects the model to the parameters required to run the 1D TDEM simulation; e.g. layer conductivities/resistivities, magnetic permeabilities and/or layer thicknesses. In this part of the tutorial, we demonstrate 2 types of mappings and models that may be used for 1D TDEM simulation.</p><p><strong>1. Conductivity model:</strong> For forward simulation, the easiest approach is to define the model as the layer conductivities and set the layer thicknesses as a static property of the 1D simulation. In this case, the mapping from the model to the conductivities is defined using the <a target="_blank" href="https://docs.simpeg.xyz/content/api/generated/SimPEG.maps.IdentityMap.html#simpeg.maps.identitymap" rel="noreferrer">SimPEG<wbr/>.maps<wbr/>.IdentityMap</a> class.</p><p><strong>2. Parametric layered Earth model:</strong> In this case, the model parameters are log-resistivities and layer thicknesses. We therefore need a mapping that extracts extracts log-resistivities from the model and converts them into resistivities, and a mapping that extracts layer thicknesses from the model. For this, we require the <a target="_blank" href="https://docs.simpeg.xyz/content/api/generated/SimPEG.maps.Wires.html#simpeg.maps.wires" rel="noreferrer">SimPEG.maps.Wires</a> mapping and <a target="_blank" href="https://docs.simpeg.xyz/content/api/generated/SimPEG.maps.ExpMap.html#simpeg.maps.expmap" rel="noreferrer">SimPEG.maps.ExpMap</a> mapping classes. Note that successive mappings can be chained together using the <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∗</mo></mrow><annotation encoding="application/x-tex">*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4653em;"></span><span class="mord">∗</span></span></span></span></span> operator.</p></div><div id="nFtO9BOIIK" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Define model and mapping for a conductivity model.
conductivity_model = layer_conductivities.copy()
conductivity_map = maps.IdentityMap(nP=n_layers)

# Define model and mappings for the parametric model.
# Note the ordering in which you defined the model parameters and the
# order in which you defined the wire mappings matters!!!
parametric_model = np.r_[layer_thicknesses, np.log(1 / layer_conductivities)]
wire_map = maps.Wires((&quot;thicknesses&quot;, n_layers - 1), (&quot;log_resistivity&quot;, n_layers))
thicknesses_map = wire_map.thicknesses
log_resistivity_map = maps.ExpMap() * wire_map.log_resistivity</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="LlA6bd3V8r6p3LQqDHaDb" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="QAz4NkS7oC" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="defining-the-forward-simulation" class="relative group"><span class="heading-text">Defining the Forward Simulation</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#defining-the-forward-simulation" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>In SimPEG, the physics of the forward simulation is defined by creating an instance of an appropriate simulation class. Here, we use the <a target="_blank" href="https://docs.simpeg.xyz/content/api/generated/SimPEG.electromagnetics.time_domain.Simulation1DLayered.html#simpeg.electromagnetics.time_domain.simulation1dlayered" rel="noreferrer">Simulation1DLayered</a> which simulates the data according to a 1D Hankel transform solution. To fully define the forward simulation, we need to connect the simulation object to:</p><ul><li>the survey</li><li>the layer thicknesses</li><li>the physical properties of the layers (e.g. conductivity)</li></ul><p>This is accomplished by setting each one of the aforementioned items as a property of the simulation object. Since the parameters defining the model in each case are different, we must define a separate simulation object for each case.</p><p><strong>1. Conductivity model simulation:</strong> Here, the model parameters are the layer conductivities. <code>sigmaMap</code> is used to define the mapping from the model to the layer conductivities. And <code>thicknessess</code> is used to set the layer thicknesses as a static property of the simulation.</p><p><strong>2. Parametric model simulation:</strong> Here, the model consists of the layer thicknesses and log-resistivities. Because we are now working with electric resistivity, <code>rhoMap</code> is used to define the mapping for the Earth’s electrical properties; i.e. model parameters to layer resistivities. And <code>thicknessesMap</code> is used to define the mapping from the model to the layer thicknesses.</p></div><div id="fDywa3Mrvd" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">simulation_conductivity = tdem.simulation_1d.Simulation1DLayered(
    survey=survey,
    sigmaMap=conductivity_map,
    thicknesses=layer_thicknesses,
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="XyauARSacXN5GkjLaxtuY" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="HzYBmXySS9" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">simulation_parametric = tdem.simulation_1d.Simulation1DLayered(
    survey=survey,
    rhoMap=log_resistivity_map,
    thicknessesMap=thicknesses_map,
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="vZGqJ_WeDMoNhd3su2RPu" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="BT3PES7Qw3" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="predict-1d-tdem-data" class="relative group"><span class="heading-text">Predict 1D TDEM Data</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#predict-1d-tdem-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Once any simulation within SimPEG has been properly constructed, simulated data for a given model vector can be computed using the <a target="_blank" href="https://docs.simpeg.xyz/content/api/generated/SimPEG.simulation.BaseSimulation.dpred.html#simpeg.simulation.basesimulation.dpred" rel="noreferrer">dpred</a> method. Note that despite the difference in how we defined the model, the data predicted for the conductivity and parametric models is the same.</p><p>For surveys consisting of multiple sources, multiple receivers per source and multiple observation locations and time channels per receiver, the predicted data vector is organized:</p><ul><li>by source</li><li>by receiver</li><li>by time channel, then</li><li>by observation location</li></ul></div><div id="hyfQYtxbFb" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">dpred_conductivity = simulation_conductivity.dpred(conductivity_model)
dpred_parametric = simulation_parametric.dpred(parametric_model)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="CRHj4rlalkhXv58HRO0NM" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>C:\Users\devin\anaconda3\lib\site-packages\geoana\kernels\tranverse_electric_reflections.py:37: RuntimeWarning: overflow encountered in tanh
  tanh = np.tanh(u[:-1]*thicknesses[:, None, None])
</span></code></pre></div></div></div><div id="ufi9S63HDm" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">fig = plt.figure(figsize=(5, 6))
ax = fig.add_axes([0.2, 0.15, 0.75, 0.78])
ax.loglog(times, dpred_conductivity, &quot;b-&quot;, lw=3)
ax.loglog(times, dpred_parametric, &quot;r--&quot;, lw=3)
ax.set_xlim([times.min(), times.max()])
ax.grid()
ax.set_xlabel(&quot;Times (s)&quot;)
ax.set_ylabel(&quot;B (T)&quot;)
ax.set_title(&quot;Magnetic Flux Density&quot;)
ax.legend([&quot;Conductivity model&quot;, &quot;Parametric model&quot;])
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="qJp6Q189pLAz4iAQk_rBF" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/user-tutorials/build/ea383b71dd619e9b76f9b92d0340f64d.png" alt="&lt;Figure size 500x600 with 1 Axes&gt;"/></div></div><div id="csAkGS18QL" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="part-2-magnetic-permeability-and-dispersive-physical-properties" class="relative group"><span class="heading-text">Part 2: Magnetic Permeability and Dispersive Physical Properties</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#part-2-magnetic-permeability-and-dispersive-physical-properties" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>In this part of the tutorial, we simulate TDEM data for 3 cases: 1) a conductive and magnetically permeable layer, 2) a conductive and chargeable layer, and 3) a conductive layer with a magnetically viscous top layer. In all cases, the set of model parameters are the layer conductivities from part 1.</p></div><div id="zYvGaoWexQ" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="case-1-the-conductive-layer-is-also-magnetically-permeable" class="relative group"><span class="heading-text">Case 1: the conductive layer is also magnetically permeable</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#case-1-the-conductive-layer-is-also-magnetically-permeable" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>In this case, the middle layer is magnetically permeable in addition to being more conductive than the host. For TDEM simulation classes within SimPEG, the Earth’s magnetic properties are defined as magnetic permeabilities (not susceptibilities). Here, the layer magnetic permeabilities are set as a static property of the simulation using the <code>mu</code> keyword argument. However, one could define a model whose parameters contain the layer magnetic permeabilities; see the <a href="/user-tutorials/fwd-fdem-1d">1D Forward Simulation of Frequency Domain EM Data for a Single Sounding</a> tutorial. This would require the user set <code>muMap</code>.</p></div><div id="M4aEhzKLxt" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">layer_susceptibilities = np.r_[0.0, 9.0, 0.0]
layer_permeabilities = mu_0 * (1 + layer_susceptibilities)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="qAigr2Xxo9JO_hRnRdXUH" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="zenZVl6S6a" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">simulation_permeable = tdem.simulation_1d.Simulation1DLayered(
    survey=survey,
    sigmaMap=conductivity_map,
    thicknesses=layer_thicknesses,
    mu=layer_permeabilities,
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="26G4uMufmrefMdyupXhfE" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="E6NuWOW5Qx" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">dpred_permeable = simulation_permeable.dpred(conductivity_model)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="u51JB7dUWp6_b7rI-iYOc" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="L23POQroTn" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="case-2-the-middle-layer-is-also-chargeable-induced-polarization" class="relative group"><span class="heading-text">Case 2: the middle layer is also chargeable (induced polarization)</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#case-2-the-middle-layer-is-also-chargeable-induced-polarization" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>In this case, the middle layer exhibits an induced polarization (IP) response. In SimPEG, we use the Cole-Cole model to characterize the dispersive conductivity, see <a target="_blank" href="https://em.geosci.xyz/content/physical_properties/electrical_conductivity/index.html#chargeability-and-frequency-dependence" rel="noreferrer">EM GeoSci</a>:</p><div id="x58vH4RqwG" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>σ</mi><mrow><mi>i</mi><mi>p</mi></mrow></msub><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo><mo>=</mo><mi>σ</mi><mrow><mo fence="true">[</mo><mn>1</mn><mo>−</mo><mfrac><mi>η</mi><mrow><mn>1</mn><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>η</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>i</mi><mi>ω</mi><mi>τ</mi><msup><mo stretchy="false">)</mo><mi>C</mi></msup></mrow></mfrac><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\sigma_{ip} (\omega) = \sigma \left [ 1 - \frac{\eta}{1 + (1-\eta )(i\omega \tau)^C} \right ]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">iω</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7673em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">η</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="select-none no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit hover:underline" href="#x58vH4RqwG" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->1<!-- -->)</a></div></div><p>where:</p><ul><li>ω<!-- --> is the radial frequency (rad/s)</li><li>σ<!-- --> is the infinity frequency electrical conductivity (S/m)</li><li><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>η</mi><mo>≤</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0 &lt; \eta \leq 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6835em;vertical-align:-0.0391em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span> is the intrinsic chargeability (unitless)</li><li><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>τ</mi></mrow><annotation encoding="application/x-tex">0 &lt; \tau</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6835em;vertical-align:-0.0391em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span></span></span></span></span> is the central time-relaxation constant (s)</li><li><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>C</mi><mo>≤</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0 \leq C \leq 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span> (unitless) defines the distribution of time-relaxation constants. A Debye model is <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">C=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span>.</li></ul><p>When electrical conductivities <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>σ</mi><mi mathvariant="normal">∞</mi></msub></mrow><annotation encoding="application/x-tex">\sigma_\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> are model parameters, <code>sigmaMap</code> sets the mapping from the model to the layer conductivities. In rare instances, electrical conductivities are set directly using the <code>sigma</code> keyword argument. Unfortunately, SimPEG does not currently have the ability to include the additional parameters used to define dispersive electrical conductivities in the model. As such, these parameters are set as static parameters of the simulation class using the <code>eta</code>, <code>tau</code> and <code>C</code> keyword arguments.</p><p><strong>Important:</strong> In order for the 1D simulation to model dispersive conductivities correctly, none of the values used to set <code>eta</code> can be equal to zero, even if the layer is non-chargeable. To model non-chargeable layers, simply set the value to something small.</p></div><div id="sQD49CpJID" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">eta = 0.5  # intrinsic chargeability [0, 1]
tau = 0.001  # central time-relaxation constant in seconds
c = 0.8  # phase constant [0, 1]

layer_eta = np.r_[1e-10, eta, 1e-10]
layer_tau = np.r_[0.0, tau, 0.0]
layer_c = np.r_[0.0, c, 0.0]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="I347O7HRdgLj2JG9CqddO" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="Qa8TJ0LaIG" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">simulation_ip = tdem.Simulation1DLayered(
    survey=survey,
    thicknesses=layer_thicknesses,
    sigmaMap=conductivity_map,
    eta=layer_eta,
    tau=layer_tau,
    c=layer_c,
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="rVnNwfW79lPcK2gC52Qc7" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="AceB4KFBo0" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">dpred_ip = simulation_ip.dpred(conductivity_model)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="hSqfZbYGWk1_nw9OeG4JD" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="OhLml5leFw" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="case-3-the-top-layer-exhibits-superparamagnetism-spm" class="relative group"><span class="heading-text">Case 3: the top layer exhibits superparamagnetism (SPM)</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#case-3-the-top-layer-exhibits-superparamagnetism-spm" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>In this case, the top layer exhibits superparamagnetism (or viscous remanent magnetization). In SimPEG, we use a log-uniform distribution of time relaxation constants to define the dispersive magnetization, see <a target="_blank" href="https://em.geosci.xyz/content/physical_properties/magnetic_permeability/magnetic_permeability_frequency_dependent.html" rel="noreferrer">EM GeoSci</a>:</p><div id="gDkSUSiB9u" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>μ</mi><mrow><mi>s</mi><mi>p</mi><mi>m</mi></mrow></msub><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo><mo>=</mo><mi>μ</mi><mo>+</mo><msub><mi>μ</mi><mn>0</mn></msub><mi mathvariant="normal">Δ</mi><mi>χ</mi><mo fence="false" stretchy="true" minsize="3em" maxsize="3em">[</mo><mn>1</mn><mo>−</mo><mo fence="false" stretchy="true" minsize="3em" maxsize="3em">(</mo><mfrac><mn>1</mn><mrow><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><msub><mi>τ</mi><mn>2</mn></msub><mi mathvariant="normal">/</mi><msub><mi>τ</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mfrac><mo fence="false" stretchy="true" minsize="3em" maxsize="3em">)</mo><mi>l</mi><mi>n</mi><mo fence="false" stretchy="true" minsize="3em" maxsize="3em">(</mo><mfrac><mrow><mn>1</mn><mo>+</mo><mi>i</mi><mi>ω</mi><msub><mi>τ</mi><mn>2</mn></msub></mrow><mrow><mn>1</mn><mo>+</mo><mi>i</mi><mi>ω</mi><msub><mi>τ</mi><mn>1</mn></msub></mrow></mfrac><mo stretchy="false">)</mo><mo fence="false" stretchy="true" minsize="3em" maxsize="3em">)</mo><mo fence="false" stretchy="true" minsize="3em" maxsize="3em">]</mo></mrow><annotation encoding="application/x-tex">\mu_{spm}(\omega ) = \mu + \mu_0 \Delta \chi \Bigg [
1 - \Bigg ( \frac{1}{ln (\tau_2 / \tau_1 )} \Bigg )
ln \Bigg ( \frac{1 + i\omega \tau_2}{1 + i\omega \tau_1} ) \Bigg )
\Bigg ]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">μ</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">Δ</span><span class="mord mathnormal">χ</span><span class="mord"><span class="delimsizing size4">[</span></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="mord"><span class="delimsizing size4">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="delimsizing size4">)</span></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">n</span><span class="mord"><span class="delimsizing size4">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3365em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">iω</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">iω</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mord"><span class="delimsizing size4">)</span></span><span class="mord"><span class="delimsizing size4">]</span></span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="select-none no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit hover:underline" href="#gDkSUSiB9u" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->2<!-- -->)</a></div></div><p>where:</p><ul><li>ω<!-- --> is the radial frequency (rad/s)</li><li><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\mu_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> is the permeability of free space</li><li>μ<!-- --> is the infinity frequency magnetic permeability</li><li><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><mi mathvariant="normal">Δ</mi><mi>χ</mi></mrow><annotation encoding="application/x-tex">0\leq \Delta \chi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord">Δ</span><span class="mord mathnormal">χ</span></span></span></span></span> (unitless) is the DC susceptibility for the SPM effect</li><li><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><msub><mi>τ</mi><mn>1</mn></msub><mo>&lt;</mo><msub><mi>τ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">0 &lt; \tau_1 &lt; \tau_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6835em;vertical-align:-0.0391em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> are the lower and upper bounds for the log-uniform distribution of time-relaxation constants</li></ul><p>When magnetic permeabilities <!-- -->μ<!-- --> are model parameters, <code>muMap</code> sets the mapping from the model to the layer permeabilities. In rare instances, magnetic permeabilities are set directly using the <code>mu</code> keyword argument. Unfortunately, SimPEG does not currently have the ability to include the additional parameters used to define dispersive magnetic permeability in the model. As such, these parameters are set as static parameters of the simulation class using the <code>dchi</code>, <code>tau1</code> and <code>tau2</code> keyword arguments.</p></div><div id="WCvUT0VO6W" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">chi = 0.01  # infinite susceptibility in SI
dchi = 0.01  # amplitude of frequency-dependent susceptibility contribution
tau1 = 1e-7  # lower limit for time relaxation constants in seconds
tau2 = 1.0  # upper limit for time relaxation constants in seconds

layer_mu = mu_0 * (1 + chi * np.r_[1.0, 0.0, 0.0])  # convert to permeability
layer_dchi = chi * np.r_[1.0, 0.0, 0.0]
layer_tau1 = tau1 * np.r_[1.0, 0.0, 0.0]
layer_tau2 = tau1 * np.r_[1.0, 0.0, 0.0]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="lNrFL6mGyDek5qmzvi_Sz" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="BHzIpOJgnF" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">simulation_spm = tdem.Simulation1DLayered(
    survey=survey,
    thicknesses=layer_thicknesses,
    sigmaMap=conductivity_map,
    mu=mu_0,
    dchi=dchi,
    tau1=tau1,
    tau2=tau2,
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="4tad-N-NjzmUUjg4aW5hz" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="wS2HC1hn3x" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">dpred_spm = simulation_spm.dpred(conductivity_model)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="HX6TbutdqLuUXi1XpgxcV" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="DdMYpezCzQ" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">fig = plt.figure(figsize=(5, 6))
ax1 = fig.add_axes([0.1, 0.1, 0.8, 0.85])
ax1.loglog(times, np.abs(dpred_conductivity[0 : len(times)]), &quot;k&quot;, lw=2)
ax1.loglog(times, np.abs(dpred_permeable[0 : len(times)]), &quot;r&quot;, lw=2)
ax1.loglog(times, np.abs(dpred_ip[0 : len(times)]), &quot;b&quot;, lw=2)
ax1.loglog(times, np.abs(dpred_spm[0 : len(times)]), &quot;g&quot;, lw=2)
ax1.set_xlim([times.min(), times.max()])
ax1.grid()
ax1.legend(
    [
        &quot;Conductive layer&quot;,
        &quot;Conductive and permeable&quot;,
        &quot;Conductive and chargeable&quot;,
        &quot;Superparamagnetic case&quot;,
    ]
)
ax1.set_xlabel(&quot;Times (s)&quot;)
ax1.set_ylabel(&quot;B (T)&quot;)
ax1.set_title(&quot;Magnetic Flux Density&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="MLJb4Buzedz6Qgckn8lUs" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/user-tutorials/build/0b8dec03deced793a201f48416de982d.png" alt="&lt;Figure size 500x600 with 1 Axes&gt;"/></div></div><div id="SrFTTeE7Jc" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="part-3-simulation-for-different-waveforms" class="relative group"><span class="heading-text">Part 3: Simulation for Different Waveforms</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#part-3-simulation-for-different-waveforms" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>In this part of the tutorial, we simulate TDEM data for various transmitter waveforms using a single survey object. As we learned in part 1, each waveform will require the construction of a different source object. For any waveform object, the <a target="_blank" href="https://docs.simpeg.xyz/content/api/generated/SimPEG.electromagnetics.time_domain.sources.BaseWaveform.eval.html#simpeg.electromagnetics.time_domain.sources.basewaveform.eval" rel="noreferrer">eval</a> method can be used to evaluate the waveform at the time provided.</p></div><div id="nX7U9cITL0" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="defining-different-waveforms" class="relative group"><span class="heading-text">Defining Different Waveforms</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#defining-different-waveforms" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="PVtQIVXdcI" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Rectangular waveform. The user may customize the waveform by setting the start
# time, end time and on time amplitude for the current waveform.
eps = 1e-6
ramp_on = np.r_[-0.004, -0.004 + eps]
ramp_off = np.r_[-eps, 0.0]
rectangular_waveform = tdem.sources.TrapezoidWaveform(
    ramp_on=ramp_on, ramp_off=ramp_off
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="f4-O_f751m2InfmNMesSf" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="Bs0q76cle8" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Triangular waveform. The user may customize the waveform by setting the start
# time, peak time, end time and peak amplitude for the current waveform.
eps = 1e-8
start_time = -0.02
peak_time = -0.01
off_time = 0.0
triangle_waveform = tdem.sources.TriangularWaveform(
    start_time=start_time, peak_time=peak_time, off_time=off_time
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="mD_DZ3Ri9EbEvk1siLJbK" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="iotumW8ELa" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># General waveform. This is a fully general way to define the waveform.
# The use simply provides times and the current.
def custom_waveform(t, tmax):
    out = np.cos(0.5 * np.pi * (t - tmax) / (tmax + 0.02))
    out[t &gt;= tmax] = 1 + (t[t &gt;= tmax] - tmax) / tmax
    return out


waveform_times = np.r_[np.linspace(-0.02, -0.011, 10), -np.logspace(-2, -6, 61), 0.0]
waveform_current = custom_waveform(waveform_times, -0.0055)
general_waveform = tdem.sources.PiecewiseLinearWaveform(
    times=waveform_times, currents=waveform_current
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="GWVM7vrPFuWpMSWoCzkt7" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="N2soIlfwcS" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">fig = plt.figure(figsize=(6, 4))
ax = fig.add_axes([0.1, 0.1, 0.85, 0.8])

ax.plot(np.r_[-2e-2, 0.0, 1e-10, 1e-3], np.r_[1.0, 1.0, 0.0, 0.0], &quot;k&quot;, lw=2)
plotting_current = [rectangular_waveform.eval(t) for t in waveform_times]
ax.plot(waveform_times, plotting_current, &quot;b&quot;, lw=2)
plotting_current = [triangle_waveform.eval(t) for t in waveform_times]
ax.plot(waveform_times, plotting_current, &quot;r&quot;, lw=2)
plotting_current = [general_waveform.eval(t) for t in waveform_times]
ax.plot(waveform_times, plotting_current, &quot;g&quot;, lw=2)

ax.grid()
ax.set_xlim([waveform_times.min(), 1e-3])
ax.set_xlabel(&quot;Time (s)&quot;)
ax.set_ylabel(&quot;Current (A)&quot;)
ax.set_title(&quot;Waveforms&quot;)
ax.legend([&quot;Step-off&quot;, &quot;Rectangular&quot;, &quot;Triangle&quot;, &quot;General&quot;], loc=&quot;lower left&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="f7rkipEqFXplYsFIEWSoj" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/user-tutorials/build/06e45a6f2380215cf86c2807770af51c.png" alt="&lt;Figure size 600x400 with 1 Axes&gt;"/></div></div><div id="wvyUSQBM6b" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="designing-a-survey-with-multiple-sources" class="relative group"><span class="heading-text">Designing a Survey with Multiple Sources</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#designing-a-survey-with-multiple-sources" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="ikCGDIUuB4" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">waveforms_list = [
    stepoff_waveform,
    rectangular_waveform,
    triangle_waveform,
    general_waveform,
]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ySQ8DdGHgzzznG-L6uI7M" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="E4LRhPZBgw" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">source_list_multi = []

for w in waveforms_list:
    receiver_list_multi = [
        tdem.receivers.PointMagneticFluxDensity(
            receiver_locations, times, orientation=receiver_orientation
        )
    ]

    source_list_multi.append(
        tdem.sources.CircularLoop(
            receiver_list=receiver_list_multi,
            location=source_location,
            waveform=w,
            current=source_current,
            radius=source_radius,
        )
    )

# Define the survey
survey_multi = tdem.Survey(source_list_multi)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="VVuixLnH2LospQE88jTXw" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="osrkc9dliC" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">simulation_waveforms = tdem.Simulation1DLayered(
    survey=survey_multi, thicknesses=layer_thicknesses, sigmaMap=conductivity_map
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="d6LcbGswR2nZBvyvfnexE" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="wnzEwYsv8q" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">dpred_waveforms = simulation_waveforms.dpred(conductivity_model)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="HJaAjSH6tz6lMcaiU4iyc" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="NlsfdqbrDk" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">fig = plt.figure(figsize=(5, 6))
d = np.reshape(dpred_waveforms, (len(source_list_multi), len(times))).T
ax = fig.add_axes([0.15, 0.15, 0.8, 0.75])
colorlist = [&quot;k&quot;, &quot;b&quot;, &quot;r&quot;, &quot;g&quot;]
for ii, k in enumerate(colorlist):
    ax.loglog(times, np.abs(d[:, ii]), k, lw=2)

ax.set_xlim([times.min(), times.max()])
ax.grid()
ax.legend([&quot;Step-off&quot;, &quot;Rectangular&quot;, &quot;Triangle&quot;, &quot;General&quot;])
ax.set_xlabel(&quot;Times (s)&quot;)
ax.set_ylabel(&quot;B (T)&quot;)
ax.set_title(&quot;Magnetic Flux Density&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="O_h6yiatKa0wiVDsxLvpe" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/user-tutorials/build/fcae6e583b507243d22b7d0f341c9b3c.png" alt="&lt;Figure size 500x600 with 1 Axes&gt;"/></div></div><div id="AiVTGcwWuA" class="relative group/block article-grid subgrid-gap col-screen"><p><strong>Optional:</strong> Write data</p></div><div id="FS9qN10PSh" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">if write_output:
    dir_path = os.path.sep.join([&quot;.&quot;, &quot;fwd_tdem_1d_outputs&quot;]) + os.path.sep
    if not os.path.exists(dir_path):
        os.mkdir(dir_path)

    np.random.seed(347)
    noise = (
        0.05
        * np.abs(dpred_conductivity)
        * np.random.normal(size=len(dpred_conductivity))
    )
    dpred_conductivity += noise
    fname = dir_path + &quot;em1dtm_data.txt&quot;
    np.savetxt(fname, np.c_[times, dpred_conductivity], fmt=&quot;%.4e&quot;, header=&quot;TIME BZ&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="xJ0zkx3MxfPz-4X2XKFQx" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/user-tutorials/tdem-index"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">SimPEG User Tutorials</div>Time-Domain Electromagnetics</div></div></a><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/user-tutorials/fwd-tdem-fundamentals"><div class="flex h-full align-middle"><div class="flex-grow"><div class="text-xs text-gray-500 dark:text-gray-400">SimPEG User Tutorials</div>Fundamentals of Finite Volume for TDEM Simulations</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3"></path></svg></div></a></div></main></article><script>((l,d)=>{if(!window.history.state||!window.history.state.key){let f=Math.random().toString(32).slice(2);window.history.replaceState({key:f},"")}try{let p=JSON.parse(sessionStorage.getItem(l)||"{}")[d||window.history.state.key];typeof p=="number"&&window.scrollTo(0,p)}catch(f){console.error(f),sessionStorage.removeItem(l)}})("positions", null)</script><link rel="modulepreload" href="/user-tutorials/build/entry.client-K6EYMIDZ.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-FBLNPC3V.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-XJN3BT5Q.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-JPGYAJQ3.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-YAIQ7LUU.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-JOLZ6LZB.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-XIW7RL3H.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-I634YBN3.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-MITWS4PZ.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-M5ZDOVXY.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-6TYLRLOL.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-UZHI4RYQ.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-RTIGS2T3.js"/><link rel="modulepreload" href="/user-tutorials/build/root-2CYAF5SQ.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-OYK7WRH2.js"/><link rel="modulepreload" href="/user-tutorials/build/routes/$-ZDWRJY4B.js"/><script>window.__remixContext = {"url":"/fwd-tdem-1d","state":{"loaderData":{"root":{"theme":"light","config":{"title":"SimPEG User Tutorials","options":{"analytics_plausible":"simpeg.xyz"},"myst":"1.1.42","nav":[],"actions":[{"title":"Learn More","url":"https://mystmd.org/guide"}],"projects":[{"title":"SimPEG User Tutorials","github":"https://github.com/simpeg/user-tutorials","keywords":[],"references":{"python":{"url":"https://docs.python.org/3/"},"numpy":{"url":"https://numpy.org/doc/stable/"},"scipy":{"url":"https://docs.scipy.org/doc/scipy/"},"matplotlib":{"url":"https://matplotlib.org/stable/"},"discretize":{"url":"https://discretize.simpeg.xyz/en/main/"},"SimPEG":{"url":"https://docs.simpeg.xyz/"},"geoana":{"url":"https://geoana.simpeg.xyz/"},"sphinx":{"url":"https://www.sphinx-doc.org/en/master/"}},"thumbnail":"/user-tutorials/build/title_image-8a71538f0bef40867b3fb0794cae7dbc.png","exports":[],"bibliography":[],"index":"index","pages":[{"slug":"gravity-index","title":"Gravity","description":"","date":"","thumbnail":"/user-tutorials/build/ae6c6ed278992f609070dbcd57643aba.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-gravity-anomaly-3d","title":"3D Forward Simulation of Gravity Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-gravity-gradiometry-3d","title":"3D Forward Simulation of Gravity Gradiometry Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-gravity-anomaly-3d","title":"3D Inversion of Gravity Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"magnetics-index","title":"Magnetics","description":"","date":"","thumbnail":"/user-tutorials/build/7a8cefd4894c78a7681713eac224fec3.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-magnetics-induced-3d","title":"3D Forward Simulation of TMI Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-magnetics-mvi-3d","title":"3D Forward Simulation of Magnetic Gradiometry Data for Magnetic Vector Models","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-magnetics-induced-3d","title":"3D Inversion of TMI Data to Recover a Susceptibility Model","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"dcr-index","title":"Direct Current Resistivity","description":"","date":"","thumbnail":"/user-tutorials/build/dcip_physics-ba2ce1e7a00bcfd7d149b5f4511b019f.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-dcr-1d","title":"1D Forward Simulation for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-dcr-2d","title":"2.5D Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-dcr-3d","title":"3D Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-1d","title":"1D Inversion for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-2d","title":"2.5D DC Resistivity Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-3d","title":"3D DC Resistivity Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"ip-index","title":"Induced Polarization","description":"","date":"","thumbnail":"/user-tutorials/build/dcip_physics-ba2ce1e7a00bcfd7d149b5f4511b019f.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-ip-2d","title":"2.5D IP Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-ip-3d","title":"3D IP Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-ip-2d","title":"2.5D IP Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-ip-3d","title":"3D IP Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fdem-index","title":"Frequency-Domain Electromagnetics","description":"","date":"","thumbnail":"/user-tutorials/build/fem_physics-6287513b81425048223fc264589cdf6a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-fdem-1d","title":"1D Forward Simulation of Frequency Domain EM Data for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-fdem-1d","title":"1D Inversion of Frequency Domain EM Data for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tdem-index","title":"Time-Domain Electromagnetics","description":"","date":"","thumbnail":"/user-tutorials/build/tem_physics-81e11e7ffe320f0cb309e445a95570b3.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-tdem-1d","title":"1D Forward Simulation for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-tdem-fundamentals","title":"Fundamentals of Finite Volume for TDEM Simulations","description":"","date":"","thumbnail":"/user-tutorials/build/diffusion_distance-1231b4c642392d8e924a88a81c415e67.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-utem-3d","title":"3D Forward Simulation for On-Time Large-Loop Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-tdem-1d","title":"1D Inversion for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"uran-index","title":"Uncertainty and Resolution analysis","description":"","date":"","thumbnail":"/user-tutorials/build/f0de225db6a3bcc09186ff9fea3eba43.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"dc2d-sens","title":"2D DC Resistivity Sensitivity analysis","description":"","date":"","thumbnail":"/user-tutorials/build/f037fe2572b5e1b2bf477ba85272db70.gif","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/user-tutorials"},"routes/$":{"page":{"kind":"Notebook","sha256":"e643bb4207dc040a6328dab51e0368f1f7d46c43ca7426a9c21ac962a5da5f18","slug":"fwd-tdem-1d","location":"/notebooks/08-tdem/fwd_tdem_1d.ipynb","dependencies":[],"frontmatter":{"title":"1D Forward Simulation for a Single Sounding","content_includes_title":false,"github":"https://github.com/simpeg/user-tutorials","keywords":[],"exports":[{"format":"ipynb","filename":"fwd_tdem_1d.ipynb","url":"/user-tutorials/build/fwd_tdem_1d-5110966e9c4792544501692a62654efc.ipynb"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"admonition","class":"hint","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Introductory notebook","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"x37Ooyk2Jz"}],"key":"BxNf4pJflk"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This tutorial teaches basic functionality within SimPEG and is a good entry point for new users.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OXbojW14K9"}],"key":"s63xCM0Slu"}],"key":"nSomqierFy"}],"data":{"type":"notebook-content"},"key":"Gowwa0HZ0u"},{"type":"block","children":[{"type":"admonition","class":"hint","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Light-weight notebook","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WKD4ETItck"}],"key":"u1eO1tM8Dt"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This tutorial requires minimal computational resources and can be executed quickly in the background while other computer processes are running.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uFN3Dcz6P2"}],"key":"Gqts5JDWxF"}],"key":"yVzQjP0NGX"}],"data":{"type":"notebook-content"},"key":"RWAWy6IgSV"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Author:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ecMS367c2O"}],"key":"g1STMmFHLT"},{"type":"text","value":" Devin C. Cowan","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PrHC7tTWaO"}],"key":"dpB7FFhPpE"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Keywords:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"A78IoZJ3zz"}],"key":"N1X7yNXOnJ"},{"type":"text","value":" TDEM, forward simulation, waveforms, 1D sounding, wires mapping.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"C5nhVVISYQ"}],"key":"cMZi0miBeF"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Summary:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"DPBUxwqg1L"}],"key":"lrpqHMOY4E"},{"type":"text","value":" In this tutorial, we present the fundamentals of simulating TDEM data in SimPEG. We use the module ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"JJNGmR7kGB"},{"type":"link","url":"https://docs.simpeg.xyz/content/api/SimPEG.electromagnetics.time_domain.html#module-simpeg.electromagnetics.time_domain","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"SimPEG​.electromagnetics​.static​.time​_domain","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"GYGtxk6F4g"}],"urlSource":"myst:SimPEG#SimPEG.electromagnetics.time_domain","internal":false,"protocol":"myst","key":"iQLtaptFSn"},{"type":"text","value":" to simulate TDEM data for a 1D sounding. The ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ssdmIHHJbP"},{"type":"link","url":"https://docs.simpeg.xyz/content/api/generated/SimPEG.electromagnetics.time_domain.Simulation1DLayered.html#SimPEG.electromagnetics.time_domain.Simulation1DLayered","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Simulation1DLayered","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"PR5FwHbERm"}],"urlSource":"myst:SimPEG#SimPEG.electromagnetics.time_domain.simulation_1d.Simulation1DLayered","internal":false,"protocol":"myst","key":"ACuGP6UM20"},{"type":"text","value":" class is used to solve the problem via a semi-analytic Hankel transform solution. Note that most of what is learned here can be applied to simulating 3D TDEM data.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"kvOtAV8M57"}],"key":"pyvd0M8gXf"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"The tutorial is organized into 3 parts. In ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"dTsREGcdDH"},{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"part 1,","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"qsZAXGHBij"}],"key":"A9W5CT89IX"},{"type":"text","value":" we focus on the most fundamental aspects of simulating TDEM data. For a step-off waveform, we simulate TDEM data for a conductive and non-permeable layered Earth. In ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"e1zezFLgEe"},{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"part 2,","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Tty9fdUwOm"}],"key":"vZgm6BIM8J"},{"type":"text","value":" we demonstrate how to include dispersive electromagnetic properties in the 1D TDEM simulation. And in ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"MADjRYmyuB"},{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"part 3,","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"XnqZYk6FS6"}],"key":"UL9YVH0txU"},{"type":"text","value":" we demonstrate how data can be simulated for user-specified transmitter waveforms.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Soru58FbA4"}],"key":"zgcrLpigW8"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Learning Objectives:","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"fYmomzWwQL"}],"key":"Y1RP7ZRBcd"}],"key":"NE9Kli2i5l"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":17,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"The fundamentals of simulating TDEM data with SimPEG.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"sZl2rhrkgc"}],"key":"ZMjDbdquDS"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Understanding the way in which TDEM surveys are created in SimPEG, which includes:","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"SGbUVJDGd8"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":19,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Defining receivers","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"Fk4JwguYRD"}],"key":"lO2vQkKqoH"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Defining controlled sources","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"a8an34DnJn"}],"key":"OFwUa8lHF5"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Organizing sources and receivers into a survey object","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"NgGcjnWmLW"}],"key":"oDuWzFB44S"}],"key":"ACKgn8HinD"}],"key":"OH7hXB6WxN"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Defining the Earth’s electrical properties in terms of conductivity OR resistivity.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"FbBwp4iUIO"}],"key":"RfdNAH6I8N"},{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Defining the Earth’s electrical properties in terms of conductivity OR resistivity.","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"Ix58Hm71t4"}],"key":"XhoFEGtAnn"},{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"The ways in which we can define 1D layered Earth models.","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"cNx5dP6wpf"}],"key":"ML7Svu27vC"},{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Simulating TDEM data for different transmitter waveforms","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"eJsAbboVdL"}],"key":"RTYlcfJjTl"},{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Simulating TDEM data for dispersive electromagnetic properties (i.e. induced polarization, superparamagnetism)","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"diHfKeWYCr"}],"key":"tJCQxGH7vY"}],"key":"lxW8F89Ett"}],"data":{"type":"notebook-content"},"key":"NNZHS6BuIS"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Importing Modules","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NK0UVIqDVC"}],"identifier":"importing-modules","label":"Importing Modules","html_id":"importing-modules","implicit":true,"key":"w20cNSmPGw"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Here, we import all of the functionality required to run the notebook for the tutorial exercise. All of the functionality specific to TDEM is imported from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sb3MIuqfMK"},{"type":"link","url":"https://docs.simpeg.xyz/content/api/SimPEG.electromagnetics.time_domain.html#module-simpeg.electromagnetics.time_domain","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"SimPEG​.electromagnetics​.time​_domain","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SPGlyqnNtS"}],"urlSource":"myst:SimPEG#SimPEG.electromagnetics.time_domain","internal":false,"protocol":"myst","key":"sVD4W73DGP"},{"type":"text","value":".\nWe also import some useful utility functions from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DcGYql99jn"},{"type":"link","url":"https://docs.simpeg.xyz/content/api/SimPEG.utils.html#module-simpeg.utils","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"SimPEG.utils","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AZrkoi1cEw"}],"urlSource":"myst:SimPEG#SimPEG.utils","internal":false,"protocol":"myst","key":"B3FCBhWyGW"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BtBNQzIZeT"}],"key":"CGmPYrVIR2"}],"data":{"type":"notebook-content"},"key":"B1pM6khOB3"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"# SimPEG functionality\nimport SimPEG.electromagnetics.time_domain as tdem\nfrom SimPEG import maps\nfrom SimPEG.utils import plot_1d_layer_model\n\n# Common Python functionality\nimport os\nimport numpy as np\nfrom scipy.constants import mu_0\nimport matplotlib as mpl\nimport matplotlib.pyplot as plt\n\nmpl.rcParams.update({\"font.size\": 14})\n\nwrite_output = False  # Optional","key":"Yeelpu4yzw"},{"type":"output","id":"pgwsTpDeS4Kh1q_LBm5rS","data":[],"key":"aAp6uLxWkY"}],"data":{"type":"notebook-code"},"key":"iQIf56Bo93"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Part 1: Step-Off Response for a Conductive Layer","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MQc0zDI9LD"}],"identifier":"part-1-step-off-response-for-a-conductive-layer","label":"Part 1: Step-Off Response for a Conductive Layer","html_id":"part-1-step-off-response-for-a-conductive-layer","implicit":true,"key":"I780ewuxpg"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this part of the tutorial, we focus on the most fundamental aspects of simulating TDEM data in SimPEG. Here, the survey consists of a single circular loop located 1 m above the Earth’s surface. The vertical B-field is simulated at the loop’s centre for a step-off waveform.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LzSKdgexcd"}],"key":"RTw4AzgrFQ"}],"data":{"type":"notebook-content"},"key":"wEBpCbvoGS"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Defining the Survey","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NH7HdjKZFU"}],"identifier":"defining-the-survey","label":"Defining the Survey","html_id":"defining-the-survey","implicit":true,"key":"dk8QRJqSGc"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"TDEM surveys within SimPEG require the user to create and connect four types of objects:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sPCuVQBS7h"}],"key":"zQtKq3fIzK"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"receivers:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"kLQyFOcZYC"}],"key":"uO0J86T1Xz"},{"type":"text","value":" There are a multitude of TDEM receiver classes within SimPEG, each of which is used to simulate data corresponding to a different field measurement; e.g. ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Kvx012mCZ5"},{"type":"link","url":"https://docs.simpeg.xyz/content/api/generated/SimPEG.electromagnetics.time_domain.receivers.PointMagneticField.html#simpeg.electromagnetics.time_domain.receivers.pointmagneticfield","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"PointMagneticField","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Bse1wBFE1Y"}],"urlSource":"myst:SimPEG#SimPEG.electromagnetics.time_domain.receivers.PointMagneticField","internal":false,"protocol":"myst","key":"wqfCjjvnZC"},{"type":"text","value":", ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"wI4OdilVDL"},{"type":"link","url":"https://docs.simpeg.xyz/content/api/generated/SimPEG.electromagnetics.time_domain.receivers.PointMagneticFluxTimeDerivative.html#simpeg.electromagnetics.time_domain.receivers.pointmagneticfluxtimederivative","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"PointMagneticFluxTimeDerivative","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mxUhsmeM4J"}],"urlSource":"myst:SimPEG#SimPEG.electromagnetics.time_domain.receivers.PointMagneticFluxTimeDerivative","internal":false,"protocol":"myst","key":"KtjC0cHrP6"},{"type":"text","value":" and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"MRW1rXencL"},{"type":"link","url":"https://docs.simpeg.xyz/content/api/generated/SimPEG.electromagnetics.time_domain.receivers.PointElectricField.html#simpeg.electromagnetics.time_domain.receivers.pointelectricfield","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"PointElectricField","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xi6BbesniR"}],"urlSource":"myst:SimPEG#SimPEG.electromagnetics.time_domain.receivers.PointElectricField","internal":false,"protocol":"myst","key":"elO71b2R8M"},{"type":"text","value":". The properties for each TDEM receiver object generally include: the orientation of the field being measured (x, y, z, other), the time channels, the data type, and one or more associated observation locations.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"In2iHFF0hr"}],"key":"HEUaudD9gq"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"sources:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"qDvm8cpDFf"}],"key":"aKe6FUI0b1"},{"type":"text","value":" There are a multitude of TDEM source classes within SimPEG, each of which corresponds to a different geometry; e.g. ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"drQsdKCeF8"},{"type":"link","url":"https://docs.simpeg.xyz/content/api/generated/SimPEG.electromagnetics.time_domain.sources.MagDipole.html#simpeg.electromagnetics.time_domain.sources.magdipole","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"MagDipole","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"UdYgIbhXDl"}],"urlSource":"myst:SimPEG#SimPEG.electromagnetics.time_domain.sources.MagDipole","internal":false,"protocol":"myst","key":"c62oYJvdfM"},{"type":"text","value":" and ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"e5hdePI2uZ"},{"type":"link","url":"https://docs.simpeg.xyz/content/api/generated/SimPEG.electromagnetics.time_domain.sources.LineCurrent.html#simpeg.electromagnetics.time_domain.sources.linecurrent","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"LineCurrent","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"M21PYj1j9G"}],"urlSource":"myst:SimPEG#SimPEG.electromagnetics.time_domain.sources.LineCurrent","internal":false,"protocol":"myst","key":"lZhIBgJvOa"},{"type":"text","value":". Source classes generally require the user to define the its current waveform, location and geometry.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"aqf42JCQZd"}],"key":"SiQFPPvQDP"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"waveforms:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"JtWblii7XE"}],"key":"X9Etikey8z"},{"type":"text","value":" The waveform defining the time-dependent current in the source is defined by an object in SimPEG. Some waveform classes include ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"aUqZsRIZYU"},{"type":"link","url":"https://docs.simpeg.xyz/content/api/generated/SimPEG.electromagnetics.time_domain.sources.StepOffWaveform.html#simpeg.electromagnetics.time_domain.sources.stepoffwaveform","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"StepOffWaveform","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"tOiaJIFN6I"}],"urlSource":"myst:SimPEG#SimPEG.electromagnetics.time_domain.sources.StepOffWaveform","internal":false,"protocol":"myst","key":"d8QFZKMbz9"},{"type":"text","value":", ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"W5g6eZERPZ"},{"type":"link","url":"https://docs.simpeg.xyz/content/api/generated/SimPEG.electromagnetics.time_domain.sources.VTEMWaveform.html#simpeg.electromagnetics.time_domain.sources.vtemwaveform","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"VTEMWaveform","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"NcRWt009bk"}],"urlSource":"myst:SimPEG#SimPEG.electromagnetics.time_domain.sources.VTEMWaveform","internal":false,"protocol":"myst","key":"GQE7jNBYag"},{"type":"text","value":" and ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"tKBve00eep"},{"type":"link","url":"https://docs.simpeg.xyz/content/api/generated/SimPEG.electromagnetics.time_domain.sources.RawWaveform.html#simpeg.electromagnetics.time_domain.sources.rawwaveform","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"RawWaveform","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"N4b8dwwPLO"}],"urlSource":"myst:SimPEG#SimPEG.electromagnetics.time_domain.sources.RawWaveform","internal":false,"protocol":"myst","key":"DDk3O7hMFx"}],"key":"ElEUz8fFrX"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"survey:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"GO5sEI8CFx"}],"key":"B8ziPUXzm0"},{"type":"text","value":" the object which stores and organizes all of the sources and receivers.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"WxCs1yhlAJ"}],"key":"OOCpIu0v5J"}],"key":"YzTLVoLkpI"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"For a full list of ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"IaQ5pO0jvl"},{"type":"emphasis","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"source types","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"SJn8TwIPBP"}],"key":"xhSTLw4yCz"},{"type":"text","value":", ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"KVUgC3ugSt"},{"type":"emphasis","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"waveform types","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"kSatZiAOCd"}],"key":"FDEWae1ola"},{"type":"text","value":" and ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"GbTh1CGjg3"},{"type":"emphasis","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"receiver types","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"ZUNRTT1f5o"}],"key":"gKv1JTm9dX"},{"type":"text","value":", please visit API documentation for ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"bbLDo8mFNZ"},{"type":"link","url":"https://docs.simpeg.xyz/content/api/SimPEG.electromagnetics.time_domain.html#module-simpeg.electromagnetics.time_domain","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"SimPEG​.electromagnetics​.time​_domain","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"RCMfcJKP7G"}],"urlSource":"myst:SimPEG#SimPEG.electromagnetics.time_domain","internal":false,"protocol":"myst","key":"RE66Wnw09A"},{"type":"text","value":".","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"xem3zx0LnA"}],"key":"pXU3x3kq4N"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Topography:","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"yoF8su10XA"}],"key":"GotBmDsDg7"},{"type":"text","value":" When generating the survey for a 1D forward simulation, sources and receivers ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"oJQaG0yhXP"},{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"must","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"na6xNceUQY"}],"key":"vO51IDLth9"},{"type":"text","value":" be located ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"XnFxEHNV0N"},{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"above","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"ASkPysRPss"}],"key":"NvscZrcR9e"},{"type":"text","value":" the Earth’s surface. By default, the Earth’s surface is at z = 0 m when defining the 1D simulation. So for 1D FDEM problems, it is easiest to define the z-locations of all sources and receivers as flight heights.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"KOLSpFSgqM"}],"key":"mm8Is8v8hW"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"For this tutorial","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"b1wXtUdFNC"}],"key":"QCqaN85mjN"},{"type":"text","value":", the survey consists of a circular source loop 1 m above the surface that uses a step-off waveform. The vertical component of the magnetic flux density is measured at the loop’s center at a number of time channels.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"VTf1JnCZGC"}],"key":"Bo5mgoTtkI"}],"data":{"type":"notebook-content"},"key":"qsSqK4uqwE"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"# Source properties\nsource_location = np.array([0.0, 0.0, 1.0])  # (3, ) numpy.array_like\nsource_orientation = \"z\"  # \"x\", \"y\" or \"z\"\nsource_current = 1.0  # maximum on-time current (A)\nsource_radius = 10.0  # source loop radius (m)\n\n# Receiver properties\nreceiver_locations = np.array([0.0, 0.0, 1.0])  # or (N, 3) numpy.ndarray\nreceiver_orientation = \"z\"  # \"x\", \"y\" or \"z\"\ntimes = np.logspace(-5, -2, 31)  # time channels (s)","key":"R1YfQNUFmn"},{"type":"output","id":"shHjmE-dl3txMqcxfPb40","data":[],"key":"uGBs8w3eK5"}],"data":{"type":"notebook-code"},"key":"vEENQSPCle"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"A waveform must be assigned as a property of each TDEM source object. Here, we define a step-off waveform. By default, the off-time for the step-off waveform begins at 0 s. However, the keyword argument ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BNJnoZcLJS"},{"type":"inlineCode","value":"off_time","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bjIbCc1Sdw"},{"type":"text","value":" can be used to change the start of the off-time.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QnTVVrObXr"}],"key":"DN7OjsR32v"}],"data":{"type":"notebook-content"},"key":"f7OXiR2m7I"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"stepoff_waveform = tdem.sources.StepOffWaveform(off_time=0.0)","key":"QtzDwkubmH"},{"type":"output","id":"-1p-mXu8NkBURB89KfbER","data":[],"key":"B2Ml3OXc5J"}],"data":{"type":"notebook-code"},"key":"oaRjFbpeUb"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The most general way to generate TDEM surveys is to loop over all sources. A new source object must be created whenever the source location and/or geometry differs. For each source, we define and assign the associated receivers. A different receiver object must be created whenever geometry, data type and/or time channels differ. However, identical data being collected at a multitude of observation locations can be defined using a single receiver object.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nRqNcGcSBZ"}],"key":"hFitc2V6Zv"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"For this tutorial","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Sydk9b69SN"}],"key":"nExQkLqSm1"},{"type":"text","value":", we only have a single source. And this source only has a single receiver. More complicated survey geometries are used in the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yDWeob4KLd"},{"type":"link","url":"fwd_tdem_cyl.ipynb","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"3D Forward Simulation of TDEM Data on Cylindrical Mesh for a Galvanic Source","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"P92O7ODZRA"}],"urlSource":"fwd_tdem_cyl.ipynb","key":"A1N45NAsyg"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sOaoLb3p9A"},{"type":"link","url":"/user-tutorials/build/fwd_tdem_3d-e0553bd4fe0c42c7ac3ea78f6559fc2d.ipynb","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Forward Simulation of 3D Airborne TDEM Data on a Tree Mesh","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PWy2EuBOsG"}],"urlSource":"fwd_tdem_3d.ipynb","static":true,"protocol":"file","key":"asKqcm2kBi"},{"type":"text","value":" tutorials. These tutorials demonstrate the more general construction of TDEM surveys.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hQfLqQkZSP"}],"key":"E4etTYH2ew"}],"data":{"type":"notebook-content"},"key":"Lrw02Kfszb"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"# Define receiver list. In our case, we have only a single receiver for each source.\n# When simulating the response for multiple data types for the same source,\n# the list consists of multiple receiver objects.\nreceiver_list = []\nreceiver_list.append(\n    tdem.receivers.PointMagneticFluxDensity(\n        receiver_locations, times, orientation=receiver_orientation\n    )\n)\n\n# Define source list. In our case, we have only a single source.\nsource_list = [\n    tdem.sources.CircularLoop(\n        receiver_list=receiver_list,\n        location=source_location,\n        waveform=stepoff_waveform,\n        current=source_current,\n        radius=source_radius,\n    )\n]\n\n# Define the survey\nsurvey = tdem.Survey(source_list)","key":"DhHxFYAtRQ"},{"type":"output","id":"S5qeOrdYr_vRzHjbzg3K9","data":[],"key":"eAqofa3Sqj"}],"data":{"type":"notebook-code"},"key":"G7LxHPZB28"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Defining a 1D Layered Earth and the Model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BwiXi1HER3"}],"identifier":"defining-a-1d-layered-earth-and-the-model","label":"Defining a 1D Layered Earth and the Model","html_id":"defining-a-1d-layered-earth-and-the-model","implicit":true,"key":"L2oajTWDTZ"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In SimPEG, a 1D layered Earth is defined by the set of layer thicknesses and the physical properties for each layer. Thicknesses and physical property values are defined from the top layer down. If we have N layers, we define N physical property values and N-1 layer thicknesses. The lowest layer is assumed to extend to infinity. In the case of a halfspace, the layer thicknesses would be an empty array.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZaefUDP5Ja"}],"key":"WAjDD69Bmy"}],"data":{"type":"notebook-content"},"key":"KxdFbYAqSx"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"# Layer conductivities\nlayer_conductivities = np.r_[0.1, 1.0, 0.1]\n\n# Layer thicknesses\nlayer_thicknesses = np.r_[40.0, 40.0]\n\n# Number of layers\nn_layers = len(layer_conductivities)","key":"AXUXFIjElb"},{"type":"output","id":"uyjnc3iUChYvZZRlIDRLD","data":[],"key":"icRPKeFsQ2"}],"data":{"type":"notebook-code"},"key":"bcVW6OqG2z"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure(figsize=(4, 5))\nax1 = fig.add_axes([0.1, 0.1, 0.8, 0.8])\nax1 = plot_1d_layer_model(layer_thicknesses, layer_conductivities, scale=\"log\", ax=ax1)\nax1.grid(which=\"both\")\nax1.set_xlabel(r\"Conductivity ($S/m$)\")\nplt.show()","key":"eUYxzPFlQF"},{"type":"output","id":"oIMPRGIttZcdlOkaQDbGr","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c0abd137598f4336b2d6c9d888fbfe56","path":"/user-tutorials/build/c0abd137598f4336b2d6c9d888fbfe56.png"},"text/plain":{"content":"\u003cFigure size 400x500 with 1 Axes\u003e","content_type":"text/plain"}}}],"key":"jK1wagJctP"}],"data":{"type":"notebook-code"},"key":"BCthwjMC5z"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Models and Mappings for 1D Simulations","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iSI3GVnfZH"}],"identifier":"models-and-mappings-for-1d-simulations","label":"Models and Mappings for 1D Simulations","html_id":"models-and-mappings-for-1d-simulations","implicit":true,"key":"O3hD01ChLq"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In SimPEG, the term ‘model’ is not necessarily synonymous with a set of physical property values. For example, the model may be defined as the logarithms of the physical property values, or be the parameters defining a layered Earth geometry. Models in SimPEG are 1D ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SzeuFLtz2x"},{"type":"link","url":"https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"numpy.ndarray","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hqGDeRcQpC"}],"urlSource":"myst:numpy#numpy.ndarray","internal":false,"protocol":"myst","key":"jseSfXBdIm"},{"type":"text","value":" whose lengths are equal to the number of model parameters. For 1D TDEM simulations, we can characterize the Earth’s electric properties according to electrical conductivity or electrical resistivity.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uofCesWer0"}],"key":"mrhTTnGD77"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Classes within the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"R24D4SeVwn"},{"type":"inlineCode","value":"SimPEG.maps","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ibRwjvsu3D"},{"type":"text","value":" module are used to define the mapping that connects the model to the parameters required to run the 1D TDEM simulation; e.g. layer conductivities/resistivities, magnetic permeabilities and/or layer thicknesses. In this part of the tutorial, we demonstrate 2 types of mappings and models that may be used for 1D TDEM simulation.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"f6nbWcPOI7"}],"key":"W27vwTO85r"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"1. Conductivity model:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"hHLpO7iRuk"}],"key":"Oouk6lxkml"},{"type":"text","value":" For forward simulation, the easiest approach is to define the model as the layer conductivities and set the layer thicknesses as a static property of the 1D simulation. In this case, the mapping from the model to the conductivities is defined using the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"U6ykslTOY3"},{"type":"link","url":"https://docs.simpeg.xyz/content/api/generated/SimPEG.maps.IdentityMap.html#simpeg.maps.identitymap","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"SimPEG​.maps​.IdentityMap","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"mUwv9sgHuJ"}],"urlSource":"myst:SimPEG#SimPEG.maps.IdentityMap","internal":false,"protocol":"myst","key":"pMyubw5R0z"},{"type":"text","value":" class.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"QwK5SXJ40C"}],"key":"cz4NrPcpBC"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"2. Parametric layered Earth model:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"IwJXBeCmQV"}],"key":"IeK1z6cXXg"},{"type":"text","value":" In this case, the model parameters are log-resistivities and layer thicknesses. We therefore need a mapping that extracts extracts log-resistivities from the model and converts them into resistivities, and a mapping that extracts layer thicknesses from the model. For this, we require the ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"aZCRiKM5Z5"},{"type":"link","url":"https://docs.simpeg.xyz/content/api/generated/SimPEG.maps.Wires.html#simpeg.maps.wires","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"SimPEG.maps.Wires","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"BKaAIa9kqZ"}],"urlSource":"myst:SimPEG#SimPEG.maps.Wires","internal":false,"protocol":"myst","key":"R2nA2gw2wW"},{"type":"text","value":" mapping and ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"XGSIbI0D9X"},{"type":"link","url":"https://docs.simpeg.xyz/content/api/generated/SimPEG.maps.ExpMap.html#simpeg.maps.expmap","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"SimPEG.maps.ExpMap","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"qZAzmjMVpq"}],"urlSource":"myst:SimPEG#SimPEG.maps.ExpMap","internal":false,"protocol":"myst","key":"sEJDXAtAa5"},{"type":"text","value":" mapping classes. Note that successive mappings can be chained together using the ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Cp54lF9egK"},{"type":"inlineMath","value":"*","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmo\u003e∗\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e*\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4653em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e∗\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"YwrRUtI8vO"},{"type":"text","value":" operator.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"EHRvWzhiuD"}],"key":"E55huchJmy"}],"data":{"type":"notebook-content"},"key":"t13u6pJbCe"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"# Define model and mapping for a conductivity model.\nconductivity_model = layer_conductivities.copy()\nconductivity_map = maps.IdentityMap(nP=n_layers)\n\n# Define model and mappings for the parametric model.\n# Note the ordering in which you defined the model parameters and the\n# order in which you defined the wire mappings matters!!!\nparametric_model = np.r_[layer_thicknesses, np.log(1 / layer_conductivities)]\nwire_map = maps.Wires((\"thicknesses\", n_layers - 1), (\"log_resistivity\", n_layers))\nthicknesses_map = wire_map.thicknesses\nlog_resistivity_map = maps.ExpMap() * wire_map.log_resistivity","key":"Nz9YsuyqHB"},{"type":"output","id":"LlA6bd3V8r6p3LQqDHaDb","data":[],"key":"V35y6gu5lK"}],"data":{"type":"notebook-code"},"key":"nFtO9BOIIK"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Defining the Forward Simulation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XofWdjGScJ"}],"identifier":"defining-the-forward-simulation","label":"Defining the Forward Simulation","html_id":"defining-the-forward-simulation","implicit":true,"key":"UrNReDHs9o"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In SimPEG, the physics of the forward simulation is defined by creating an instance of an appropriate simulation class. Here, we use the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oK3q8vpVXH"},{"type":"link","url":"https://docs.simpeg.xyz/content/api/generated/SimPEG.electromagnetics.time_domain.Simulation1DLayered.html#simpeg.electromagnetics.time_domain.simulation1dlayered","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Simulation1DLayered","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VA9ZG3bgpa"}],"urlSource":"myst:SimPEG#SimPEG.electromagnetics.time_domain.Simulation1DLayered","internal":false,"protocol":"myst","key":"EpiSgJRUJR"},{"type":"text","value":" which simulates the data according to a 1D Hankel transform solution. To fully define the forward simulation, we need to connect the simulation object to:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yiW51Wvm9a"}],"key":"ilkQEnEVwY"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"the survey","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mOEHWTtIQf"}],"key":"vfDGNZR0iP"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"the layer thicknesses","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"mXORIt7RO0"}],"key":"GgtVKeP14B"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"the physical properties of the layers (e.g. conductivity)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"KSWr9jM7ZY"}],"key":"UwpNXHJHcG"}],"key":"RPndjxPOgV"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"This is accomplished by setting each one of the aforementioned items as a property of the simulation object. Since the parameters defining the model in each case are different, we must define a separate simulation object for each case.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"A7XtcKCFkt"}],"key":"qDUfyU8d6C"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"1. Conductivity model simulation:","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"cL402ngrt6"}],"key":"as7MunOT4p"},{"type":"text","value":" Here, the model parameters are the layer conductivities. ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"MUZ9pTwTPs"},{"type":"inlineCode","value":"sigmaMap","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"nWuQkcxruh"},{"type":"text","value":" is used to define the mapping from the model to the layer conductivities. And ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"lFnKTotBM7"},{"type":"inlineCode","value":"thicknessess","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"uITKwXRyWV"},{"type":"text","value":" is used to set the layer thicknesses as a static property of the simulation.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"fNHOXj91ck"}],"key":"oUsl6JXlgx"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"2. Parametric model simulation:","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"KRkmQUQGP1"}],"key":"uDOxS9bdCc"},{"type":"text","value":" Here, the model consists of the layer thicknesses and log-resistivities. Because we are now working with electric resistivity, ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"T0eI1OWzS5"},{"type":"inlineCode","value":"rhoMap","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"xAtS1k3HOP"},{"type":"text","value":" is used to define the mapping for the Earth’s electrical properties; i.e. model parameters to layer resistivities. And ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"MCkZI0o3Tc"},{"type":"inlineCode","value":"thicknessesMap","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"txeTdVxgpN"},{"type":"text","value":" is used to define the mapping from the model to the layer thicknesses.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"uBsWU2hhPt"}],"key":"connLLsj32"}],"data":{"type":"notebook-content"},"key":"QAz4NkS7oC"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"simulation_conductivity = tdem.simulation_1d.Simulation1DLayered(\n    survey=survey,\n    sigmaMap=conductivity_map,\n    thicknesses=layer_thicknesses,\n)","key":"TQ2Ijce5IA"},{"type":"output","id":"XyauARSacXN5GkjLaxtuY","data":[],"key":"ygsmYhLgMO"}],"data":{"type":"notebook-code"},"key":"fDywa3Mrvd"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"simulation_parametric = tdem.simulation_1d.Simulation1DLayered(\n    survey=survey,\n    rhoMap=log_resistivity_map,\n    thicknessesMap=thicknesses_map,\n)","key":"XKCYSxAQVR"},{"type":"output","id":"vZGqJ_WeDMoNhd3su2RPu","data":[],"key":"ROxxi5MDOq"}],"data":{"type":"notebook-code"},"key":"HzYBmXySS9"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Predict 1D TDEM Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ozNGA9FI7z"}],"identifier":"predict-1d-tdem-data","label":"Predict 1D TDEM Data","html_id":"predict-1d-tdem-data","implicit":true,"key":"xAOWa1w2aY"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Once any simulation within SimPEG has been properly constructed, simulated data for a given model vector can be computed using the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LAyjLUhSqL"},{"type":"link","url":"https://docs.simpeg.xyz/content/api/generated/SimPEG.simulation.BaseSimulation.dpred.html#simpeg.simulation.basesimulation.dpred","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"dpred","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FsJQLwdMwB"}],"urlSource":"myst:SimPEG#SimPEG.simulation.BaseSimulation.dpred","internal":false,"protocol":"myst","key":"ioSdJMcmNv"},{"type":"text","value":" method. Note that despite the difference in how we defined the model, the data predicted for the conductivity and parametric models is the same.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jpVmcmJYel"}],"key":"BXOtnrr7D8"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"For surveys consisting of multiple sources, multiple receivers per source and multiple observation locations and time channels per receiver, the predicted data vector is organized:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"UeaRLirC1v"}],"key":"AATJRyiE0o"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"by source","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ij8S7TZDa1"}],"key":"pKG1WM9bH1"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"by receiver","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"pB8pUHfJI6"}],"key":"b8869SG9qs"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"by time channel, then","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"XqbOVQw53j"}],"key":"oQHHteT09U"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"by observation location","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"TyuNXxUQjS"}],"key":"jEvAmkrlhV"}],"key":"P01c18YbMw"}],"data":{"type":"notebook-content"},"key":"BT3PES7Qw3"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"dpred_conductivity = simulation_conductivity.dpred(conductivity_model)\ndpred_parametric = simulation_parametric.dpred(parametric_model)","key":"BejVA3YTr3"},{"type":"output","id":"CRHj4rlalkhXv58HRO0NM","data":[{"name":"stderr","output_type":"stream","text":"C:\\Users\\devin\\anaconda3\\lib\\site-packages\\geoana\\kernels\\tranverse_electric_reflections.py:37: RuntimeWarning: overflow encountered in tanh\n  tanh = np.tanh(u[:-1]*thicknesses[:, None, None])\n"}],"key":"tWbX2wC8PN"}],"data":{"type":"notebook-code"},"key":"hyfQYtxbFb"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure(figsize=(5, 6))\nax = fig.add_axes([0.2, 0.15, 0.75, 0.78])\nax.loglog(times, dpred_conductivity, \"b-\", lw=3)\nax.loglog(times, dpred_parametric, \"r--\", lw=3)\nax.set_xlim([times.min(), times.max()])\nax.grid()\nax.set_xlabel(\"Times (s)\")\nax.set_ylabel(\"B (T)\")\nax.set_title(\"Magnetic Flux Density\")\nax.legend([\"Conductivity model\", \"Parametric model\"])\nplt.show()","key":"mkEX1dvVq7"},{"type":"output","id":"qJp6Q189pLAz4iAQk_rBF","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ea383b71dd619e9b76f9b92d0340f64d","path":"/user-tutorials/build/ea383b71dd619e9b76f9b92d0340f64d.png"},"text/plain":{"content":"\u003cFigure size 500x600 with 1 Axes\u003e","content_type":"text/plain"}}}],"key":"iWgIeGtXK2"}],"data":{"type":"notebook-code"},"key":"ufi9S63HDm"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Part 2: Magnetic Permeability and Dispersive Physical Properties","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"t2dvf3asy8"}],"identifier":"part-2-magnetic-permeability-and-dispersive-physical-properties","label":"Part 2: Magnetic Permeability and Dispersive Physical Properties","html_id":"part-2-magnetic-permeability-and-dispersive-physical-properties","implicit":true,"key":"GdkofDqYoZ"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this part of the tutorial, we simulate TDEM data for 3 cases: 1) a conductive and magnetically permeable layer, 2) a conductive and chargeable layer, and 3) a conductive layer with a magnetically viscous top layer. In all cases, the set of model parameters are the layer conductivities from part 1.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mS0B7dD2Ke"}],"key":"neogKuQLvJ"}],"data":{"type":"notebook-content"},"key":"csAkGS18QL"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Case 1: the conductive layer is also magnetically permeable","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PiCcfQ9icW"}],"identifier":"case-1-the-conductive-layer-is-also-magnetically-permeable","label":"Case 1: the conductive layer is also magnetically permeable","html_id":"case-1-the-conductive-layer-is-also-magnetically-permeable","implicit":true,"key":"Qvckxc3jO6"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this case, the middle layer is magnetically permeable in addition to being more conductive than the host. For TDEM simulation classes within SimPEG, the Earth’s magnetic properties are defined as magnetic permeabilities (not susceptibilities). Here, the layer magnetic permeabilities are set as a static property of the simulation using the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Szh02pl6er"},{"type":"inlineCode","value":"mu","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ee2wU8wWLn"},{"type":"text","value":" keyword argument. However, one could define a model whose parameters contain the layer magnetic permeabilities; see the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"To5F7ETDw1"},{"type":"link","url":"/fwd-fdem-1d","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"1D Forward Simulation of Frequency Domain EM Data for a Single Sounding","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rhAuv0aBxF"}],"urlSource":"../07-fdem/fwd_fdem_1d.ipynb","internal":true,"dataUrl":"/fwd-fdem-1d.json","protocol":"file","key":"ypMWQHJYrU"},{"type":"text","value":" tutorial. This would require the user set ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RLwaqUBp2m"},{"type":"inlineCode","value":"muMap","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qZr0Cnpqmu"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ko0Hx7ldIs"}],"key":"yIdjBSLVxw"}],"data":{"type":"notebook-content"},"key":"zYvGaoWexQ"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"layer_susceptibilities = np.r_[0.0, 9.0, 0.0]\nlayer_permeabilities = mu_0 * (1 + layer_susceptibilities)","key":"tH1sUE6t9G"},{"type":"output","id":"qAigr2Xxo9JO_hRnRdXUH","data":[],"key":"UFqnSDs3UL"}],"data":{"type":"notebook-code"},"key":"M4aEhzKLxt"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"simulation_permeable = tdem.simulation_1d.Simulation1DLayered(\n    survey=survey,\n    sigmaMap=conductivity_map,\n    thicknesses=layer_thicknesses,\n    mu=layer_permeabilities,\n)","key":"AGqtJAU0lu"},{"type":"output","id":"26G4uMufmrefMdyupXhfE","data":[],"key":"Yxue2G6dZv"}],"data":{"type":"notebook-code"},"key":"zenZVl6S6a"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"dpred_permeable = simulation_permeable.dpred(conductivity_model)","key":"RnFFDSfvdk"},{"type":"output","id":"u51JB7dUWp6_b7rI-iYOc","data":[],"key":"QID8tn2wfB"}],"data":{"type":"notebook-code"},"key":"E6NuWOW5Qx"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Case 2: the middle layer is also chargeable (induced polarization)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UOEeeOKR0h"}],"identifier":"case-2-the-middle-layer-is-also-chargeable-induced-polarization","label":"Case 2: the middle layer is also chargeable (induced polarization)","html_id":"case-2-the-middle-layer-is-also-chargeable-induced-polarization","implicit":true,"key":"xFNg8REeb9"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this case, the middle layer exhibits an induced polarization (IP) response. In SimPEG, we use the Cole-Cole model to characterize the dispersive conductivity, see ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vMT3bPwyuo"},{"type":"link","url":"https://em.geosci.xyz/content/physical_properties/electrical_conductivity/index.html#chargeability-and-frequency-dependence","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"EM GeoSci","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qdVjGd8Gqq"}],"urlSource":"https://em.geosci.xyz/content/physical_properties/electrical_conductivity/index.html#chargeability-and-frequency-dependence","key":"zZp56QUIjo"},{"type":"text","value":":","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PIebvTR1Fk"}],"key":"wd1vJBajaj"},{"type":"math","value":"\\sigma_{ip} (\\omega) = \\sigma \\left [ 1 - \\frac{\\eta}{1 + (1-\\eta )(i\\omega \\tau)^C} \\right ]","position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003eσ\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmi\u003ep\u003c/mi\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003eω\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi\u003eσ\u003c/mi\u003e\u003cmrow\u003e\u003cmo fence=\"true\"\u003e[\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmfrac\u003e\u003cmi\u003eη\u003c/mi\u003e\u003cmrow\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmi\u003eη\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmi\u003eω\u003c/mi\u003e\u003cmi\u003eτ\u003c/mi\u003e\u003cmsup\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmi\u003eC\u003c/mi\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003cmo fence=\"true\"\u003e]\u003c/mo\u003e\u003c/mrow\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\sigma_{ip} (\\omega) = \\sigma \\left [ 1 - \\frac{\\eta}{1 + (1-\\eta )(i\\omega \\tau)^C} \\right ]\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eσ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ep\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eω\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eσ\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"minner\"\u003e\u003cspan class=\"mopen delimcenter\" style=\"top:0em;\"\u003e\u003cspan class=\"delimsizing size3\"\u003e[\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.1076em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eη\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eiω\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.1132em;\"\u003eτ\u003c/span\u003e\u003cspan class=\"mclose\"\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7673em;\"\u003e\u003cspan style=\"top:-2.989em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\"\u003eC\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eη\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.936em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose delimcenter\" style=\"top:0em;\"\u003e\u003cspan class=\"delimsizing size3\"\u003e]\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"1","key":"x58vH4RqwG"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"where:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"udGkKwn5sR"}],"key":"SvxevFHSrq"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"ω","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"z3R54HG03O"},{"type":"text","value":" is the radial frequency (rad/s)","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"aBljOV0UZp"}],"key":"tTb4vEYUcI"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"σ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"dVFNIBDmlD"},{"type":"text","value":" is the infinity frequency electrical conductivity (S/m)","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"wQY5CHJ7BC"}],"key":"OZzZAyi5E2"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"inlineMath","value":"0 \u003c \\eta \\leq 1","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmn\u003e0\u003c/mn\u003e\u003cmo\u003e\u0026lt;\u003c/mo\u003e\u003cmi\u003eη\u003c/mi\u003e\u003cmo\u003e≤\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e0 \u0026lt; \\eta \\leq 1\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6835em;vertical-align:-0.0391em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8304em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eη\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e≤\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Fqha7W0buL"},{"type":"text","value":" is the intrinsic chargeability (unitless)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"h5zejkssSt"}],"key":"coEjEfdWzz"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"inlineMath","value":"0 \u003c \\tau","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmn\u003e0\u003c/mn\u003e\u003cmo\u003e\u0026lt;\u003c/mo\u003e\u003cmi\u003eτ\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e0 \u0026lt; \\tau\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6835em;vertical-align:-0.0391em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.1132em;\"\u003eτ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Gv8LrSD6pC"},{"type":"text","value":" is the central time-relaxation constant (s)","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"sOe3ABJrKc"}],"key":"nmqn1BKtrj"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"inlineMath","value":"0 \\leq C \\leq 1","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmn\u003e0\u003c/mn\u003e\u003cmo\u003e≤\u003c/mo\u003e\u003cmi\u003eC\u003c/mi\u003e\u003cmo\u003e≤\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e0 \\leq C \\leq 1\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e≤\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8193em;vertical-align:-0.136em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.07153em;\"\u003eC\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e≤\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"cwX6oCa4Bc"},{"type":"text","value":" (unitless) defines the distribution of time-relaxation constants. A Debye model is ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"p21ZJF3HDT"},{"type":"inlineMath","value":"C=1","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eC\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eC=1\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.07153em;\"\u003eC\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"hxPMDzK9cV"},{"type":"text","value":".","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"zYBgahvEzV"}],"key":"fViD0jHZzb"}],"key":"Og9dVuaHmJ"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"When electrical conductivities ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"YQkRk9vbt5"},{"type":"inlineMath","value":"\\sigma_\\infty","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003eσ\u003c/mi\u003e\u003cmi mathvariant=\"normal\"\u003e∞\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\sigma_\\infty\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eσ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e∞\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"n4rYP68ShV"},{"type":"text","value":" are model parameters, ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"xqFukGfcgz"},{"type":"inlineCode","value":"sigmaMap","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"TO5cb5ZMjC"},{"type":"text","value":" sets the mapping from the model to the layer conductivities. In rare instances, electrical conductivities are set directly using the ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"Z53pn2Pfvy"},{"type":"inlineCode","value":"sigma","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"rAI4NpcBLv"},{"type":"text","value":" keyword argument. Unfortunately, SimPEG does not currently have the ability to include the additional parameters used to define dispersive electrical conductivities in the model. As such, these parameters are set as static parameters of the simulation class using the ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"R4f6vMlVIk"},{"type":"inlineCode","value":"eta","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"xHTeVzQorn"},{"type":"text","value":", ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"HLOzjiQbxe"},{"type":"inlineCode","value":"tau","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"IdRbra9s86"},{"type":"text","value":" and ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"sA9pOZn2D1"},{"type":"inlineCode","value":"C","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"FIjrk3sDfO"},{"type":"text","value":" keyword arguments.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"IOQwFiV8B1"}],"key":"f05BDjcxR5"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"strong","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Important:","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"TQRhptaIpu"}],"key":"JQfVKfgLOz"},{"type":"text","value":" In order for the 1D simulation to model dispersive conductivities correctly, none of the values used to set ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"m5TxNA5s2H"},{"type":"inlineCode","value":"eta","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"TOvI7OT4HY"},{"type":"text","value":" can be equal to zero, even if the layer is non-chargeable. To model non-chargeable layers, simply set the value to something small.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"fUyQRhDY90"}],"key":"qKSkMr2hFe"}],"data":{"type":"notebook-content"},"key":"L23POQroTn"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"eta = 0.5  # intrinsic chargeability [0, 1]\ntau = 0.001  # central time-relaxation constant in seconds\nc = 0.8  # phase constant [0, 1]\n\nlayer_eta = np.r_[1e-10, eta, 1e-10]\nlayer_tau = np.r_[0.0, tau, 0.0]\nlayer_c = np.r_[0.0, c, 0.0]","key":"r5E32rzcVk"},{"type":"output","id":"I347O7HRdgLj2JG9CqddO","data":[],"key":"FJg6u1X1E4"}],"data":{"type":"notebook-code"},"key":"sQD49CpJID"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"simulation_ip = tdem.Simulation1DLayered(\n    survey=survey,\n    thicknesses=layer_thicknesses,\n    sigmaMap=conductivity_map,\n    eta=layer_eta,\n    tau=layer_tau,\n    c=layer_c,\n)","key":"EOeAoy9tS2"},{"type":"output","id":"rVnNwfW79lPcK2gC52Qc7","data":[],"key":"bakhYbkVKi"}],"data":{"type":"notebook-code"},"key":"Qa8TJ0LaIG"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"dpred_ip = simulation_ip.dpred(conductivity_model)","key":"VVf8CBVOUW"},{"type":"output","id":"hSqfZbYGWk1_nw9OeG4JD","data":[],"key":"NRX7gJMfgT"}],"data":{"type":"notebook-code"},"key":"AceB4KFBo0"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Case 3: the top layer exhibits superparamagnetism (SPM)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Dwwoei8Tna"}],"identifier":"case-3-the-top-layer-exhibits-superparamagnetism-spm","label":"Case 3: the top layer exhibits superparamagnetism (SPM)","html_id":"case-3-the-top-layer-exhibits-superparamagnetism-spm","implicit":true,"key":"hWtSvJUfKm"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this case, the top layer exhibits superparamagnetism (or viscous remanent magnetization). In SimPEG, we use a log-uniform distribution of time relaxation constants to define the dispersive magnetization, see ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eQicrYgjhA"},{"type":"link","url":"https://em.geosci.xyz/content/physical_properties/magnetic_permeability/magnetic_permeability_frequency_dependent.html","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"EM GeoSci","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XW403Y8XYj"}],"urlSource":"https://em.geosci.xyz/content/physical_properties/magnetic_permeability/magnetic_permeability_frequency_dependent.html","key":"RHapbpRERD"},{"type":"text","value":":","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"h6I5xJoHyN"}],"key":"YHXItvpntD"},{"type":"math","value":"\\mu_{spm}(\\omega ) = \\mu + \\mu_0 \\Delta \\chi \\Bigg [\n1 - \\Bigg ( \\frac{1}{ln (\\tau_2 / \\tau_1 )} \\Bigg )\nln \\Bigg ( \\frac{1 + i\\omega \\tau_2}{1 + i\\omega \\tau_1} ) \\Bigg )\n\\Bigg ]","position":{"start":{"line":5,"column":1},"end":{"line":10,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003eμ\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003es\u003c/mi\u003e\u003cmi\u003ep\u003c/mi\u003e\u003cmi\u003em\u003c/mi\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003eω\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi\u003eμ\u003c/mi\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003eμ\u003c/mi\u003e\u003cmn\u003e0\u003c/mn\u003e\u003c/msub\u003e\u003cmi mathvariant=\"normal\"\u003eΔ\u003c/mi\u003e\u003cmi\u003eχ\u003c/mi\u003e\u003cmo fence=\"false\" stretchy=\"true\" minsize=\"3em\" maxsize=\"3em\"\u003e[\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmo fence=\"false\" stretchy=\"true\" minsize=\"3em\" maxsize=\"3em\"\u003e(\u003c/mo\u003e\u003cmfrac\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmrow\u003e\u003cmi\u003el\u003c/mi\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003eτ\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msub\u003e\u003cmi mathvariant=\"normal\"\u003e/\u003c/mi\u003e\u003cmsub\u003e\u003cmi\u003eτ\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003cmo fence=\"false\" stretchy=\"true\" minsize=\"3em\" maxsize=\"3em\"\u003e)\u003c/mo\u003e\u003cmi\u003el\u003c/mi\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmo fence=\"false\" stretchy=\"true\" minsize=\"3em\" maxsize=\"3em\"\u003e(\u003c/mo\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmi\u003eω\u003c/mi\u003e\u003cmsub\u003e\u003cmi\u003eτ\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmi\u003eω\u003c/mi\u003e\u003cmsub\u003e\u003cmi\u003eτ\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo fence=\"false\" stretchy=\"true\" minsize=\"3em\" maxsize=\"3em\"\u003e)\u003c/mo\u003e\u003cmo fence=\"false\" stretchy=\"true\" minsize=\"3em\" maxsize=\"3em\"\u003e]\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mu_{spm}(\\omega ) = \\mu + \\mu_0 \\Delta \\chi \\Bigg [\n1 - \\Bigg ( \\frac{1}{ln (\\tau_2 / \\tau_1 )} \\Bigg )\nln \\Bigg ( \\frac{1 + i\\omega \\tau_2}{1 + i\\omega \\tau_1} ) \\Bigg )\n\\Bigg ]\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eμ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003es\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ep\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003em\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eω\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7778em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eμ\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:3em;vertical-align:-1.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eμ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e0\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003eΔ\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eχ\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"delimsizing size4\"\u003e[\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:3em;vertical-align:-1.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"delimsizing size4\"\u003e(\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3214em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.01968em;\"\u003el\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.1132em;\"\u003eτ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e/\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.1132em;\"\u003eτ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.936em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"delimsizing size4\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.01968em;\"\u003el\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"delimsizing size4\"\u003e(\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3365em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eiω\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.1132em;\"\u003eτ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eiω\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.1132em;\"\u003eτ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.836em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"delimsizing size4\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"delimsizing size4\"\u003e]\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"2","key":"gDkSUSiB9u"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"where:","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"BZwERcFLIy"}],"key":"xORChIdr63"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":14,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"ω","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"ch2FuCTiVJ"},{"type":"text","value":" is the radial frequency (rad/s)","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"josi8X6BOl"}],"key":"OhQQzCBMFO"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"inlineMath","value":"\\mu_0","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003eμ\u003c/mi\u003e\u003cmn\u003e0\u003c/mn\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mu_0\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eμ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e0\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"D3F23UJcnU"},{"type":"text","value":" is the permeability of free space","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"stTHggQUlc"}],"key":"X1K8gzGi6t"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"μ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"mWYa9xS3qW"},{"type":"text","value":" is the infinity frequency magnetic permeability","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"UmFzQMAmxW"}],"key":"hdsL0Iuh4C"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"inlineMath","value":"0\\leq \\Delta \\chi","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmn\u003e0\u003c/mn\u003e\u003cmo\u003e≤\u003c/mo\u003e\u003cmi mathvariant=\"normal\"\u003eΔ\u003c/mi\u003e\u003cmi\u003eχ\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e0\\leq \\Delta \\chi\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e≤\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003eΔ\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eχ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"ItzBfCXrxj"},{"type":"text","value":" (unitless) is the DC susceptibility for the SPM effect","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"A8vNQkYd3q"}],"key":"hzd5ap4brS"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"inlineMath","value":"0 \u003c \\tau_1 \u003c \\tau_2","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmn\u003e0\u003c/mn\u003e\u003cmo\u003e\u0026lt;\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003eτ\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003cmo\u003e\u0026lt;\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003eτ\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e0 \u0026lt; \\tau_1 \u0026lt; \\tau_2\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6835em;vertical-align:-0.0391em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6891em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.1132em;\"\u003eτ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.1132em;\"\u003eτ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"tr6Zv2et7K"},{"type":"text","value":" are the lower and upper bounds for the log-uniform distribution of time-relaxation constants","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"gQUit617fi"}],"key":"p40tcwxd4V"}],"key":"kSWWpCvElX"},{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"When magnetic permeabilities ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"Dcc78hWXTs"},{"type":"text","value":"μ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"HijSUtlonH"},{"type":"text","value":" are model parameters, ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"VD3SkZQvgd"},{"type":"inlineCode","value":"muMap","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"YMvLs35mK5"},{"type":"text","value":" sets the mapping from the model to the layer permeabilities. In rare instances, magnetic permeabilities are set directly using the ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"wvnetNssLn"},{"type":"inlineCode","value":"mu","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"go5Pcyf9nz"},{"type":"text","value":" keyword argument. Unfortunately, SimPEG does not currently have the ability to include the additional parameters used to define dispersive magnetic permeability in the model. As such, these parameters are set as static parameters of the simulation class using the ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"BwpKdPbNLe"},{"type":"inlineCode","value":"dchi","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"IxrYiulcGR"},{"type":"text","value":", ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"CJVM4fe2z0"},{"type":"inlineCode","value":"tau1","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"DUuPvva67o"},{"type":"text","value":" and ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"G5fUqHWZ47"},{"type":"inlineCode","value":"tau2","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"vTmaNdrFLR"},{"type":"text","value":" keyword arguments.","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"fscq1kaaFk"}],"key":"bDQC3Hk493"}],"data":{"type":"notebook-content"},"key":"OhLml5leFw"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"chi = 0.01  # infinite susceptibility in SI\ndchi = 0.01  # amplitude of frequency-dependent susceptibility contribution\ntau1 = 1e-7  # lower limit for time relaxation constants in seconds\ntau2 = 1.0  # upper limit for time relaxation constants in seconds\n\nlayer_mu = mu_0 * (1 + chi * np.r_[1.0, 0.0, 0.0])  # convert to permeability\nlayer_dchi = chi * np.r_[1.0, 0.0, 0.0]\nlayer_tau1 = tau1 * np.r_[1.0, 0.0, 0.0]\nlayer_tau2 = tau1 * np.r_[1.0, 0.0, 0.0]","key":"pREIxofTzE"},{"type":"output","id":"lNrFL6mGyDek5qmzvi_Sz","data":[],"key":"N3EgCab6tS"}],"data":{"type":"notebook-code"},"key":"WCvUT0VO6W"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"simulation_spm = tdem.Simulation1DLayered(\n    survey=survey,\n    thicknesses=layer_thicknesses,\n    sigmaMap=conductivity_map,\n    mu=mu_0,\n    dchi=dchi,\n    tau1=tau1,\n    tau2=tau2,\n)","key":"qvsRCXoPw3"},{"type":"output","id":"4tad-N-NjzmUUjg4aW5hz","data":[],"key":"J8GI9t2rqX"}],"data":{"type":"notebook-code"},"key":"BHzIpOJgnF"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"dpred_spm = simulation_spm.dpred(conductivity_model)","key":"okDVCgsfnU"},{"type":"output","id":"HX6TbutdqLuUXi1XpgxcV","data":[],"key":"M1donwiq68"}],"data":{"type":"notebook-code"},"key":"wS2HC1hn3x"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure(figsize=(5, 6))\nax1 = fig.add_axes([0.1, 0.1, 0.8, 0.85])\nax1.loglog(times, np.abs(dpred_conductivity[0 : len(times)]), \"k\", lw=2)\nax1.loglog(times, np.abs(dpred_permeable[0 : len(times)]), \"r\", lw=2)\nax1.loglog(times, np.abs(dpred_ip[0 : len(times)]), \"b\", lw=2)\nax1.loglog(times, np.abs(dpred_spm[0 : len(times)]), \"g\", lw=2)\nax1.set_xlim([times.min(), times.max()])\nax1.grid()\nax1.legend(\n    [\n        \"Conductive layer\",\n        \"Conductive and permeable\",\n        \"Conductive and chargeable\",\n        \"Superparamagnetic case\",\n    ]\n)\nax1.set_xlabel(\"Times (s)\")\nax1.set_ylabel(\"B (T)\")\nax1.set_title(\"Magnetic Flux Density\")\nplt.show()","key":"AdXcLtJsZh"},{"type":"output","id":"MLJb4Buzedz6Qgckn8lUs","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0b8dec03deced793a201f48416de982d","path":"/user-tutorials/build/0b8dec03deced793a201f48416de982d.png"},"text/plain":{"content":"\u003cFigure size 500x600 with 1 Axes\u003e","content_type":"text/plain"}}}],"key":"YIPoJBCq6Q"}],"data":{"type":"notebook-code"},"key":"DdMYpezCzQ"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Part 3: Simulation for Different Waveforms","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P849Uvpol0"}],"identifier":"part-3-simulation-for-different-waveforms","label":"Part 3: Simulation for Different Waveforms","html_id":"part-3-simulation-for-different-waveforms","implicit":true,"key":"RNfPdJey0Y"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this part of the tutorial, we simulate TDEM data for various transmitter waveforms using a single survey object. As we learned in part 1, each waveform will require the construction of a different source object. For any waveform object, the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qJ1AO5vBzp"},{"type":"link","url":"https://docs.simpeg.xyz/content/api/generated/SimPEG.electromagnetics.time_domain.sources.BaseWaveform.eval.html#simpeg.electromagnetics.time_domain.sources.basewaveform.eval","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"eval","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dxzg3Gyrkl"}],"urlSource":"myst:SimPEG#SimPEG.electromagnetics.time_domain.sources.BaseWaveform.eval","internal":false,"protocol":"myst","key":"NMELerpstW"},{"type":"text","value":" method can be used to evaluate the waveform at the time provided.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Ib0b9ATHti"}],"key":"u0Gqec1uN6"}],"data":{"type":"notebook-content"},"key":"SrFTTeE7Jc"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Defining Different Waveforms","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"X6Sm8znUkW"}],"identifier":"defining-different-waveforms","label":"Defining Different Waveforms","html_id":"defining-different-waveforms","implicit":true,"key":"t0nFclpuyb"}],"data":{"type":"notebook-content"},"key":"nX7U9cITL0"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"# Rectangular waveform. The user may customize the waveform by setting the start\n# time, end time and on time amplitude for the current waveform.\neps = 1e-6\nramp_on = np.r_[-0.004, -0.004 + eps]\nramp_off = np.r_[-eps, 0.0]\nrectangular_waveform = tdem.sources.TrapezoidWaveform(\n    ramp_on=ramp_on, ramp_off=ramp_off\n)","key":"AqfcUpXx1n"},{"type":"output","id":"f4-O_f751m2InfmNMesSf","data":[],"key":"vVgE2abiqc"}],"data":{"type":"notebook-code"},"key":"PVtQIVXdcI"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"# Triangular waveform. The user may customize the waveform by setting the start\n# time, peak time, end time and peak amplitude for the current waveform.\neps = 1e-8\nstart_time = -0.02\npeak_time = -0.01\noff_time = 0.0\ntriangle_waveform = tdem.sources.TriangularWaveform(\n    start_time=start_time, peak_time=peak_time, off_time=off_time\n)","key":"MX2RqYzznJ"},{"type":"output","id":"mD_DZ3Ri9EbEvk1siLJbK","data":[],"key":"r88q7lyo9P"}],"data":{"type":"notebook-code"},"key":"Bs0q76cle8"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"# General waveform. This is a fully general way to define the waveform.\n# The use simply provides times and the current.\ndef custom_waveform(t, tmax):\n    out = np.cos(0.5 * np.pi * (t - tmax) / (tmax + 0.02))\n    out[t \u003e= tmax] = 1 + (t[t \u003e= tmax] - tmax) / tmax\n    return out\n\n\nwaveform_times = np.r_[np.linspace(-0.02, -0.011, 10), -np.logspace(-2, -6, 61), 0.0]\nwaveform_current = custom_waveform(waveform_times, -0.0055)\ngeneral_waveform = tdem.sources.PiecewiseLinearWaveform(\n    times=waveform_times, currents=waveform_current\n)","key":"LRurzdEUWt"},{"type":"output","id":"GWVM7vrPFuWpMSWoCzkt7","data":[],"key":"SNAP0qBuLT"}],"data":{"type":"notebook-code"},"key":"iotumW8ELa"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure(figsize=(6, 4))\nax = fig.add_axes([0.1, 0.1, 0.85, 0.8])\n\nax.plot(np.r_[-2e-2, 0.0, 1e-10, 1e-3], np.r_[1.0, 1.0, 0.0, 0.0], \"k\", lw=2)\nplotting_current = [rectangular_waveform.eval(t) for t in waveform_times]\nax.plot(waveform_times, plotting_current, \"b\", lw=2)\nplotting_current = [triangle_waveform.eval(t) for t in waveform_times]\nax.plot(waveform_times, plotting_current, \"r\", lw=2)\nplotting_current = [general_waveform.eval(t) for t in waveform_times]\nax.plot(waveform_times, plotting_current, \"g\", lw=2)\n\nax.grid()\nax.set_xlim([waveform_times.min(), 1e-3])\nax.set_xlabel(\"Time (s)\")\nax.set_ylabel(\"Current (A)\")\nax.set_title(\"Waveforms\")\nax.legend([\"Step-off\", \"Rectangular\", \"Triangle\", \"General\"], loc=\"lower left\")\nplt.show()","key":"xQ61Ku2PY5"},{"type":"output","id":"f7rkipEqFXplYsFIEWSoj","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"06e45a6f2380215cf86c2807770af51c","path":"/user-tutorials/build/06e45a6f2380215cf86c2807770af51c.png"},"text/plain":{"content":"\u003cFigure size 600x400 with 1 Axes\u003e","content_type":"text/plain"}}}],"key":"pt2zDTj38S"}],"data":{"type":"notebook-code"},"key":"N2soIlfwcS"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Designing a Survey with Multiple Sources","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mjybg5pDHa"}],"identifier":"designing-a-survey-with-multiple-sources","label":"Designing a Survey with Multiple Sources","html_id":"designing-a-survey-with-multiple-sources","implicit":true,"key":"eWZz23qaDc"}],"data":{"type":"notebook-content"},"key":"wvyUSQBM6b"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"waveforms_list = [\n    stepoff_waveform,\n    rectangular_waveform,\n    triangle_waveform,\n    general_waveform,\n]","key":"NpF09T8fvL"},{"type":"output","id":"ySQ8DdGHgzzznG-L6uI7M","data":[],"key":"ZbtEAZqgzT"}],"data":{"type":"notebook-code"},"key":"ikCGDIUuB4"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"source_list_multi = []\n\nfor w in waveforms_list:\n    receiver_list_multi = [\n        tdem.receivers.PointMagneticFluxDensity(\n            receiver_locations, times, orientation=receiver_orientation\n        )\n    ]\n\n    source_list_multi.append(\n        tdem.sources.CircularLoop(\n            receiver_list=receiver_list_multi,\n            location=source_location,\n            waveform=w,\n            current=source_current,\n            radius=source_radius,\n        )\n    )\n\n# Define the survey\nsurvey_multi = tdem.Survey(source_list_multi)","key":"qkqhKYn1uY"},{"type":"output","id":"VVuixLnH2LospQE88jTXw","data":[],"key":"NSzEMj7eFW"}],"data":{"type":"notebook-code"},"key":"E4LRhPZBgw"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"simulation_waveforms = tdem.Simulation1DLayered(\n    survey=survey_multi, thicknesses=layer_thicknesses, sigmaMap=conductivity_map\n)","key":"EpSeNcVjO3"},{"type":"output","id":"d6LcbGswR2nZBvyvfnexE","data":[],"key":"kRMF5iDCNs"}],"data":{"type":"notebook-code"},"key":"osrkc9dliC"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"dpred_waveforms = simulation_waveforms.dpred(conductivity_model)","key":"H5szS8OhUX"},{"type":"output","id":"HJaAjSH6tz6lMcaiU4iyc","data":[],"key":"DHtPpPmQTm"}],"data":{"type":"notebook-code"},"key":"wnzEwYsv8q"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure(figsize=(5, 6))\nd = np.reshape(dpred_waveforms, (len(source_list_multi), len(times))).T\nax = fig.add_axes([0.15, 0.15, 0.8, 0.75])\ncolorlist = [\"k\", \"b\", \"r\", \"g\"]\nfor ii, k in enumerate(colorlist):\n    ax.loglog(times, np.abs(d[:, ii]), k, lw=2)\n\nax.set_xlim([times.min(), times.max()])\nax.grid()\nax.legend([\"Step-off\", \"Rectangular\", \"Triangle\", \"General\"])\nax.set_xlabel(\"Times (s)\")\nax.set_ylabel(\"B (T)\")\nax.set_title(\"Magnetic Flux Density\")\nplt.show()","key":"ZPTlVEGhvI"},{"type":"output","id":"O_h6yiatKa0wiVDsxLvpe","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fcae6e583b507243d22b7d0f341c9b3c","path":"/user-tutorials/build/fcae6e583b507243d22b7d0f341c9b3c.png"},"text/plain":{"content":"\u003cFigure size 500x600 with 1 Axes\u003e","content_type":"text/plain"}}}],"key":"ih46HRvYRr"}],"data":{"type":"notebook-code"},"key":"NlsfdqbrDk"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Optional:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qezKBBuT52"}],"key":"i0SROusAFx"},{"type":"text","value":" Write data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bdir1hgjnn"}],"key":"L6cnTuanSI"}],"data":{"type":"notebook-content"},"key":"AiVTGcwWuA"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"if write_output:\n    dir_path = os.path.sep.join([\".\", \"fwd_tdem_1d_outputs\"]) + os.path.sep\n    if not os.path.exists(dir_path):\n        os.mkdir(dir_path)\n\n    np.random.seed(347)\n    noise = (\n        0.05\n        * np.abs(dpred_conductivity)\n        * np.random.normal(size=len(dpred_conductivity))\n    )\n    dpred_conductivity += noise\n    fname = dir_path + \"em1dtm_data.txt\"\n    np.savetxt(fname, np.c_[times, dpred_conductivity], fmt=\"%.4e\", header=\"TIME BZ\")","key":"jHQjRTSUEV"},{"type":"output","id":"xJ0zkx3MxfPz-4X2XKFQx","data":[],"key":"BUrZxdOXaa"}],"data":{"type":"notebook-code"},"key":"FS9qN10PSh"}],"key":"rHvTbT16w4"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Time-Domain Electromagnetics","url":"/tdem-index","group":"SimPEG User Tutorials"},"next":{"title":"Fundamentals of Finite Volume for TDEM Simulations","url":"/fwd-tdem-fundamentals","group":"SimPEG User Tutorials"}}},"domain":"http://localhost:3000"}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":false,"v2_headers":true,"v2_meta":false,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/user-tutorials/build/manifest-FDC5A112.js";
import * as route0 from "/user-tutorials/build/root-2CYAF5SQ.js";
import * as route1 from "/user-tutorials/build/routes/$-ZDWRJY4B.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/user-tutorials/build/entry.client-K6EYMIDZ.js");</script></body></html>