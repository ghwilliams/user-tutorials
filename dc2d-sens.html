<!DOCTYPE html><html lang="en" class="light" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>SimPEG User Tutorials</title><link rel="stylesheet" href="/user-tutorials/build/_assets/app-LVHQOBTF.css"/><link rel="stylesheet" href="/user-tutorials/build/_assets/thebe-core-SJEQ5G4L.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><script defer="" data-domain="simpeg.xyz" src="https://plausible.io/js/plausible.js"></script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 fixed w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-wrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 013.75 6h16.5a.75.75 0 010 1.5H3.75A.75.75 0 013 6.75zM3 12a.75.75 0 01.75-.75h16.5a.75.75 0 010 1.5H3.75A.75.75 0 013 12zm0 5.25a.75.75 0 01.75-.75h16.5a.75.75 0 010 1.5H3.75a.75.75 0 01-.75-.75z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/user-tutorials/"><span class="text-md sm:text-xl tracking-tight sm:mr-5">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button class="theme rounded-full border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Change theme to dark mode." aria-label="Change theme to dark mode."><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="h-full w-full p-0.5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z"></path></svg></button><div class="block sm:hidden"><div class="relative" data-headlessui-state=""><div><button class="flex text-sm bg-transparent rounded-full focus:outline-none" id="headlessui-menu-button-:Rciop:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Open Menu</span><div class="flex items-center text-stone-200 hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="2rem" height="2rem" class="p-1"><path fill-rule="evenodd" d="M10.5 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zm0 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zm0 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0z" clip-rule="evenodd"></path></svg></div></button></div></div></div><div class="hidden sm:block"><a href="https://mystmd.org/guide" target="_blank" rel="noopener noreferrer" class="inline-block px-4 py-2 mx-1 mt-0 leading-none border rounded text-md border-stone-700 dark:border-white text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 hover:bg-neutral-100">Learn More</a></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><nav aria-label="Table of Contents" class="flex-grow overflow-y-auto transition-opacity mt-6 pb-3 ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="SimPEG User Tutorials" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/user-tutorials/">SimPEG User Tutorials</a><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Gravity" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/gravity-index">Gravity</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:R2d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R2d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Magnetics" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/magnetics-index">Magnetics</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:R3d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R3d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Direct Current Resistivity" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/dcr-index">Direct Current Resistivity</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:R4d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R4d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Induced Polarization" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/ip-index">Induced Polarization</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:R5d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R5d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Frequency-Domain Electromagnetics" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/fdem-index">Frequency-Domain Electromagnetics</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:R6d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R6d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Time-Domain Electromagnetics" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/tdem-index">Time-Domain Electromagnetics</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:R7d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R7d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Uncertainty and Resolution analysis" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/uran-index">Uncertainty and Resolution analysis</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" type="button" aria-controls="radix-:R8d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R8d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav><div class="flex-none py-4 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><article class="article content article-grid grid-gap" style="margin-top:60px"><main class="article-grid subgrid-gap col-screen"><div class="sticky z-10 hidden h-0 col-margin-right-inset lg:block" style="top:60px"><nav></nav></div><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="pt-5 mb-8"><div class="flex items-center h-6 mt-3 mb-5 text-sm font-light"><div class="flex-grow"></div><a href="https://github.com/simpeg/user-tutorials" title="GitHub Repository: simpeg/user-tutorials" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block"><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative" id="headlessui-menu-button-:R1khtop:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="ml-2 -mr-1"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">2D DC Resistivity Sensitivity analysis</h1></div><div id="skip-to-article"></div><div id="At4fHN5tjx" class="relative group/block article-grid subgrid-gap col-screen"><aside class="my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden rounded border-l-4 border-amber-600"><div class="m-0 font-medium py-1 flex min-w-0 text-lg text-amber-600 bg-amber-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none text-amber-600"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"></path></svg><div class="text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Intermediate notebook</div></div><div class="px-4 py-1"><p>This tutorial focusses on intermediate level functionality within SimPEG. Basic functionality within SimPEG is not discussed in detail, as we assume the user is already familiar.</p></div></aside></div><div id="Sy1xxTQZLU" class="relative group/block article-grid subgrid-gap col-screen"><aside class="my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden rounded border-l-4 border-green-600"><div class="m-0 font-medium py-1 flex min-w-0 text-lg text-green-600 bg-green-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none text-green-600"><path stroke-linecap="round" stroke-linejoin="round" d="M12 18v-5.25m0 0a6.01 6.01 0 001.5-.189m-1.5.189a6.01 6.01 0 01-1.5-.189m3.75 7.478a12.06 12.06 0 01-4.5 0m3.75 2.383a14.406 14.406 0 01-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 10-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"></path></svg><div class="text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Light-weight notebook</div></div><div class="px-4 py-1"><p>This tutorial requires minimal computational resources and can be executed quickly in the background while other computer processes are running.</p></div></aside></div><div id="VyXtYvw2pm" class="relative group/block article-grid subgrid-gap col-screen"><p><strong>Author:</strong> Williams Lima</p><p><strong>Keywords:</strong> DC Resistivity inversion, sensitivity matrix.</p></div><div id="CpAUvCU9s8" class="relative group/block article-grid subgrid-gap col-screen"><p><strong>Summary:</strong>
The sensitivity matrix is a very important tool for the design of surveys and the implementation of inversion algorithms in geophysics. It can give us qualitative and, to some extent, quantitative information about the sensitivity of the data to perturbations in the physical properties (e.g electrical conductivities) underground. In turn, it can help us design optimized surveys for specific targets. Moreover, it is also of great value in a later interpretation stage, as a tool to assess the resolvability of particular features obtained by the use of inversion methods. In this tutorial we’ll use SimPEG functionalities to look at the sensitivity matrix for the DC resistivity inverse problem. We will use a number of different techniques to analyze the sensitivity patterns for a few commonly used electrode arrays. As study cases, we will apply these techniques for both a homogenous half space and to a real data set in the context of a mineral exploration project.</p><p>Although we use the DC resistivity problem as a leitmotif in this tutorial, the techniques presented here are general enough and can be applied to many other geophysical methods.</p><p>Enjoy!
</p><p><strong>Learning Objectives:</strong></p><ul><li>How to get the sensitivity matrix for a DC resistivity simulation by using utility functions in SimPEG.</li><li>Exploring the different sensitivity patterns for a number of common electrode arrays.</li><li>How to plot information contained in the sensitivity matrix.</li><li>Look at the sensitivity matrix for a real data set.</li></ul></div><div id="YTOm4IfaSF" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="theoretical-background" class="relative group"><span class="heading-text">Theoretical background</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#theoretical-background" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>First of all, we cannot overemphasize the importance of understanding the distinction
that exists in SimPEG between physical properties and modeling/inversion parameters. Every physical simulation component in SimPEG makes use of a particular set of physical properties (conductivity, density, magnetic susceptibility, etc.). On the other hand, when performing an inversion task, we usually define an independent set of parameters and maps between those and the actual physical properties. For example, the DC simulation class implements the solution of the following PDE
</p><div id="CwjIQl6d9v" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo>−</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mrow><mo fence="true">(</mo><mi>σ</mi><mi mathvariant="normal">∇</mi><mi>ϕ</mi><mo fence="true">)</mo></mrow><mo>=</mo><mi>I</mi><mo stretchy="false">(</mo><mi>δ</mi><mo stretchy="false">(</mo><mi>r</mi><mo>−</mo><msub><mi>r</mi><msup><mi>s</mi><mo>+</mo></msup></msub><mo stretchy="false">)</mo><mo>−</mo><mi>δ</mi><mo stretchy="false">(</mo><mi>r</mi><mo>−</mo><msub><mi>r</mi><msup><mi>s</mi><mo>−</mo></msup></msub><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">
-\nabla\cdot\left(\sigma\nabla\phi\right) = I(\delta(r-r_{s^+}) - \delta(r-r_{s^-}),</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">∇</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mord">∇</span><span class="mord mathnormal">ϕ</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3419em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7027em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3419em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7027em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mbin mtight">−</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="select-none no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit hover:underline" href="#CwjIQl6d9v" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->1<!-- -->)</a></div></div><p>
where the relevant physical property is the electrical conductivity <!-- -->σ<!-- -->. In an inversion context, the inversion parameter would be defined as <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><mi>σ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">m = ln(\sigma)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mclose">)</span></span></span></span></span>. In this case we would define a map such that <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma = exp(m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span></span> and pass this map to the simulation object so it could correctly convert the inversion parameter <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></span> to the actual physical property <!-- -->σ<!-- --> used in the simulation. In SimPEG we can define composite mappings <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">M</mi></mrow><annotation encoding="application/x-tex">\mathcal{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal">M</span></span></span></span></span> resulting from the composition of any number of maps, the relation between the physical properties and model parameters being given by <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mi mathvariant="script">M</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma = \mathcal{M}(m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal">M</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span></span>.</p><p>When computing sensitivities, the chain rule is used to correctly take into account the composition of maps. We will see later that the derivatives returned by the method <em><strong>getJ</strong></em> (which returns the Jacobian matrix) are always computed with respect to model parameters.</p><p><strong>The mechanics of sensitivity computation</strong></p><p>Many of the simulations performed in SimPEG rely on the solution of an algebraic system of linear equations of the form
</p><div id="ldhDYd2FO3" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>A</mi><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo><mi>u</mi><mo>=</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">
A(c)u = q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="select-none no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit hover:underline" href="#ldhDYd2FO3" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->2<!-- -->)</a></div></div><p>
where <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span> is a matrix obtained after discretization of the relevant PDE,
<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span> is a the physical property vector, <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span></span> is a source term vector. Once this system is solved for <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span></span>, a given physical field <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span></span> (e.g. electric/magnetic field components) can be obtained as a relation like
</p><div id="HA509y0a27" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>s</mi><mi>e</mi></msub><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>s</mi><mi>m</mi></msub><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
f = f(u(m), s_e(m), s_m(m), m).</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="select-none no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit hover:underline" href="#HA509y0a27" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->3<!-- -->)</a></div></div><p>
Finally, the predicted data <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mtext>pred</mtext></msub></mrow><annotation encoding="application/x-tex">d_\text{pred}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">pred</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span> is obtained through
</p><div id="bDLmQ3VuHm" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>d</mi><mtext>pred</mtext></msub><mo>=</mo><mi>P</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
d_\text{pred} = P(f)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">pred</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mclose">)</span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="select-none no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit hover:underline" href="#bDLmQ3VuHm" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->4<!-- -->)</a></div></div><p>
where the operator <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></span> “selects the component of interest and interpolates
the fields to the receiver locaions” (Heagy2018).</p><p>The core component in the sensitivity analysis is the Jacobian matrix, defined as
</p><div id="JRtwNVAkLh" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>J</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>d</mi><mtext>pred</mtext></msub></mrow><mrow><mi mathvariant="normal">∂</mi><mi>m</mi></mrow></mfrac><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
J(m) = \frac{\partial d_\text{pred}}{\partial m}.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">pred</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">.</span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="select-none no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit hover:underline" href="#JRtwNVAkLh" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->5<!-- -->)</a></div></div><p>
Considering all those intermediate transformations, in order to get <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi></mrow><annotation encoding="application/x-tex">J</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span></span></span></span></span>, applying the chain rule we have
</p><div id="VKeT7OvTK1" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>J</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mi>d</mi><mi>P</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo></mrow><mrow><mi>d</mi><mi>f</mi></mrow></mfrac><mfrac><mrow><mi>d</mi><mi>f</mi></mrow><mrow><mi>d</mi><mi>σ</mi></mrow></mfrac><mfrac><mrow><mi>d</mi><mi>σ</mi></mrow><mrow><mi>d</mi><mi>m</mi></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munder><munder><mrow><mo fence="true">(</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>u</mi></mrow></mfrac><mover><mover><mfrac><mrow><mi>d</mi><mi>u</mi></mrow><mrow><mi>d</mi><mi>σ</mi></mrow></mfrac><mo stretchy="true">⏞</mo></mover><mtext>Physics</mtext></mover><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>s</mi><mi>m</mi></msub></mrow></mfrac><mover><mover><mfrac><mrow><mi>d</mi><msub><mi>s</mi><mi>m</mi></msub></mrow><mrow><mi>d</mi><mi>σ</mi></mrow></mfrac><mo stretchy="true">⏞</mo></mover><mtext>Sources</mtext></mover><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>s</mi><mi>e</mi></msub></mrow></mfrac><mover><mover><mfrac><mrow><mi>d</mi><msub><mi>s</mi><mi>e</mi></msub></mrow><mrow><mi>d</mi><mi>σ</mi></mrow></mfrac><mo stretchy="true">⏞</mo></mover><mtext>Sources</mtext></mover><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>σ</mi></mrow></mfrac><mo fence="true">)</mo></mrow><mo stretchy="true">⏟</mo></munder><mtext>Fields</mtext></munder><munder><munder><mfrac><mrow><mi>d</mi><mi>σ</mi></mrow><mrow><mi>d</mi><mi>m</mi></mrow></mfrac><mo stretchy="true">⏟</mo></munder><mtext>Properties</mtext></munder></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
J(m) &amp;= \frac{dP(f)}{df}\frac{df}{d\sigma}\frac{d\sigma}{dm}\\
 &amp;= \underbrace{\left(\frac{\partial f}{\partial u}\overbrace{\frac{du}{d\sigma}}^\text{Physics} +
    \frac{\partial f}{\partial s_m}\overbrace{\frac{ds_m}{d\sigma}}^\text{Sources} +
    \frac{\partial f}{\partial s_e}\overbrace{\frac{ds_e}{d\sigma}}^\text{Sources} +
    \frac{\partial f}{\partial\sigma}\right)}_\text{Fields}\underbrace{\frac{d\sigma}{dm}}_\text{Properties}
\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:9.2332em;vertical-align:-4.3666em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.8666em;"><span style="top:-8.2813em;"><span class="pstrut" style="height:4.8417em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span><span style="top:-4.2592em;"><span class="pstrut" style="height:4.8417em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.3666em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.8666em;"><span style="top:-8.2813em;"><span class="pstrut" style="height:4.8417em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">df</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">df</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-4.2592em;"><span class="pstrut" style="height:4.8417em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.8417em;"><span style="top:-1.3575em;"><span class="pstrut" style="height:4.8417em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">Fields</span></span></span></span><span style="top:-4.8417em;"><span class="pstrut" style="height:4.8417em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.8417em;"><span class="svg-align" style="top:-2.0436em;"><span class="pstrut" style="height:4.8417em;"></span><span class="stretchy" style="height:0.548em;min-width:1.6em;"><span class="brace-left" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'><path d='M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z'/></svg></span><span class="brace-center" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'><path d='M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z'/></svg></span><span class="brace-right" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'><path d='M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z'/></svg></span></span></span><span style="top:-4.8417em;"><span class="pstrut" style="height:4.8417em;"></span><span class="mord"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-1.711em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>⎝</span></span></span><span style="top:-2.858em;"><span class="pstrut" style="height:3.216em;"></span><span style="height:1.216em;width:0.875em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.875em' height='1.216em' style='width:0.875em' viewBox='0 0 875 1216' preserveAspectRatio='xMinYMin'><path d='M291 0 H417 V1216 H291z M291 0 H417 V1216 H291z'/></svg></span></span><span style="top:-4.7111em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>⎛</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">u</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mover"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.8417em;"><span style="top:-4.0194em;"><span class="pstrut" style="height:4.0194em;"></span><span class="mord mover"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0194em;"><span style="top:-3.3714em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="svg-align" style="top:-4.8429em;"><span class="pstrut" style="height:3.3714em;"></span><span class="stretchy" style="height:0.548em;min-width:1.6em;"><span class="brace-left" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'><path d='M6 548l-6-6v-35l6-11c56-104 135.3-181.3 238-232 57.3-28.7 117
-45 179-50h399577v120H403c-43.3 7-81 15-113 26-100.7 33-179.7 91-237 174-2.7
 5-6 9-10 13-.7 1-7.3 1-20 1H6z'/></svg></span><span class="brace-center" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'><path d='M200428 334
c-100.7-8.3-195.3-44-280-108-55.3-42-101.7-93-139-153l-9-14c-2.7 4-5.7 8.7-9 14
-53.3 86.7-123.7 153-211 199-66.7 36-137.3 56.3-212 62H0V214h199568c178.3-11.7
 311.7-78.3 403-201 6-8 9.7-12 11-12 .7-.7 6.7-1 18-1s17.3.3 18 1c1.3 0 5 4 11
 12 44.7 59.3 101.3 106.3 170 141s145.3 54.3 229 60h199572v120z'/></svg></span><span class="brace-right" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'><path d='M400000 542l
-6 6h-17c-12.7 0-19.3-.3-20-1-4-4-7.3-8.3-10-13-35.3-51.3-80.8-93.8-136.5-127.5
s-117.2-55.8-184.5-66.5c-.7 0-2-.3-4-1-18.7-2.7-76-4.3-172-5H0V214h399571l6 1
c124.7 8 235 61.7 331 161 31.3 33.3 59.7 72.7 85 118l7 13v35z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span></span><span style="top:-6.375em;"><span class="pstrut" style="height:4.0194em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">Physics</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mover"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6978em;"><span style="top:-4.0194em;"><span class="pstrut" style="height:4.0194em;"></span><span class="mord mover"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0194em;"><span style="top:-3.3714em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="svg-align" style="top:-4.8429em;"><span class="pstrut" style="height:3.3714em;"></span><span class="stretchy" style="height:0.548em;min-width:1.6em;"><span class="brace-left" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'><path d='M6 548l-6-6v-35l6-11c56-104 135.3-181.3 238-232 57.3-28.7 117
-45 179-50h399577v120H403c-43.3 7-81 15-113 26-100.7 33-179.7 91-237 174-2.7
 5-6 9-10 13-.7 1-7.3 1-20 1H6z'/></svg></span><span class="brace-center" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'><path d='M200428 334
c-100.7-8.3-195.3-44-280-108-55.3-42-101.7-93-139-153l-9-14c-2.7 4-5.7 8.7-9 14
-53.3 86.7-123.7 153-211 199-66.7 36-137.3 56.3-212 62H0V214h199568c178.3-11.7
 311.7-78.3 403-201 6-8 9.7-12 11-12 .7-.7 6.7-1 18-1s17.3.3 18 1c1.3 0 5 4 11
 12 44.7 59.3 101.3 106.3 170 141s145.3 54.3 229 60h199572v120z'/></svg></span><span class="brace-right" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'><path d='M400000 542l
-6 6h-17c-12.7 0-19.3-.3-20-1-4-4-7.3-8.3-10-13-35.3-51.3-80.8-93.8-136.5-127.5
s-117.2-55.8-184.5-66.5c-.7 0-2-.3-4-1-18.7-2.7-76-4.3-172-5H0V214h399571l6 1
c124.7 8 235 61.7 331 161 31.3 33.3 59.7 72.7 85 118l7 13v35z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span></span><span style="top:-6.2389em;"><span class="pstrut" style="height:4.0194em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">Sources</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mover"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6978em;"><span style="top:-4.0194em;"><span class="pstrut" style="height:4.0194em;"></span><span class="mord mover"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0194em;"><span style="top:-3.3714em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="svg-align" style="top:-4.8429em;"><span class="pstrut" style="height:3.3714em;"></span><span class="stretchy" style="height:0.548em;min-width:1.6em;"><span class="brace-left" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'><path d='M6 548l-6-6v-35l6-11c56-104 135.3-181.3 238-232 57.3-28.7 117
-45 179-50h399577v120H403c-43.3 7-81 15-113 26-100.7 33-179.7 91-237 174-2.7
 5-6 9-10 13-.7 1-7.3 1-20 1H6z'/></svg></span><span class="brace-center" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'><path d='M200428 334
c-100.7-8.3-195.3-44-280-108-55.3-42-101.7-93-139-153l-9-14c-2.7 4-5.7 8.7-9 14
-53.3 86.7-123.7 153-211 199-66.7 36-137.3 56.3-212 62H0V214h199568c178.3-11.7
 311.7-78.3 403-201 6-8 9.7-12 11-12 .7-.7 6.7-1 18-1s17.3.3 18 1c1.3 0 5 4 11
 12 44.7 59.3 101.3 106.3 170 141s145.3 54.3 229 60h199572v120z'/></svg></span><span class="brace-right" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'><path d='M400000 542l
-6 6h-17c-12.7 0-19.3-.3-20-1-4-4-7.3-8.3-10-13-35.3-51.3-80.8-93.8-136.5-127.5
s-117.2-55.8-184.5-66.5c-.7 0-2-.3-4-1-18.7-2.7-76-4.3-172-5H0V214h399571l6 1
c124.7 8 235 61.7 331 161 31.3 33.3 59.7 72.7 85 118l7 13v35z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span></span><span style="top:-6.2389em;"><span class="pstrut" style="height:4.0194em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">Sources</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-1.711em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>⎠</span></span></span><span style="top:-2.858em;"><span class="pstrut" style="height:3.216em;"></span><span style="height:1.216em;width:0.875em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.875em' height='1.216em' style='width:0.875em' viewBox='0 0 875 1216' preserveAspectRatio='xMinYMin'><path d='M457 0 H583 V1216 H457z M457 0 H583 V1216 H457z'/></svg></span></span><span style="top:-4.7111em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>⎞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.798em;"><span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.4841em;"><span></span></span></span></span></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-1.3591em;"><span class="pstrut" style="height:3.3714em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">Properties</span></span></span></span><span style="top:-3.3714em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span class="svg-align" style="top:-2.0374em;"><span class="pstrut" style="height:3.3714em;"></span><span class="stretchy" style="height:0.548em;min-width:1.6em;"><span class="brace-left" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'><path d='M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z'/></svg></span><span class="brace-center" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'><path d='M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z'/></svg></span><span class="brace-right" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'><path d='M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z'/></svg></span></span></span><span style="top:-3.3714em;"><span class="pstrut" style="height:3.3714em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.334em;"><span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.1484em;"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.3666em;"><span></span></span></span></span></span></span></span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="select-none no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit hover:underline" href="#VKeT7OvTK1" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->6<!-- -->)</a></div></div><p>To successfully translate eq to code we need to know how those different quantities are represented in the SimPEG echosystem. Table below gives a summary of the identification of the with SimPEG/python objects.</p><table><tbody><tr><th>Theoretical</th><th>SimPEG</th></tr><tr><td>J</td><td>numpy.ndarray (N,M)</td></tr><tr><td>m</td><td>numpy.ndarray (M)</td></tr><tr><td>f</td><td>SimPEG.fields.Fields</td></tr></tbody></table><p>With this we finish our review of some concepts related to the computation of the sensitivity matrix in SimPEG, now it is time to look at an actual problem.</p></div><div id="tu1sNRjkAq" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="import-modules" class="relative group"><span class="heading-text">Import modules</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#import-modules" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Here, we import all of the functionality required to run the notebook for the tutorial exercise. All of the functionality specific to DC resistivity is imported from <a target="_blank" href="https://docs.simpeg.xyz/content/api/SimPEG.electromagnetics.static.resistivity.html#module-simpeg.electromagnetics.static.resistivity" rel="noreferrer">SimPEG<wbr/>.electromagnetics<wbr/>.static<wbr/>.resistivity</a>.</p><p>We also import some useful utility functions from <a target="_blank" href="https://docs.simpeg.xyz/content/api/SimPEG.utils.html#module-simpeg.utils" rel="noreferrer">SimPEG.utils</a>. To simulate DC resistivity data, we need to define our problem geometry on a numerical grid (or mesh).
To generate the mesh, we used the <a target="_blank" href="https://discretize.simpeg.xyz/en/main" rel="noreferrer">discretize</a> package.</p></div><div id="DadQa1jqsZ" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># SimPEG functionality
from SimPEG.electromagnetics.static import resistivity as dc
from SimPEG import maps

# discretize functionality
from discretize import TreeMesh, TensorMesh

# Common Python functionality
import numpy as np
import matplotlib as mpl
import matplotlib.pyplot as plt
from matplotlib.colors import LogNorm

# SimPEG inversion machinery
from SimPEG import (
    Data,
    data_misfit,
    regularization,
    optimization,
    inverse_problem,
    inversion,
    directives,
)

from SimPEG.electromagnetics.static import utils as dc_utils

# linear solvers
try:
    from pymatsolver import Pardiso as Solver  # this is a fast linear solver
except ImportError:
    from SimPEG import SolverLU as Solver  # this will be slower</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="4fkBpimaB_IwJZTXrikCH" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="CltN9YBrRZ" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="homogeneous-half-space" class="relative group"><span class="heading-text">Homogeneous half space</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#homogeneous-half-space" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="wwT56wpKYI" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="define-surveys" class="relative group"><span class="heading-text">Define surveys</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#define-surveys" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>There are many different possible combinations of current and potential electrodes locations that could be used to create a DC resistivity survey. Maybe some of those combinations would be better than others for a particular case under specific constraints such as cost, physical constraints, time and sensitivity to a particular target at depth. The sensitivity analysis, that we are going to perform in this tutorial, will help us with the task of assessing the performance of a given electrode array with respect to its sensitivity to conductivity anomalies around a particular target region in the subsurface. For more information about DC resistivity modeling in SimPEG check out the tutorial <a target="_blank" href="05-dcr/fwd_dcr_2d" rel="noreferrer">2.5D DC Resistivity Simulation</a>.</p><p>In the figure below, we can see a few of the most common array configurations used in the industry and academic works.</p><figure id="quvUEtGLbx" class=""><img style="width:350px;margin:0 auto" src="/user-tutorials/build/f037fe2572b5e1b2bf477ba85272db70.gif" alt="DC resistivity arrays (image source)" data-canonical-url="https://gpg.geosci.xyz/_images/figure6.gif"/><figcaption class="group"><p>DC resistivity arrays (<a target="_blank" href="https://gpg.geosci.xyz/_images/figure6.gif" rel="noreferrer">image source</a>)</p></figcaption></figure></div><div id="mVurvLzreZ" class="relative group/block article-grid subgrid-gap col-screen"><p><strong>Two simple surveys in a homogeneous medium</strong></p><p>Our first step is to create two simple surveys, Wenner alpha and Wenner beta. Each of theses surveys will contain one pair of current electrodes and one pair of potential electrodes only. The extension to any number of current/potential electrodes is straightforward and will be left as an exercise.</p></div><div id="y9BterYb23" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Define survey line parameters for Wenner surveys
data_type = &quot;volt&quot;
src_list = []

# Wenner alpha
C_wenner_alpha = np.array([[-15.0, 0.0], [15.0, 0.0]])
P_wenner_alpha = np.array([[-5.0, 0.0], [5.0, 0.0]])

rx_wenner_alpha = dc.receivers.Dipole(
    locations_m=P_wenner_alpha[0],
    locations_n=P_wenner_alpha[1],
    data_type=data_type
)
rx_list_wenner_alpha = [rx_wenner_alpha]

src_list.append(
    dc.sources.Dipole(
        location_a=C_wenner_alpha[0],
        location_b=C_wenner_alpha[1],
        receiver_list=rx_list_wenner_alpha,
    )
)

# Dipole-Dipole
C_dipole_dipole = np.array([[-15.0, 0.0], [-5.0, 0.0]])
P_dipole_dipole = np.array([[5.0, 0.0], [15.0, 0.0]])

rx_dipole_dipole = dc.receivers.Dipole(
    locations_m=P_dipole_dipole[0],
    locations_n=P_dipole_dipole[1],
    data_type=data_type
)
rx_list_dipole_dipole = [rx_dipole_dipole]

src_list.append(
    dc.sources.Dipole(
        location_a=C_dipole_dipole[0],
        location_b=C_dipole_dipole[1],
        receiver_list=rx_list_dipole_dipole,
    )
)

survey = dc.Survey(source_list=src_list)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="h44f8ZOaoDEY4wgSLtJx4" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="XTRk5MRVbn" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="create-mesh" class="relative group"><span class="heading-text">Create mesh</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#create-mesh" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="d5zPEa78cR" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">dh = 0.25  # base cell width
dom_width_x = 150.0  # domain width x
dom_width_z = 100.0  # domain width z
nbcx = 2 ** int(np.round(np.log(dom_width_x / dh) / np.log(2.0)))
nbcz = 2 ** int(np.round(np.log(dom_width_z / dh) / np.log(2.0)))

# Define the base mesh with top at z = 0 m.
hx = [(dh, nbcx)]
hz = [(dh, nbcz)]
mesh = TreeMesh([hx, hz], x0=&quot;CN&quot;)

# Refine core mesh region
mesh.refine_box([-50, -50], [50, 0], levels=-1, finalize=False)

mesh.finalize()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="0Lmc_-6ICMlLl6sbWl5Bj" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="XZxD7CehSU" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="define-the-conductivity-model" class="relative group"><span class="heading-text">Define the conductivity model</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#define-the-conductivity-model" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="NF78DEAACJ" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">background_resistivity = 50  # Ohm.m
background_conductivity = 1 / background_resistivity
nC = mesh.nC
conductivity_model = background_conductivity * np.ones(nC)

conductivity_map = maps.IdentityMap()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="-5laFRfH1HPf90bMhTubj" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="Hyr1Y2aCk3" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># DC simulation for a conductivity model
simulation_con = dc.simulation_2d.Simulation2DNodal(
    mesh, survey=survey, sigmaMap=conductivity_map
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="zZM-fCPK2Mh7429tOAVGZ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="t7uhySDmO8" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="plot-sensitivity" class="relative group"><span class="heading-text">Plot sensitivity</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#plot-sensitivity" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="dI1TCNL9EE" class="relative group/block article-grid subgrid-gap col-screen"><p><strong>Get the sensitivity matrix</strong></p></div><div id="tNXOo60wiO" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">J = simulation_con.getJ(conductivity_model).copy()
J_wenner_alpha = J[0, :] / np.max(abs(J[0, :]))
J_dipole_dipole = J[1, :] / np.max(abs(J[1, :]))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="obRP539C1hceoJTZ14NBJ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="EI96tDITDR" class="relative group/block article-grid subgrid-gap col-screen"><p><strong>Make plots</strong></p></div><div id="FoUZwN7SWW" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">##
#
fig, axs = plt.subplots(1, 2, figsize=(10, 2))
plt.jet()

norm = mpl.colors.SymLogNorm(
    linthresh=0.005, linscale=1e-4, vmin=-1.0, vmax=1.0, base=10
)

Js = np.c_[J_wenner_alpha, J_dipole_dipole]
C_locs = np.r_[C_wenner_alpha, C_dipole_dipole]
P_locs = np.r_[P_wenner_alpha, P_dipole_dipole]

plt_titles = [&quot;Wenner alpha&quot;, &quot;dipole-dipole&quot;]
i = 0
for ax in axs:
    mesh.plot_image(Js[:, i], ax=ax, grid=False, pcolor_opts={&quot;norm&quot;: norm})

    xmin = -50
    xmax = 50
    zmin = -20
    zmax = 0
    ax.set_xlim(xmin, xmax)
    ax.set_ylim(zmin, zmax)
    ax.set_title(plt_titles[i], loc=&quot;left&quot;)
    ax.set_xlabel(&quot;x (m)&quot;)
    ax.set_ylabel(&quot;z (m)&quot;)

    xc = (C_locs[2 * i, 0] - xmin) / (xmax - xmin)
    ax.annotate(
        &quot;&quot;,
        xy=(xc, 1),
        xycoords=&quot;axes fraction&quot;,
        xytext=(xc, 1.1),
        arrowprops=dict(arrowstyle=&quot;-&gt;&quot;, color=&quot;r&quot;),
    )
    xc = (C_locs[2 * i + 1, 0] - xmin) / (xmax - xmin)
    ax.annotate(
        &quot;&quot;,
        xy=(xc, 1),
        xycoords=&quot;axes fraction&quot;,
        xytext=(xc, 1.1),
        arrowprops=dict(arrowstyle=&quot;-&gt;&quot;, color=&quot;r&quot;),
    )
    xc = (P_locs[2 * i, 0] - xmin) / (xmax - xmin)
    ax.annotate(
        &quot;&quot;,
        xy=(xc, 1),
        xycoords=&quot;axes fraction&quot;,
        xytext=(xc, 1.075),
        arrowprops=dict(arrowstyle=&quot;-&gt;&quot;, color=&quot;b&quot;),
    )
    xc = (P_locs[2 * i + 1, 0] - xmin) / (xmax - xmin)
    ax.annotate(
        &quot;&quot;,
        xy=(xc, 1),
        xycoords=&quot;axes fraction&quot;,
        xytext=(xc, 1.075),
        arrowprops=dict(arrowstyle=&quot;-&gt;&quot;, color=&quot;b&quot;),
    )

    i = i + 1

ax2 = fig.add_axes([0.25, -0.3, 0.5, 0.1])
cbar = mpl.colorbar.ColorbarBase(ax2, norm=norm, orientation=&quot;horizontal&quot;)
cbar.set_label(&quot;Sensitivity&quot;, rotation=0, labelpad=15, size=12)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="C58TVvTgbuco_UXt9ZjzZ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/user-tutorials/build/c008aa96b4e954ee31d77df7a010d9d1.png" alt="&lt;Figure size 1000x200 with 3 Axes&gt;"/></div></div><div id="vvRDFtm49N" class="relative group/block article-grid subgrid-gap col-screen"><p><em><strong>Cumulative sensitivity of a given array</strong></em></p><p>Let’s experiment with another way to look at the sensitivity matrix. This time we are going to plot the <strong>cumulative sensitivity</strong> <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>S</mi></mrow><annotation encoding="application/x-tex">CS</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">CS</span></span></span></span></span> defined as
</p><div id="Kx6dC9rfQX" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>C</mi><mi>S</mi><mo>=</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>P</mi></munderover><msub><mi>S</mi><mi>i</mi></msub></mrow><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></munderover><msub><mi>S</mi><mi>i</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">
 CS = \frac{\sum_{i=1}^P S_i}{\sum_{i=1}^M S_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">CS</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.8419em;vertical-align:-1.1709em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6709em;"><span style="top:-2.1288em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.6897em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1709em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="select-none no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit hover:underline" href="#Kx6dC9rfQX" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->7<!-- -->)</a></div></div><p>
where <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span></span> contains a particular row of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">∣</mo><mi>J</mi><mo fence="true">∣</mo></mrow><annotation encoding="application/x-tex">\left|J\right|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="mclose delimcenter" style="top:0em;">∣</span></span></span></span></span></span> sorted in decreasing order.</p><p>We took inspiration for this plot from <cite data-state="closed"><a href="https://doi.org/10.2136/vzj2003.4160" target="_blank" rel="noreferrer" class="hover-link">Furman <em>et al.</em> (2003)</a></cite>.</p></div><div id="FFrvI5uma2" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Define survey line parameters
survey_type = &quot;dipole-dipole&quot;
dimension_type = &quot;2D&quot;
data_type = &quot;volt&quot;

src_list = []
C_locs = []
P_locs = []

# Array 1
C = np.array([[-15.0, 0.0], [-5.0, 0.0]])
P = np.array([[5.0, 0.0], [15.0, 0.0]])

C_locs.append(C)
P_locs.append(P)

rx = dc.receivers.Dipole(locations_m=P[0],
                         locations_n=P[1],
                         data_type=data_type)
rx_list = [rx]

src_list.append(
    dc.sources.Dipole(location_a=C[0],
                      location_b=C[1],
                      receiver_list=rx_list)
)

# Array 2
C = np.array([[-30.0, 0.0], [-20.0, 0.0]])
P = np.array([[20.0, 0.0], [30.0, 0.0]])

C_locs.append(C)
P_locs.append(P)

rx = dc.receivers.Dipole(locations_m=P[0],
                         locations_n=P[1],
                         data_type=data_type)
rx_list = [rx]

src_list.append(
    dc.sources.Dipole(location_a=C[0],
                      location_b=C[1],
                      receiver_list=rx_list)
)

# Define survey
survey = dc.Survey(src_list)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Dnop8K1oC0RMW52rGnBza" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="wu1ihPBmcA" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># DC simulation for a conductivity model
simulation_con = dc.simulation_2d.Simulation2DNodal(
    mesh, survey=survey, sigmaMap=conductivity_map
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="E6orettX3ERW3x-49migF" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="LVlpAcRE5r" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">J = simulation_con.getJ(conductivity_model).copy()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="vxxDp-8EU3l8TlD_C2t9l" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="IOyNDxwaEO" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">##
# Interpolate to a regular grid for creating the plots
xmin = -50
xmax = 50.0
grid_nx = 500
zmin = -20.0
zmax = 0.0
grid_nz = 200
[xgrid, zgrid] = np.meshgrid(
    np.linspace(xmin, xmax, grid_nx),
    np.linspace(zmin, zmax, grid_nz)
)
locs = np.vstack([xgrid.ravel(), zgrid.ravel()])
Q = mesh.get_interpolation_matrix(locs.T)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="T2DK47--5ZPcqqUwgK5--" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="oL4cmm8qUr" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">fig, axs = plt.subplots(1, 2, figsize=(10, 2))
levels = [0.95, 0.7, 0.5, 0.2]

i = 0
for ax in axs:
    Js = Q @ J[i, :].T
    ##
    # Fill cells with corresponding
    # cumulative sensitivity values
    Z = np.ones(grid_nz * grid_nx)

    N = np.size(Js)
    CS_all = np.sum(abs(Js))
    Js_sort_idx = (-abs(Js)).argsort()[:N]
    Js_sort = abs(Js[Js_sort_idx])
    for perc in levels:
        CS = 0
        for j in range(N):
            CS = CS + abs(Js_sort[j]) / CS_all
            if CS &gt;= perc:
                break
        Z[Js_sort_idx[0: j + 1]] = perc

    Z = Z.reshape((grid_nz, grid_nx))

    ##
    # Plot
    ax.contourf(xgrid, zgrid, Z,
                levels=np.sort(levels), cmap=&quot;GnBu_r&quot;)
    ccs = ax.contour(
        xgrid, zgrid, Z,
        levels=np.sort(levels),
        colors=&quot;w&quot;, linewidths=0.75
    )
    ax.clabel(ccs, ccs.levels,
              inline=False,
              fmt=&quot;%2.1f&quot;, fontsize=10, colors=&quot;k&quot;)

    ##
    # Plot electrodes locations
    xc = (C_locs[i][0, 0] - xmin) / (xmax - xmin)
    ax.annotate(
        &quot;&quot;,
        xy=(xc, 1),
        xycoords=&quot;axes fraction&quot;,
        xytext=(xc, 1.1),
        arrowprops=dict(arrowstyle=&quot;-&gt;&quot;, color=&quot;r&quot;),
    )
    xc = (C_locs[i][1, 0] - xmin) / (xmax - xmin)
    ax.annotate(
        &quot;&quot;,
        xy=(xc, 1),
        xycoords=&quot;axes fraction&quot;,
        xytext=(xc, 1.1),
        arrowprops=dict(arrowstyle=&quot;-&gt;&quot;, color=&quot;r&quot;),
    )
    xc = (P_locs[i][0, 0] - xmin) / (xmax - xmin)
    ax.annotate(
        &quot;&quot;,
        xy=(xc, 1),
        xycoords=&quot;axes fraction&quot;,
        xytext=(xc, 1.075),
        arrowprops=dict(arrowstyle=&quot;-&gt;&quot;, color=&quot;b&quot;),
    )
    xc = (P_locs[i][1, 0] - xmin) / (xmax - xmin)
    ax.annotate(
        &quot;&quot;,
        xy=(xc, 1),
        xycoords=&quot;axes fraction&quot;,
        xytext=(xc, 1.075),
        arrowprops=dict(arrowstyle=&quot;-&gt;&quot;, color=&quot;b&quot;),
    )

    i = i + 1

ax2 = fig.add_axes([0.25, -0.3, 0.5, 0.1])
cbar = mpl.colorbar.ColorbarBase(ax2,
                                 orientation=&quot;horizontal&quot;,
                                 cmap=&quot;GnBu_r&quot;)
cbar.set_label(&quot;Cumulative normalized sensitivity&quot;,
               rotation=0, labelpad=15, size=12)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="4AMObOrHBB_90ustDxAJC" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/user-tutorials/build/20ce122ca7ebe786d0b6502b7da8cb0c.png" alt="&lt;Figure size 1000x200 with 3 Axes&gt;"/></div></div><div id="NxbqspPW6W" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="real-data-example-the-century-deposit-dc-resistivity-inversion" class="relative group"><span class="heading-text">Real data example: The Century Deposit DC resistivity inversion</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#real-data-example-the-century-deposit-dc-resistivity-inversion" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>In this section we perform a sensitivity analysis for the solution obtained in the inversion of a real data set. We will build upon the tutorial that can be found at <a target="_blank" href="https://github.com/simpeg/transform-2020-simpeg" rel="noreferrer">transform2020</a> created by Lindsey Heagy. You are also welcome to watch her associated presentation on youtube: <a target="_blank" href="https://www.youtube.com/watch?v=jZ7Sj9cnnso&amp;t=3250s" rel="noreferrer">Tutorial: Geophysical Inversion in SimPEG</a></p></div><div id="DfFTdX5Co1" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="initial-setup" class="relative group"><span class="heading-text">Initial setup</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#initial-setup" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>We will perform the following steps:</p><ul><li>Read information about the survey from a data file on disk</li><li>Create a python dictionary containing:<ul><li>a_locations: the positive source electrode locations (numpy array)</li><li>b_locations: the negative source electrode locations (numpy array)</li><li>m_locations: the receiver locations (list of numpy arrays)</li><li>n_locations: the receiver locations (list of numpy arrays)</li><li>observed_data: observed data (list of numpy arrays)</li><li>standard_deviations: assigned standard deviations (list of numpy arrays)</li><li>n_sources: number of sources (int)</li></ul></li></ul></div><div id="z4co29znnm" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">line = &quot;46800E&quot;
dc_data_file = f&quot;./century/{line}/{line[:-1]}POT.OBS&quot;


def read_dcip_data(filename, verbose=False):
    &quot;&quot;&quot;Read in a .OBS file from the Century data set into a python dictionary.

    The format is the old UBC-GIF DCIP format.

    Parameters
    ----------
    filename : str
        Path to the file to be parsed

    verbose: bool
        Print some things?


    Returns
    -------
    dict
        A dictionary with the locations of
        - a_locations: the positive source electrode locations (numpy array)
        - b_locations: the negative source electrode locations (numpy array)
        - m_locations: the receiver locations (list of numpy arrays)
        - n_locations: the receiver locations (list of numpy arrays)
        - observed_data: observed data (list of numpy arrays)
        - standard_deviations: assigned stds (list of numpy arrays)
        - n_sources: number of sources (int)
    &quot;&quot;&quot;
    # read in the text file as a numpy array of
    # strings (each row is an entry)
    contents = np.genfromtxt(filename, delimiter=&quot; \n&quot;, dtype=&quot;U&quot;)

    # the second line has the number of sources,
    # current, and data type (voltages if 1)
    n_sources = int(contents[1].split()[0])

    if verbose is True:
        print(f&quot;number of sources: {n_sources}&quot;)

    # initialize storage for the electrode
    # locations and data
    a_locations = np.zeros(n_sources)
    b_locations = np.zeros(n_sources)
    m_locations = []
    n_locations = []
    observed_data = []
    standard_deviations = []

    # index to track where we have read in content
    content_index = 1

    # loop over sources
    for i in range(n_sources):
        # start by reading in the source info
        content_index = content_index + 1  # read the next line
        a_location, b_location, nrx = contents[
            content_index
        ].split()  # this is a string

        # convert the strings to a float for locations
        # and an int for the number of receivers
        a_locations[i] = float(a_location)
        b_locations[i] = float(b_location)
        nrx = int(nrx)

        # initialize space for receiver locations,
        # observed data associated with this source
        m_locations_i, n_locations_i = np.zeros(nrx), np.zeros(nrx)
        observed_data_i, standard_deviations_i = np.zeros(nrx), np.zeros(nrx)

        # read in the receiver info
        for j in range(nrx):
            content_index = content_index + 1  # read the next line
            (m_location,
             n_location,
             datum, std) = contents[content_index].split()

            # convert the locations and data to floats, and store them
            m_locations_i[j] = float(m_location)
            n_locations_i[j] = float(n_location)
            observed_data_i[j] = float(datum)
            standard_deviations_i[j] = float(std)

        # append the receiver info to the lists
        m_locations.append(m_locations_i)
        n_locations.append(n_locations_i)
        observed_data.append(observed_data_i)
        standard_deviations.append(standard_deviations_i)

    return {
        &quot;a_locations&quot;: a_locations,
        &quot;b_locations&quot;: b_locations,
        &quot;m_locations&quot;: m_locations,
        &quot;n_locations&quot;: n_locations,
        &quot;observed_data&quot;: observed_data,
        &quot;standard_deviations&quot;: standard_deviations,
        &quot;n_sources&quot;: n_sources,
    }


dc_data_dict = read_dcip_data(dc_data_file)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="HujkGa70E9G5c0o3rfkNB" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="L30sUPYmtl" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="create-survey" class="relative group"><span class="heading-text">Create survey</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#create-survey" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Here we create a SimPEG Survey object representing the experiment layout.</p></div><div id="z3MLvqcIe5" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># initialize an empty list for each
source_list = []

for i in range(dc_data_dict[&quot;n_sources&quot;]):
    # receiver electrode locations in 2D
    m_locs = np.vstack(
        [dc_data_dict[&quot;m_locations&quot;][i],
         np.zeros_like(dc_data_dict[&quot;m_locations&quot;][i])]
    ).T
    n_locs = np.vstack(
        [dc_data_dict[&quot;n_locations&quot;][i],
         np.zeros_like(dc_data_dict[&quot;n_locations&quot;][i])]
    ).T

    # construct the receiver object
    receivers = dc.receivers.Dipole(locations_m=m_locs, locations_n=n_locs)

    # construct the source
    source = dc.sources.Dipole(
        location_a=np.r_[dc_data_dict[&quot;a_locations&quot;][i], 0.0],
        location_b=np.r_[dc_data_dict[&quot;b_locations&quot;][i], 0.0],
        receiver_list=[receivers],
    )

    # append the new source to the source list
    source_list.append(source)

survey = dc.Survey(source_list=source_list)

dc_data = Data(
    survey=survey,
    dobs=np.hstack(dc_data_dict[&quot;observed_data&quot;]),
    standard_deviation=np.hstack(dc_data_dict[&quot;standard_deviations&quot;]),
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="yUCmaL__sah7NY6NQcPOn" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="ohwOB7MQrE" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="forward-simulation-components" class="relative group"><span class="heading-text">Forward simulation components</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#forward-simulation-components" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="vHLc2nI0sV" class="relative group/block article-grid subgrid-gap col-screen"><p><em><strong>Mesh design</strong></em></p><p>We will create a <a target="_blank" href="https://discretize.simpeg.xyz/en/main" rel="noreferrer">discretize</a> TensorMesh.</p></div><div id="ryMqY8SPLo" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">min_electrode_spacing = np.min(
    np.abs(survey.locations_a[:, 0] - survey.locations_b[:, 0])
)
n_cells_per_spacing = 4

dx = min_electrode_spacing / n_cells_per_spacing
dz = min_electrode_spacing / n_cells_per_spacing

electrode_locations = np.c_[
    survey.locations_a,
    survey.locations_b,
    survey.locations_m,
    survey.locations_n,
]

unique_locations = np.unique(
    np.reshape(electrode_locations, (4 * survey.nD, 2)), axis=0
)

core_domain_x = np.r_[unique_locations[:, 0].min(),
                      unique_locations[:, 0].max()]

# find the maximum spacing between source, receiver midpoints
mid_ab = (survey.locations_a + survey.locations_b) / 2
mid_mn = (survey.locations_m + survey.locations_n) / 2
separation_ab_mn = np.abs(mid_ab - mid_mn)
max_separation = separation_ab_mn.max()

core_domain_z = np.r_[-max_separation / 3.0, 0.0]

n_core_extra = 4
n_core_x = np.ceil(np.diff(core_domain_x) / dx) +\
           n_core_extra * 2  # on each side
n_core_z = np.ceil(np.diff(core_domain_z) / dz) +\
           n_core_extra  # just below

padding_factor = 1.3
n_pad_x = 10
n_pad_z = 10

hx = [(dx, n_pad_x, -padding_factor),
      (dx, n_core_x), (dx, n_pad_x, padding_factor)]
hz = [(dz, n_pad_z, -padding_factor), (dz, n_core_z)]

mesh = TensorMesh([hx, hz])

# origin of the mesh
mesh_hx = mesh.h[0]
mesh_hy = mesh.h[1]
mesh.x0 = np.r_[
    -mesh_hx[: n_pad_x + n_core_extra].sum() +
    core_domain_x.min(), -mesh_hy.sum()
]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Udzx-up6t2EmyV5GTIyTu" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="qBLvwGxHwE" class="relative group/block article-grid subgrid-gap col-screen"><p><em><strong>SimPEG forward simulation objects creation</strong></em></p><p>The SimPEG simulation object for this particular problem is an object of type <a target="_blank" href="https://docs.simpeg.xyz/content/api/generated/SimPEG.electromagnetics.static.resistivity.Simulation2DNodal.html#simpeg.electromagnetics.static.resistivity.simulation2dnodal" rel="noreferrer">SimPEG<wbr/>.electromagnetics<wbr/>.static<wbr/>.resistivity<wbr/>.Simulation2DNodal</a>. We will also work with the natual logarithm of the conductivity.</p></div><div id="cZpB5CS98M" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># forward simulation
# Use Exponential Map: m = log(rho)
mapping = maps.ExpMap(mesh)

# Generate 2.5D DC problem
simulation_dc = dc.Simulation2DNodal(
    mesh, rhoMap=mapping, solver=Solver, survey=survey, storeJ=True
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="hHAox5JZDEI-Fy4ZzqPJf" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="nilflpukPO" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="inversion" class="relative group"><span class="heading-text">Inversion</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#inversion" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="W8bcOKvYvZ" class="relative group/block article-grid subgrid-gap col-screen"><p><em><strong>Inversion: Data misfit</strong></em></p></div><div id="J7xMjISsO8" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">dmisfit = data_misfit.L2DataMisfit(data=dc_data, simulation=simulation_dc)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ox5NQinUTViY6GtDD76a7" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="yfAiNAFNh3" class="relative group/block article-grid subgrid-gap col-screen"><p><em><strong>Inversion: Regularization</strong></em></p></div><div id="HMS3UhFrdX" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">mesh_hx = mesh.h[0]
reg = regularization.WeightedLeastSquares(
    mesh,
    alpha_s=1.0
    / mesh_hx.min() ** 2,  # we will talk about
                           # these choices in notebook 3 on inversion
    alpha_x=1,
    alpha_y=1,  # since this is a 2D problem, the second dimension is &quot;y&quot;
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="hbpTERsRBmZm7nJeU3zWt" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="sSlVAjWubN" class="relative group/block article-grid subgrid-gap col-screen"><p><em><strong>Inversion: Final touches</strong></em></p></div><div id="mT0nJF5LlW" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">opt = optimization.InexactGaussNewton(maxIter=20, maxIterCG=20)
inv_prob = inverse_problem.BaseInvProblem(dmisfit, reg, opt)

# directives
beta_est = directives.BetaEstimate_ByEig(beta0_ratio=1)

# coolFac = 4
coolFac = 1
beta_schedule = directives.BetaSchedule(coolingFactor=coolFac,
                                        coolingRate=2)
target = directives.TargetMisfit()

inv = inversion.BaseInversion(inv_prob,
                              directiveList=[beta_est,
                                             beta_schedule, target])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="C_Ey3dVm3uY9_ba-x6HJM" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="ZfurC1w2Ri" class="relative group/block article-grid subgrid-gap col-screen"><p><em><strong>Inversion: (Finally) run the inversion</strong></em></p></div><div id="clUSosYXjl" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">apparent_resistivity = dc_utils.apparent_resistivity_from_voltage(
    dc_data.survey, dc_data.dobs
)
rho0 = np.median(apparent_resistivity)
m0 = np.ones(mesh.nC) * np.log(rho0)
# Run inversion
mopt = inv.run(m0)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="0AU-hTTCCkEixSHsnWsiJ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>SimPEG.InvProblem will set Regularization.reference_model to m0.
SimPEG.InvProblem will set Regularization.reference_model to m0.
SimPEG.InvProblem will set Regularization.reference_model to m0.
SimPEG.InvProblem will set Regularization.reference_model to m0.
SimPEG.InvProblem will set Regularization.reference_model to m0.

                        SimPEG.InvProblem is setting bfgsH0 to the inverse of the eval2Deriv.
                        ***Done using same Solver, and solver_opts as the Simulation2DNodal problem***
                        
model has any nan: 0
============================ Inexact Gauss Newton ============================
  #     beta     phi_d     phi_m       f      |proj(x-g)-x|  LS    Comment   
-----------------------------------------------------------------------------
x0 has any nan: 0
   0  7.54e+00  9.17e+03  0.00e+00  9.17e+03    3.14e+03      0              
   1  7.54e+00  1.86e+03  4.92e+01  2.24e+03    4.76e+02      0              
   2  7.54e+00  6.81e+02  1.11e+02  1.51e+03    6.74e+01      0   Skip BFGS  
   3  7.54e+00  5.80e+02  1.19e+02  1.48e+03    1.29e+01      0   Skip BFGS  
   4  7.54e+00  5.49e+02  1.23e+02  1.48e+03    4.21e+00      0   Skip BFGS  
   5  7.54e+00  5.47e+02  1.23e+02  1.48e+03    2.95e+00      0              
   6  7.54e+00  5.45e+02  1.24e+02  1.48e+03    2.64e+00      0              
   7  7.54e+00  5.45e+02  1.24e+02  1.48e+03    2.45e+00      0              
   8  7.54e+00  5.45e+02  1.24e+02  1.48e+03    2.22e+00      0              
   9  7.54e+00  5.44e+02  1.24e+02  1.48e+03    1.88e+00      0              
  10  7.54e+00  5.46e+02  1.24e+02  1.48e+03    1.60e+00      0              
  11  7.54e+00  5.44e+02  1.24e+02  1.48e+03    1.08e+00      0              
  12  7.54e+00  5.45e+02  1.24e+02  1.48e+03    8.76e-01      0              
  13  7.54e+00  5.44e+02  1.24e+02  1.48e+03    7.13e-01      0              
  14  7.54e+00  5.45e+02  1.24e+02  1.48e+03    6.15e-01      0              
  15  7.54e+00  5.44e+02  1.24e+02  1.48e+03    5.47e-01      0              
  16  7.54e+00  5.44e+02  1.24e+02  1.48e+03    5.31e-01      0              
  17  7.54e+00  5.44e+02  1.24e+02  1.48e+03    4.72e-02      1              
------------------------- STOP! -------------------------
1 : |fc-fOld| = 3.4446e-03 &lt;= tolF*(1+|f0|) = 9.1722e+02
1 : |xc-x_last| = 1.4126e-02 &lt;= tolX*(1+|x0|) = 3.0775e+01
1 : |proj(x-g)-x|    = 4.7157e-02 &lt;= tolG          = 1.0000e-01
0 : |proj(x-g)-x|    = 4.7157e-02 &lt;= 1e3*eps       = 1.0000e-02
0 : maxIter   =      20    &lt;= iter          =     17
------------------------- DONE! -------------------------
</span></code></pre></div></div></div><div id="e8OTqXQmda" class="relative group/block article-grid subgrid-gap col-screen"><p><em><strong>Inversion: Show solution</strong></em></p></div><div id="PTrhhqRt2j" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">def load_leapfrog_geologic_section(filename=&quot;./century/geologic_section.csv&quot;):
    &quot;&quot;&quot;Load the geologic cross section.&quot;&quot;&quot;
    fid = open(filename, &quot;r&quot;)
    lines = fid.readlines()
    data = []
    data_tmp = []
    for line in lines[2:]:
        line_data = line.split(&quot;,&quot;)[:3]
        if &quot;End&quot; in line:
            data.append(np.vstack(data_tmp)[:, [0, 2]])
            data_tmp = []
        else:
            data_tmp.append(np.array(line_data, dtype=float))
    return data</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="FTsMz6UosBn51N0ufk9fC" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="NnaLanPCwn" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">geologic_section = load_leapfrog_geologic_section()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="J4NfuJJAopcoL-gXo5hMb" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="OFqv96kF32" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">fig, ax = plt.subplots(1, 1, figsize=(10, 5))
rho = mapping * mopt
norm = LogNorm(vmin=1e1, vmax=1e3)

out = mesh.plot_image(
    rho,
    pcolor_opts={&quot;norm&quot;: norm, &quot;cmap&quot;: &quot;Spectral&quot;},
    ax=ax,
)

for data in geologic_section:
    ax.plot(data[:, 0], data[:, 1], &quot;k--&quot;, alpha=0.5)

ax.set_xlim(core_domain_x)
ax.set_ylim((-400, 0))
cb = plt.colorbar(out[0], fraction=0.05,
                  orientation=&quot;horizontal&quot;, ax=ax, pad=0.2)
cb.set_label(&quot;Resistivity ($\\Omega$m)&quot;)
ax.set_xlabel(&quot;Easting (m)&quot;)
ax.set_ylabel(&quot;Elevation (m)&quot;)
ax.set_aspect(1.5)  # some vertical exxageration
plt.tight_layout()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="JS9C2QCR_41F3kqR9FOON" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/user-tutorials/build/9e223b7194a3a233bbb8cead25651b8a.png" alt="&lt;Figure size 1000x500 with 2 Axes&gt;"/></div></div><div id="pq78KzCgHv" class="relative group/block article-grid subgrid-gap col-screen"><h3 id="sensitivity-analysis" class="relative group"><span class="heading-text">Sensitivity analysis</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#sensitivity-analysis" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The sensitivity matrix for the DC inverse problem just formulated is defined as
</p><div id="LOLQiOnmCW" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>J</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>d</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><mi>l</mi><mi>n</mi><msub><mi>σ</mi><mi>j</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">
J_{ij} = \frac{\partial d_i}{\partial ln \sigma_j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3435em;vertical-align:-0.9721em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9721em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="select-none no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit hover:underline" href="#LOLQiOnmCW" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->8<!-- -->)</a></div></div><p>
where <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">d_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> correspond to the ith data functional and <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>σ</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\sigma_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span> is the electrical conductivity in the jth cell of our mesh.</p><p>SimPEG simulation classes offer a method called getJ which we will use to have access to the sensitivity matrix. With <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi></mrow><annotation encoding="application/x-tex">J</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span></span></span></span></span> in our hands we can explore its content in a number of different ways as illustrated in the sections below.</p></div><div id="VdnQrFpQ0i" class="relative group/block article-grid subgrid-gap col-screen"><p><em><strong>Get the sensitivity matrix</strong></em></p><p>The first step is to get a copy of the sensitivity matrix <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi></mrow><annotation encoding="application/x-tex">J</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span></span></span></span></span>, what we can acomplish by calling the method getJ().</p></div><div id="ZNgI59VjOb" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">simulation_dc._Jmatrix = None  # Force computation of new sensitivity matrix
J = simulation_dc.getJ(mopt).copy()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="GRZxwy67XBETmMvSkDuDy" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="bNLMcZTHRN" class="relative group/block article-grid subgrid-gap col-screen"><p><em><strong>Average sensitivity</strong></em></p><p>There are many different ways in which we could look at the information contained in <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi></mrow><annotation encoding="application/x-tex">J</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span></span></span></span></span>. Let’s use the <strong>average sensitivity</strong> <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">s_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span> as defined in <cite data-state="closed"><a href="https://doi.org/10.1190/segam2016-13842655.1" target="_blank" rel="noreferrer" class="hover-link">Devriese &amp; Oldenburg (2016)</a></cite>,
</p><div id="qb2diakwWw" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>s</mi><mi>j</mi></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mi>n</mi><msub><mi>V</mi><mi>j</mi></msub></mrow></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo fence="true">∣</mo><msub><mi>J</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo fence="true">∣</mo></mrow><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
s_j = \frac{1}{nV_j}\sum_{i=1}^n\left|J_{ij}\right|.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9721em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">.</span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="select-none no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit hover:underline" href="#qb2diakwWw" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->9<!-- -->)</a></div></div><p>
It will give us a global qualitative/semi-quantitative view on how the survey layout defined for this inversion problem is sampling the subsurface in the region of interest.</p></div><div id="QEY5Aa5zpe" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">##
# Define the average sensitivity sj
Vj = mesh.cell_volumes
n, m = J.shape
sj = np.log10(np.divide(np.sum(abs(J), axis=0), n * Vj))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="O3JSxR9T9m7SgLjXbpxnx" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="ETNy0rInDm" class="relative group/block article-grid subgrid-gap col-screen"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Plot
fig, ax = plt.subplots(1, 1, figsize=(10, 5))
plt.jet()
out = mesh.plot_image(sj, ax=ax)

for data in geologic_section:
    ax.plot(data[:, 0], data[:, 1], &quot;k--&quot;, alpha=0.5)

ax.set_xlim(core_domain_x)
ax.set_ylim((-400, 0))
cb = plt.colorbar(out[0], fraction=0.05,
                  orientation=&quot;horizontal&quot;, ax=ax, pad=0.2)
cb.set_label(&quot;Average sensitivity&quot;)
ax.set_xlabel(&quot;Easting (m)&quot;)
ax.set_ylabel(&quot;Elevation (m)&quot;)
ax.set_aspect(1.5)  # some vertical exxageration
plt.tight_layout()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="qoIe2AHLCEHux4VTvzPEE" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/user-tutorials/build/ba8c3a9dab3315bf14799c2eaa65c082.png" alt="&lt;Figure size 1000x500 with 2 Axes&gt;"/></div></div><div id="adrOIRtz5w" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="conclusions" class="relative group"><span class="heading-text">Conclusions</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#conclusions" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>In this tutorial we used the resources avaiable in SimPEG for computing and ploting the sensitivity matrix. We used the DC resistivity problem as a motivation example and analysed the sensitivity patterns for a homogeneous half space using two different survey layouts. We also applied this technique for a DC resistivity real data inversion scenario. This kind of analysis can help us decide upon the most appropriate electrode array to use for a particular exploration project. It is also a valuable tool to have in our toolbox for performing the assessment of the solutions obtained after the application of some inversion algorithm as illustrated by the real case example.</p></div><div id="zWEG7X4jnM" class="relative group/block article-grid subgrid-gap col-screen"><h2 id="acknowledgements" class="relative group"><span class="heading-text">Acknowledgements</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#acknowledgements" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><section id="references" class="article-grid subgrid-gap col-screen"><div><header class="text-lg font-semibold text-stone-900 dark:text-white group">References<a class="select-none no-underline text-inherit hover:text-inherit ml-2 transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#references" title="Link to References" aria-label="Link to References">¶</a></header></div><div class="pl-3 mb-8 text-xs text-stone-500 dark:text-stone-300"><ol><li class="break-words" id="cite-Furman_2003">Furman, A., Ferré, T. P. A., & Warrick, A. W. (2003). A Sensitivity Analysis of Electrical Resistivity Tomography Array Types Using Analytical Element Modeling. <i>Vadose Zone Journal</i>, <i>2</i>(3), 416–423. <a target="_blank" rel="noreferrer" href="https://doi.org/10.2136/vzj2003.4160">10.2136/vzj2003.4160</a></li><li class="break-words" id="cite-Devriese_2016">Devriese, S., & Oldenburg, D. (2016, September). Application of sensitivity analysis in DC resistivity monitoring of SAGD steam chambers. <i>SEG Technical Program Expanded Abstracts 2016</i>. <a target="_blank" rel="noreferrer" href="https://doi.org/10.1190/segam2016-13842655.1">10.1190/segam2016-13842655.1</a></li></ol></div></section><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/user-tutorials/uran-index"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">SimPEG User Tutorials</div>Uncertainty and Resolution analysis</div></div></a></div></main></article><script>((l,d)=>{if(!window.history.state||!window.history.state.key){let f=Math.random().toString(32).slice(2);window.history.replaceState({key:f},"")}try{let p=JSON.parse(sessionStorage.getItem(l)||"{}")[d||window.history.state.key];typeof p=="number"&&window.scrollTo(0,p)}catch(f){console.error(f),sessionStorage.removeItem(l)}})("positions", null)</script><link rel="modulepreload" href="/user-tutorials/build/entry.client-K6EYMIDZ.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-FBLNPC3V.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-XJN3BT5Q.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-JPGYAJQ3.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-YAIQ7LUU.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-JOLZ6LZB.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-XIW7RL3H.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-I634YBN3.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-MITWS4PZ.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-M5ZDOVXY.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-6TYLRLOL.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-UZHI4RYQ.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-RTIGS2T3.js"/><link rel="modulepreload" href="/user-tutorials/build/root-2CYAF5SQ.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-OYK7WRH2.js"/><link rel="modulepreload" href="/user-tutorials/build/routes/$-ZDWRJY4B.js"/><script>window.__remixContext = {"url":"/dc2d-sens","state":{"loaderData":{"root":{"theme":"light","config":{"title":"SimPEG User Tutorials","options":{"analytics_plausible":"simpeg.xyz"},"myst":"1.1.42","nav":[],"actions":[{"title":"Learn More","url":"https://mystmd.org/guide"}],"projects":[{"title":"SimPEG User Tutorials","github":"https://github.com/simpeg/user-tutorials","keywords":[],"references":{"python":{"url":"https://docs.python.org/3/"},"numpy":{"url":"https://numpy.org/doc/stable/"},"scipy":{"url":"https://docs.scipy.org/doc/scipy/"},"matplotlib":{"url":"https://matplotlib.org/stable/"},"discretize":{"url":"https://discretize.simpeg.xyz/en/main/"},"SimPEG":{"url":"https://docs.simpeg.xyz/"},"geoana":{"url":"https://geoana.simpeg.xyz/"},"sphinx":{"url":"https://www.sphinx-doc.org/en/master/"}},"thumbnail":"/user-tutorials/build/title_image-8a71538f0bef40867b3fb0794cae7dbc.png","exports":[],"bibliography":[],"index":"index","pages":[{"slug":"gravity-index","title":"Gravity","description":"","date":"","thumbnail":"/user-tutorials/build/ae6c6ed278992f609070dbcd57643aba.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-gravity-anomaly-3d","title":"3D Forward Simulation of Gravity Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-gravity-gradiometry-3d","title":"3D Forward Simulation of Gravity Gradiometry Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-gravity-anomaly-3d","title":"3D Inversion of Gravity Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"magnetics-index","title":"Magnetics","description":"","date":"","thumbnail":"/user-tutorials/build/7a8cefd4894c78a7681713eac224fec3.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-magnetics-induced-3d","title":"3D Forward Simulation of TMI Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-magnetics-mvi-3d","title":"3D Forward Simulation of Magnetic Gradiometry Data for Magnetic Vector Models","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-magnetics-induced-3d","title":"3D Inversion of TMI Data to Recover a Susceptibility Model","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"dcr-index","title":"Direct Current Resistivity","description":"","date":"","thumbnail":"/user-tutorials/build/dcip_physics-ba2ce1e7a00bcfd7d149b5f4511b019f.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-dcr-1d","title":"1D Forward Simulation for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-dcr-2d","title":"2.5D Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-dcr-3d","title":"3D Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-1d","title":"1D Inversion for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-2d","title":"2.5D DC Resistivity Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-3d","title":"3D DC Resistivity Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"ip-index","title":"Induced Polarization","description":"","date":"","thumbnail":"/user-tutorials/build/dcip_physics-ba2ce1e7a00bcfd7d149b5f4511b019f.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-ip-2d","title":"2.5D IP Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-ip-3d","title":"3D IP Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-ip-2d","title":"2.5D IP Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-ip-3d","title":"3D IP Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fdem-index","title":"Frequency-Domain Electromagnetics","description":"","date":"","thumbnail":"/user-tutorials/build/fem_physics-6287513b81425048223fc264589cdf6a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-fdem-1d","title":"1D Forward Simulation of Frequency Domain EM Data for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-fdem-1d","title":"1D Inversion of Frequency Domain EM Data for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tdem-index","title":"Time-Domain Electromagnetics","description":"","date":"","thumbnail":"/user-tutorials/build/tem_physics-81e11e7ffe320f0cb309e445a95570b3.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-tdem-1d","title":"1D Forward Simulation for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-tdem-fundamentals","title":"Fundamentals of Finite Volume for TDEM Simulations","description":"","date":"","thumbnail":"/user-tutorials/build/diffusion_distance-1231b4c642392d8e924a88a81c415e67.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-utem-3d","title":"3D Forward Simulation for On-Time Large-Loop Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-tdem-1d","title":"1D Inversion for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"uran-index","title":"Uncertainty and Resolution analysis","description":"","date":"","thumbnail":"/user-tutorials/build/f0de225db6a3bcc09186ff9fea3eba43.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"dc2d-sens","title":"2D DC Resistivity Sensitivity analysis","description":"","date":"","thumbnail":"/user-tutorials/build/f037fe2572b5e1b2bf477ba85272db70.gif","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/user-tutorials"},"routes/$":{"page":{"kind":"Notebook","sha256":"e6ec88ac0e41af734138429c583b2d2ce189595ebbf5cbd3c4d006d9e3ff9f75","slug":"dc2d-sens","location":"/notebooks/xx-dc2d/dc2d_sens.ipynb","dependencies":[],"frontmatter":{"title":"2D DC Resistivity Sensitivity analysis","content_includes_title":false,"github":"https://github.com/simpeg/user-tutorials","keywords":[],"thumbnail":"/user-tutorials/build/f037fe2572b5e1b2bf477ba85272db70.gif","exports":[{"format":"ipynb","filename":"dc2d_sens.ipynb","url":"/user-tutorials/build/dc2d_sens-8f3f3a910f4f299eccd6b86591ecb567.ipynb"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"admonition","class":"caution","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Intermediate notebook","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HfgsPJAfRj"}],"key":"Dshnp3mAbe"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This tutorial focusses on intermediate level functionality within SimPEG. Basic functionality within SimPEG is not discussed in detail, as we assume the user is already familiar.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dhTvvcpU4b"}],"key":"MVmdVYLIpZ"}],"key":"eWp5yODUIO"}],"data":{"type":"notebook-content"},"key":"At4fHN5tjx"},{"type":"block","children":[{"type":"admonition","class":"hint","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Light-weight notebook","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GZCqybWkeo"}],"key":"FHfuTJBnUe"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This tutorial requires minimal computational resources and can be executed quickly in the background while other computer processes are running.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WSBONbJD8H"}],"key":"J51dvjhdGR"}],"key":"ZAZg7aWDhk"}],"data":{"type":"notebook-content"},"key":"Sy1xxTQZLU"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Author:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EH9CNa4zk0"}],"key":"cpXQFLc2Ie"},{"type":"text","value":" Williams Lima","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pOxsThXemm"}],"key":"gnNzX0PLaA"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Keywords:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"fIMYe7f0Xh"}],"key":"MCAFj4R0v0"},{"type":"text","value":" DC Resistivity inversion, sensitivity matrix.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xIzHAZx52D"}],"key":"DT5j9c9IQG"}],"data":{"type":"notebook-content"},"key":"VyXtYvw2pm"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Summary:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"edpp1ep0Q8"}],"key":"PDyGGMNVgm"},{"type":"text","value":"\nThe sensitivity matrix is a very important tool for the design of surveys and the implementation of inversion algorithms in geophysics. It can give us qualitative and, to some extent, quantitative information about the sensitivity of the data to perturbations in the physical properties (e.g electrical conductivities) underground. In turn, it can help us design optimized surveys for specific targets. Moreover, it is also of great value in a later interpretation stage, as a tool to assess the resolvability of particular features obtained by the use of inversion methods. In this tutorial we’ll use SimPEG functionalities to look at the sensitivity matrix for the DC resistivity inverse problem. We will use a number of different techniques to analyze the sensitivity patterns for a few commonly used electrode arrays. As study cases, we will apply these techniques for both a homogenous half space and to a real data set in the context of a mineral exploration project.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sNYKf3N3RY"}],"key":"RjOTuOvxO4"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Although we use the DC resistivity problem as a leitmotif in this tutorial, the techniques presented here are general enough and can be applied to many other geophysical methods.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"PSuWoPuuFS"}],"key":"RbU7Rj1Rzx"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Enjoy!\n","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"SFBJre5JYQ"}],"key":"zQFq1ayen0"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Learning Objectives:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"qMVXdqK5zq"}],"key":"aQIZLS3lTC"}],"key":"SA0sVirxvt"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"How to get the sensitivity matrix for a DC resistivity simulation by using utility functions in SimPEG.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"FcaxYUJTGC"}],"key":"dfuBOD9LO4"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Exploring the different sensitivity patterns for a number of common electrode arrays.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"yfhVRWPxlO"}],"key":"KpS17ChH81"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"How to plot information contained in the sensitivity matrix.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"eU0e6HSi9d"}],"key":"BAwCJJSqd8"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Look at the sensitivity matrix for a real data set.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"es93kc2hFQ"}],"key":"aZrIF8N5lf"}],"key":"OvZd7XTT6x"}],"data":{"type":"notebook-content"},"key":"CpAUvCU9s8"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Theoretical background","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MiIGGOWKvL"}],"identifier":"theoretical-background","label":"Theoretical background","html_id":"theoretical-background","implicit":true,"key":"ZjqPi6P0XN"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"First of all, we cannot overemphasize the importance of understanding the distinction\nthat exists in SimPEG between physical properties and modeling/inversion parameters. Every physical simulation component in SimPEG makes use of a particular set of physical properties (conductivity, density, magnetic susceptibility, etc.). On the other hand, when performing an inversion task, we usually define an independent set of parameters and maps between those and the actual physical properties. For example, the DC simulation class implements the solution of the following PDE\n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"A0D8bwWZLA"}],"key":"EtkS7UzRUI"},{"type":"math","value":"\n-\\nabla\\cdot\\left(\\sigma\\nabla\\phi\\right) = I(\\delta(r-r_{s^+}) - \\delta(r-r_{s^-}),","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmi mathvariant=\"normal\"\u003e∇\u003c/mi\u003e\u003cmo\u003e⋅\u003c/mo\u003e\u003cmrow\u003e\u003cmo fence=\"true\"\u003e(\u003c/mo\u003e\u003cmi\u003eσ\u003c/mi\u003e\u003cmi mathvariant=\"normal\"\u003e∇\u003c/mi\u003e\u003cmi\u003eϕ\u003c/mi\u003e\u003cmo fence=\"true\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi\u003eI\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003eδ\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003er\u003c/mi\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003er\u003c/mi\u003e\u003cmsup\u003e\u003cmi\u003es\u003c/mi\u003e\u003cmo\u003e+\u003c/mo\u003e\u003c/msup\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmi\u003eδ\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003er\u003c/mi\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003er\u003c/mi\u003e\u003cmsup\u003e\u003cmi\u003es\u003c/mi\u003e\u003cmo\u003e−\u003c/mo\u003e\u003c/msup\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\n-\\nabla\\cdot\\left(\\sigma\\nabla\\phi\\right) = I(\\delta(r-r_{s^+}) - \\delta(r-r_{s^-}),\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e−\u003c/span\u003e\u003cspan class=\"mord\"\u003e∇\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⋅\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"minner\"\u003e\u003cspan class=\"mopen delimcenter\" style=\"top:0em;\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eσ\u003c/span\u003e\u003cspan class=\"mord\"\u003e∇\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eϕ\u003c/span\u003e\u003cspan class=\"mclose delimcenter\" style=\"top:0em;\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.07847em;\"\u003eI\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03785em;\"\u003eδ\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003er\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003er\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3419em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003es\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7027em;\"\u003e\u003cspan style=\"top:-2.786em;margin-right:0.0714em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.5em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size3 size1 mtight\"\u003e\u003cspan class=\"mbin mtight\"\u003e+\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03785em;\"\u003eδ\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003er\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003er\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3419em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003es\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7027em;\"\u003e\u003cspan style=\"top:-2.786em;margin-right:0.0714em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.5em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size3 size1 mtight\"\u003e\u003cspan class=\"mbin mtight\"\u003e−\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"1","key":"CwjIQl6d9v"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"\nwhere the relevant physical property is the electrical conductivity ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lT4fbwFqwr"},{"type":"text","value":"σ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MpXTXjCAOU"},{"type":"text","value":". In an inversion context, the inversion parameter would be defined as ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uS2H1igOmE"},{"type":"inlineMath","value":"m = ln(\\sigma)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003em\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi\u003el\u003c/mi\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003eσ\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003em = ln(\\sigma)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003em\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.01968em;\"\u003el\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eσ\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"dz7n7MWDuI"},{"type":"text","value":". In this case we would define a map such that ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QBK4UttChN"},{"type":"inlineMath","value":"\\sigma = exp(m)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eσ\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi\u003ee\u003c/mi\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmi\u003ep\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003em\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\sigma = exp(m)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eσ\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ee\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ep\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003em\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"XWDYT9PbQY"},{"type":"text","value":" and pass this map to the simulation object so it could correctly convert the inversion parameter ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Sas4h4vFea"},{"type":"inlineMath","value":"m","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003em\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003em\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003em\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"rVBgK1xElM"},{"type":"text","value":" to the actual physical property ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LQVpy4cqiX"},{"type":"text","value":"σ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aw0XVQFhWr"},{"type":"text","value":" used in the simulation. In SimPEG we can define composite mappings ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qHSsU3uqBg"},{"type":"inlineMath","value":"\\mathcal{M}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"script\"\u003eM\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathcal{M}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathcal\"\u003eM\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"MeFJslk4EW"},{"type":"text","value":" resulting from the composition of any number of maps, the relation between the physical properties and model parameters being given by ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"O9nYPcQYdg"},{"type":"inlineMath","value":"\\sigma = \\mathcal{M}(m)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eσ\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi mathvariant=\"script\"\u003eM\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003em\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\sigma = \\mathcal{M}(m)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eσ\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathcal\"\u003eM\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003em\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"HmsRb5p9Ny"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HR8bzHn9q1"}],"key":"mR1CkiQ10k"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"When computing sensitivities, the chain rule is used to correctly take into account the composition of maps. We will see later that the derivatives returned by the method ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"XxVhwNIMju"},{"type":"emphasis","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"getJ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"P9HXjmgsea"}],"key":"OLNScch2Qo"}],"key":"JRvyHWp56X"},{"type":"text","value":" (which returns the Jacobian matrix) are always computed with respect to model parameters.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"LyzAfZmiuo"}],"key":"Wl7et0DWSe"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"The mechanics of sensitivity computation","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"iimLyAipgt"}],"key":"pGzekycEdr"}],"key":"dxhWQnY1VY"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Many of the simulations performed in SimPEG rely on the solution of an algebraic system of linear equations of the form\n","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"XzmSv67azG"}],"key":"woe0XH8bce"},{"type":"math","value":"\nA(c)u = q","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eA\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003ec\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmi\u003eu\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi\u003eq\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\nA(c)u = q\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eA\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ec\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eq\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"2","key":"ldhDYd2FO3"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"\nwhere ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"bxQt1B0Zes"},{"type":"inlineMath","value":"A","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eA\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eA\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eA\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"hzWSitwKmy"},{"type":"text","value":" is a matrix obtained after discretization of the relevant PDE,\n","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"i94u5G0vXp"},{"type":"inlineMath","value":"c","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ec\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ec\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ec\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"RtU78jkis0"},{"type":"text","value":" is a the physical property vector, ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"hbwXekb770"},{"type":"inlineMath","value":"q","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eq\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eq\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eq\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"XBPOY45gdP"},{"type":"text","value":" is a source term vector. Once this system is solved for ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"kgu7I7meIG"},{"type":"inlineMath","value":"u","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eu\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eu\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"kRotVhYm4J"},{"type":"text","value":", a given physical field ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"rimhmf7UZK"},{"type":"inlineMath","value":"f","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ef\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ef\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"MRCdwUQOeR"},{"type":"text","value":" (e.g. electric/magnetic field components) can be obtained as a relation like\n","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"ppSxosDx6B"}],"key":"PQ3RajWeI7"},{"type":"math","value":"\nf = f(u(m), s_e(m), s_m(m), m).","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ef\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi\u003ef\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003eu\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003em\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003es\u003c/mi\u003e\u003cmi\u003ee\u003c/mi\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003em\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003es\u003c/mi\u003e\u003cmi\u003em\u003c/mi\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003em\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmi\u003em\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmi mathvariant=\"normal\"\u003e.\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\nf = f(u(m), s_e(m), s_m(m), m).\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003em\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003es\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ee\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003em\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003es\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003em\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003em\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003em\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mord\"\u003e.\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"3","key":"HA509y0a27"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"\nFinally, the predicted data ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"rOJTwqbail"},{"type":"inlineMath","value":"d_\\text{pred}","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmtext\u003epred\u003c/mtext\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ed_\\text{pred}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003epred\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"AOB7J4Th5r"},{"type":"text","value":" is obtained through\n","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"heSzW3w2lc"}],"key":"pwrqYdAbqa"},{"type":"math","value":"\nd_\\text{pred} = P(f)","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmtext\u003epred\u003c/mtext\u003e\u003c/msub\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi\u003eP\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003ef\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\nd_\\text{pred} = P(f)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003epred\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eP\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"4","key":"bDLmQ3VuHm"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"\nwhere the operator ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"TJimcYsC4r"},{"type":"inlineMath","value":"P","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eP\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eP\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eP\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"F2F1ZDckZW"},{"type":"text","value":" “selects the component of interest and interpolates\nthe fields to the receiver locaions” (Heagy2018).","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"hS1Bm36A4W"}],"key":"JupaMRzB1d"},{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"The core component in the sensitivity analysis is the Jacobian matrix, defined as\n","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"SGLEQQ3HOc"}],"key":"ZrD0INdWIQ"},{"type":"math","value":"\nJ(m) = \\frac{\\partial d_\\text{pred}}{\\partial m}.","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eJ\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003em\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmsub\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmtext\u003epred\u003c/mtext\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmi\u003em\u003c/mi\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003cmi mathvariant=\"normal\"\u003e.\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\nJ(m) = \\frac{\\partial d_\\text{pred}}{\\partial m}.\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.09618em;\"\u003eJ\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003em\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3714em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003em\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003epred\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e.\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"5","key":"JRtwNVAkLh"},{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"\nConsidering all those intermediate transformations, in order to get ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"R0dlStYvTs"},{"type":"inlineMath","value":"J","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eJ\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eJ\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.09618em;\"\u003eJ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"csGYOY0OkR"},{"type":"text","value":", applying the chain rule we have\n","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"J5ZIKFHoeP"}],"key":"e5Ccy9NH0x"},{"type":"math","value":"\\begin{eqnarray}\nJ(m) \u0026= \\frac{dP(f)}{df}\\frac{df}{d\\sigma}\\frac{d\\sigma}{dm}\\\\\n \u0026= \\underbrace{\\left(\\frac{\\partial f}{\\partial u}\\overbrace{\\frac{du}{d\\sigma}}^\\text{Physics} +\n    \\frac{\\partial f}{\\partial s_m}\\overbrace{\\frac{ds_m}{d\\sigma}}^\\text{Sources} +\n    \\frac{\\partial f}{\\partial s_e}\\overbrace{\\frac{ds_e}{d\\sigma}}^\\text{Sources} +\n    \\frac{\\partial f}{\\partial\\sigma}\\right)}_\\text{Fields}\\underbrace{\\frac{d\\sigma}{dm}}_\\text{Properties}\n\\end{eqnarray}","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"\u003e\u003cmtr\u003e\u003cmtd\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmrow\u003e\u003cmi\u003eJ\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003em\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003c/mstyle\u003e\u003c/mtd\u003e\u003cmtd\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmrow\u003e\u003cmrow\u003e\u003c/mrow\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmi\u003eP\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003ef\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmi\u003ef\u003c/mi\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmi\u003ef\u003c/mi\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmi\u003eσ\u003c/mi\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmi\u003eσ\u003c/mi\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmi\u003em\u003c/mi\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003c/mrow\u003e\u003c/mstyle\u003e\u003c/mtd\u003e\u003c/mtr\u003e\u003cmtr\u003e\u003cmtd\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmrow\u003e\u003c/mrow\u003e\u003c/mstyle\u003e\u003c/mtd\u003e\u003cmtd\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmrow\u003e\u003cmrow\u003e\u003c/mrow\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmunder\u003e\u003cmunder\u003e\u003cmrow\u003e\u003cmo fence=\"true\"\u003e(\u003c/mo\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmi\u003ef\u003c/mi\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmi\u003eu\u003c/mi\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003cmover\u003e\u003cmover\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmi\u003eu\u003c/mi\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmi\u003eσ\u003c/mi\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003cmo stretchy=\"true\"\u003e⏞\u003c/mo\u003e\u003c/mover\u003e\u003cmtext\u003ePhysics\u003c/mtext\u003e\u003c/mover\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmi\u003ef\u003c/mi\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmsub\u003e\u003cmi\u003es\u003c/mi\u003e\u003cmi\u003em\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003cmover\u003e\u003cmover\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmsub\u003e\u003cmi\u003es\u003c/mi\u003e\u003cmi\u003em\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmi\u003eσ\u003c/mi\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003cmo stretchy=\"true\"\u003e⏞\u003c/mo\u003e\u003c/mover\u003e\u003cmtext\u003eSources\u003c/mtext\u003e\u003c/mover\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmi\u003ef\u003c/mi\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmsub\u003e\u003cmi\u003es\u003c/mi\u003e\u003cmi\u003ee\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003cmover\u003e\u003cmover\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmsub\u003e\u003cmi\u003es\u003c/mi\u003e\u003cmi\u003ee\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmi\u003eσ\u003c/mi\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003cmo stretchy=\"true\"\u003e⏞\u003c/mo\u003e\u003c/mover\u003e\u003cmtext\u003eSources\u003c/mtext\u003e\u003c/mover\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmi\u003ef\u003c/mi\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmi\u003eσ\u003c/mi\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003cmo fence=\"true\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cmo stretchy=\"true\"\u003e⏟\u003c/mo\u003e\u003c/munder\u003e\u003cmtext\u003eFields\u003c/mtext\u003e\u003c/munder\u003e\u003cmunder\u003e\u003cmunder\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmi\u003eσ\u003c/mi\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmi\u003em\u003c/mi\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003cmo stretchy=\"true\"\u003e⏟\u003c/mo\u003e\u003c/munder\u003e\u003cmtext\u003eProperties\u003c/mtext\u003e\u003c/munder\u003e\u003c/mrow\u003e\u003c/mstyle\u003e\u003c/mtd\u003e\u003c/mtr\u003e\u003c/mtable\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\begin{align*}\nJ(m) \u0026amp;= \\frac{dP(f)}{df}\\frac{df}{d\\sigma}\\frac{d\\sigma}{dm}\\\\\n \u0026amp;= \\underbrace{\\left(\\frac{\\partial f}{\\partial u}\\overbrace{\\frac{du}{d\\sigma}}^\\text{Physics} +\n    \\frac{\\partial f}{\\partial s_m}\\overbrace{\\frac{ds_m}{d\\sigma}}^\\text{Sources} +\n    \\frac{\\partial f}{\\partial s_e}\\overbrace{\\frac{ds_e}{d\\sigma}}^\\text{Sources} +\n    \\frac{\\partial f}{\\partial\\sigma}\\right)}_\\text{Fields}\\underbrace{\\frac{d\\sigma}{dm}}_\\text{Properties}\n\\end{align*}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:9.2332em;vertical-align:-4.3666em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mtable\"\u003e\u003cspan class=\"col-align-r\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:4.8666em;\"\u003e\u003cspan style=\"top:-8.2813em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:4.8417em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.09618em;\"\u003eJ\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003em\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-4.2592em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:4.8417em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:4.3666em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"col-align-l\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:4.8666em;\"\u003e\u003cspan style=\"top:-8.2813em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:4.8417em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.427em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\"\u003edf\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eP\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8804em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3714em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eσ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\"\u003edf\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3714em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003em\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eσ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-4.2592em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:4.8417em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord munder\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:2.8417em;\"\u003e\u003cspan style=\"top:-1.3575em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:4.8417em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003eFields\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-4.8417em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:4.8417em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord munder\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:2.8417em;\"\u003e\u003cspan class=\"svg-align\" style=\"top:-2.0436em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:4.8417em;\"\u003e\u003c/span\u003e\u003cspan class=\"stretchy\" style=\"height:0.548em;min-width:1.6em;\"\u003e\u003cspan class=\"brace-left\" style=\"height:0.548em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'\u003e\u003cpath d='M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13\n 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688\n 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7\n-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003cspan class=\"brace-center\" style=\"height:0.548em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'\u003e\u003cpath d='M199572 214\nc100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14\n 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3\n 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0\n-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003cspan class=\"brace-right\" style=\"height:0.548em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'\u003e\u003cpath d='M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3\n 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237\n-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-4.8417em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:4.8417em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"minner\"\u003e\u003cspan class=\"mopen\"\u003e\u003cspan class=\"delimsizing mult\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:2.65em;\"\u003e\u003cspan style=\"top:-1.711em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.216em;\"\u003e\u003c/span\u003e\u003cspan class=\"delimsizinginner delim-size4\"\u003e\u003cspan\u003e⎝\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-2.858em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.216em;\"\u003e\u003c/span\u003e\u003cspan style=\"height:1.216em;width:0.875em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='0.875em' height='1.216em' style='width:0.875em' viewBox='0 0 875 1216' preserveAspectRatio='xMinYMin'\u003e\u003cpath d='M291 0 H417 V1216 H291z M291 0 H417 V1216 H291z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-4.7111em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.216em;\"\u003e\u003c/span\u003e\u003cspan class=\"delimsizinginner delim-size4\"\u003e\u003cspan\u003e⎛\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:2.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3714em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord mover\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:2.8417em;\"\u003e\u003cspan style=\"top:-4.0194em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:4.0194em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mover\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:2.0194em;\"\u003e\u003cspan style=\"top:-3.3714em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.3714em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3714em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eσ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eu\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"svg-align\" style=\"top:-4.8429em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.3714em;\"\u003e\u003c/span\u003e\u003cspan class=\"stretchy\" style=\"height:0.548em;min-width:1.6em;\"\u003e\u003cspan class=\"brace-left\" style=\"height:0.548em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'\u003e\u003cpath d='M6 548l-6-6v-35l6-11c56-104 135.3-181.3 238-232 57.3-28.7 117\n-45 179-50h399577v120H403c-43.3 7-81 15-113 26-100.7 33-179.7 91-237 174-2.7\n 5-6 9-10 13-.7 1-7.3 1-20 1H6z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003cspan class=\"brace-center\" style=\"height:0.548em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'\u003e\u003cpath d='M200428 334\nc-100.7-8.3-195.3-44-280-108-55.3-42-101.7-93-139-153l-9-14c-2.7 4-5.7 8.7-9 14\n-53.3 86.7-123.7 153-211 199-66.7 36-137.3 56.3-212 62H0V214h199568c178.3-11.7\n 311.7-78.3 403-201 6-8 9.7-12 11-12 .7-.7 6.7-1 18-1s17.3.3 18 1c1.3 0 5 4 11\n 12 44.7 59.3 101.3 106.3 170 141s145.3 54.3 229 60h199572v120z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003cspan class=\"brace-right\" style=\"height:0.548em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'\u003e\u003cpath d='M400000 542l\n-6 6h-17c-12.7 0-19.3-.3-20-1-4-4-7.3-8.3-10-13-35.3-51.3-80.8-93.8-136.5-127.5\ns-117.2-55.8-184.5-66.5c-.7 0-2-.3-4-1-18.7-2.7-76-4.3-172-5H0V214h399571l6 1\nc124.7 8 235 61.7 331 161 31.3 33.3 59.7 72.7 85 118l7 13v35z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-6.375em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:4.0194em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003ePhysics\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3714em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003es\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003em\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.836em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord mover\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:2.6978em;\"\u003e\u003cspan style=\"top:-4.0194em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:4.0194em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mover\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:2.0194em;\"\u003e\u003cspan style=\"top:-3.3714em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.3714em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3714em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eσ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003es\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003em\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"svg-align\" style=\"top:-4.8429em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.3714em;\"\u003e\u003c/span\u003e\u003cspan class=\"stretchy\" style=\"height:0.548em;min-width:1.6em;\"\u003e\u003cspan class=\"brace-left\" style=\"height:0.548em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'\u003e\u003cpath d='M6 548l-6-6v-35l6-11c56-104 135.3-181.3 238-232 57.3-28.7 117\n-45 179-50h399577v120H403c-43.3 7-81 15-113 26-100.7 33-179.7 91-237 174-2.7\n 5-6 9-10 13-.7 1-7.3 1-20 1H6z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003cspan class=\"brace-center\" style=\"height:0.548em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'\u003e\u003cpath d='M200428 334\nc-100.7-8.3-195.3-44-280-108-55.3-42-101.7-93-139-153l-9-14c-2.7 4-5.7 8.7-9 14\n-53.3 86.7-123.7 153-211 199-66.7 36-137.3 56.3-212 62H0V214h199568c178.3-11.7\n 311.7-78.3 403-201 6-8 9.7-12 11-12 .7-.7 6.7-1 18-1s17.3.3 18 1c1.3 0 5 4 11\n 12 44.7 59.3 101.3 106.3 170 141s145.3 54.3 229 60h199572v120z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003cspan class=\"brace-right\" style=\"height:0.548em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'\u003e\u003cpath d='M400000 542l\n-6 6h-17c-12.7 0-19.3-.3-20-1-4-4-7.3-8.3-10-13-35.3-51.3-80.8-93.8-136.5-127.5\ns-117.2-55.8-184.5-66.5c-.7 0-2-.3-4-1-18.7-2.7-76-4.3-172-5H0V214h399571l6 1\nc124.7 8 235 61.7 331 161 31.3 33.3 59.7 72.7 85 118l7 13v35z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-6.2389em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:4.0194em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003eSources\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3714em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003es\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ee\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.836em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord mover\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:2.6978em;\"\u003e\u003cspan style=\"top:-4.0194em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:4.0194em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mover\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:2.0194em;\"\u003e\u003cspan style=\"top:-3.3714em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.3714em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3714em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eσ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003es\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ee\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"svg-align\" style=\"top:-4.8429em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.3714em;\"\u003e\u003c/span\u003e\u003cspan class=\"stretchy\" style=\"height:0.548em;min-width:1.6em;\"\u003e\u003cspan class=\"brace-left\" style=\"height:0.548em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'\u003e\u003cpath d='M6 548l-6-6v-35l6-11c56-104 135.3-181.3 238-232 57.3-28.7 117\n-45 179-50h399577v120H403c-43.3 7-81 15-113 26-100.7 33-179.7 91-237 174-2.7\n 5-6 9-10 13-.7 1-7.3 1-20 1H6z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003cspan class=\"brace-center\" style=\"height:0.548em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'\u003e\u003cpath d='M200428 334\nc-100.7-8.3-195.3-44-280-108-55.3-42-101.7-93-139-153l-9-14c-2.7 4-5.7 8.7-9 14\n-53.3 86.7-123.7 153-211 199-66.7 36-137.3 56.3-212 62H0V214h199568c178.3-11.7\n 311.7-78.3 403-201 6-8 9.7-12 11-12 .7-.7 6.7-1 18-1s17.3.3 18 1c1.3 0 5 4 11\n 12 44.7 59.3 101.3 106.3 170 141s145.3 54.3 229 60h199572v120z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003cspan class=\"brace-right\" style=\"height:0.548em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'\u003e\u003cpath d='M400000 542l\n-6 6h-17c-12.7 0-19.3-.3-20-1-4-4-7.3-8.3-10-13-35.3-51.3-80.8-93.8-136.5-127.5\ns-117.2-55.8-184.5-66.5c-.7 0-2-.3-4-1-18.7-2.7-76-4.3-172-5H0V214h399571l6 1\nc124.7 8 235 61.7 331 161 31.3 33.3 59.7 72.7 85 118l7 13v35z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-6.2389em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:4.0194em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003eSources\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3714em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eσ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e\u003cspan class=\"delimsizing mult\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:2.65em;\"\u003e\u003cspan style=\"top:-1.711em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.216em;\"\u003e\u003c/span\u003e\u003cspan class=\"delimsizinginner delim-size4\"\u003e\u003cspan\u003e⎠\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-2.858em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.216em;\"\u003e\u003c/span\u003e\u003cspan style=\"height:1.216em;width:0.875em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='0.875em' height='1.216em' style='width:0.875em' viewBox='0 0 875 1216' preserveAspectRatio='xMinYMin'\u003e\u003cpath d='M457 0 H583 V1216 H457z M457 0 H583 V1216 H457z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-4.7111em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.216em;\"\u003e\u003c/span\u003e\u003cspan class=\"delimsizinginner delim-size4\"\u003e\u003cspan\u003e⎞\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:2.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:2.798em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:3.4841em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord munder\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3714em;\"\u003e\u003cspan style=\"top:-1.3591em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.3714em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003eProperties\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.3714em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.3714em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord munder\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3714em;\"\u003e\u003cspan class=\"svg-align\" style=\"top:-2.0374em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.3714em;\"\u003e\u003c/span\u003e\u003cspan class=\"stretchy\" style=\"height:0.548em;min-width:1.6em;\"\u003e\u003cspan class=\"brace-left\" style=\"height:0.548em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'\u003e\u003cpath d='M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13\n 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688\n 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7\n-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003cspan class=\"brace-center\" style=\"height:0.548em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'\u003e\u003cpath d='M199572 214\nc100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14\n 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3\n 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0\n-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003cspan class=\"brace-right\" style=\"height:0.548em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'\u003e\u003cpath d='M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3\n 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237\n-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.3714em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.3714em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3714em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003em\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eσ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.334em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:2.1484em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:4.3666em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"6","key":"VKeT7OvTK1"},{"type":"paragraph","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"To successfully translate eq to code we need to know how those different quantities are represented in the SimPEG echosystem. Table below gives a summary of the identification of the with SimPEG/python objects.","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"Jmpk66Czvy"}],"key":"rMXB2QsrXz"},{"type":"table","position":{"start":{"line":45,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"Theoretical","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"irCd0T2X3f"}],"key":"fiwkkHJ2pZ"},{"type":"tableCell","header":true,"position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"SimPEG","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"aaiimaKrSx"}],"key":"Qf608WaIoh"}],"key":"TZWWEW8roI"},{"type":"tableRow","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"J","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"uZTESsrwzP"}],"key":"LFkX7zwJjb"},{"type":"tableCell","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"numpy.ndarray (N,M)","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"beWtubO8ou"}],"key":"F1eSq27sHI"}],"key":"i0jH4PjtTz"},{"type":"tableRow","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"m","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"adV6gR1C8O"}],"key":"RZsM5FnUXP"},{"type":"tableCell","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"numpy.ndarray (M)","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"aYvBkY4UDb"}],"key":"T9SFflpUEb"}],"key":"Yz94lcrbPh"},{"type":"tableRow","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"f","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"yhXTfKDfMO"}],"key":"ieGQFFbMfA"},{"type":"tableCell","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"SimPEG.fields.Fields","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"G5VZied8FM"}],"key":"mGIeOgkpwn"}],"key":"jNfHVXaAQG"}],"key":"qPTIP1jqiS"},{"type":"paragraph","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"With this we finish our review of some concepts related to the computation of the sensitivity matrix in SimPEG, now it is time to look at an actual problem.","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"TbBIdn6Q6R"}],"key":"nkAM0wKECK"}],"data":{"type":"notebook-content"},"key":"YTOm4IfaSF"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Import modules","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"efdpCMWD1B"}],"identifier":"import-modules","label":"Import modules","html_id":"import-modules","implicit":true,"key":"UQv5JSc6qR"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here, we import all of the functionality required to run the notebook for the tutorial exercise. All of the functionality specific to DC resistivity is imported from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"iaQIcbPfXk"},{"type":"link","url":"https://docs.simpeg.xyz/content/api/SimPEG.electromagnetics.static.resistivity.html#module-simpeg.electromagnetics.static.resistivity","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"SimPEG​.electromagnetics​.static​.resistivity","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"t0JSYiKHGW"}],"urlSource":"myst:SimPEG#SimPEG.electromagnetics.static.resistivity","internal":false,"protocol":"myst","key":"a1gEeGHMe5"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"iuY3hM4e3l"}],"key":"ZCZ0rsmbUs"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"We also import some useful utility functions from ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"qk1N2Y5TlW"},{"type":"link","url":"https://docs.simpeg.xyz/content/api/SimPEG.utils.html#module-simpeg.utils","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"SimPEG.utils","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"vb9dihgFnJ"}],"urlSource":"myst:SimPEG#SimPEG.utils","internal":false,"protocol":"myst","key":"DoG1nFHert"},{"type":"text","value":". To simulate DC resistivity data, we need to define our problem geometry on a numerical grid (or mesh).\nTo generate the mesh, we used the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mjFOHkBHr5"},{"type":"link","url":"https://discretize.simpeg.xyz/en/main","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"discretize","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"idMzexChEM"}],"urlSource":"https://discretize.simpeg.xyz/en/main","key":"DB1q0ZnoyC"},{"type":"text","value":" package.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"I7BFFmTOHn"}],"key":"UVoa9fPhjX"}],"data":{"type":"notebook-content"},"key":"tu1sNRjkAq"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"# SimPEG functionality\nfrom SimPEG.electromagnetics.static import resistivity as dc\nfrom SimPEG import maps\n\n# discretize functionality\nfrom discretize import TreeMesh, TensorMesh\n\n# Common Python functionality\nimport numpy as np\nimport matplotlib as mpl\nimport matplotlib.pyplot as plt\nfrom matplotlib.colors import LogNorm\n\n# SimPEG inversion machinery\nfrom SimPEG import (\n    Data,\n    data_misfit,\n    regularization,\n    optimization,\n    inverse_problem,\n    inversion,\n    directives,\n)\n\nfrom SimPEG.electromagnetics.static import utils as dc_utils\n\n# linear solvers\ntry:\n    from pymatsolver import Pardiso as Solver  # this is a fast linear solver\nexcept ImportError:\n    from SimPEG import SolverLU as Solver  # this will be slower","key":"wUAhTSWSSc"},{"type":"output","id":"4fkBpimaB_IwJZTXrikCH","data":[],"key":"kHHTqlrF4N"}],"data":{"type":"notebook-code"},"key":"DadQa1jqsZ"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Homogeneous half space","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UOEkSvf1gK"}],"identifier":"homogeneous-half-space","label":"Homogeneous half space","html_id":"homogeneous-half-space","implicit":true,"key":"jBoRBkvd9a"}],"data":{"type":"notebook-content"},"key":"CltN9YBrRZ"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define surveys","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EIyCzOM4d7"}],"identifier":"define-surveys","label":"Define surveys","html_id":"define-surveys","implicit":true,"key":"dO167V2UuS"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"There are many different possible combinations of current and potential electrodes locations that could be used to create a DC resistivity survey. Maybe some of those combinations would be better than others for a particular case under specific constraints such as cost, physical constraints, time and sensitivity to a particular target at depth. The sensitivity analysis, that we are going to perform in this tutorial, will help us with the task of assessing the performance of a given electrode array with respect to its sensitivity to conductivity anomalies around a particular target region in the subsurface. For more information about DC resistivity modeling in SimPEG check out the tutorial ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"FW4bUe9Nxg"},{"type":"link","url":"05-dcr/fwd_dcr_2d","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"2.5D DC Resistivity Simulation","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"fNuMXYCYOm"}],"urlSource":"05-dcr/fwd_dcr_2d","key":"XbOAiXcbhr"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"DxCHCN6sTf"}],"key":"dgg7q5YkTT"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"In the figure below, we can see a few of the most common array configurations used in the industry and academic works.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"KbiDsGHBPO"}],"key":"iT2z92u3kp"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/user-tutorials/build/f037fe2572b5e1b2bf477ba85272db70.gif","width":"350px","align":"center","alt":"DC resistivity arrays (image source)","data":{"altTextIsAutoGenerated":true},"key":"S3qf8d0K9L","urlSource":"https://gpg.geosci.xyz/_images/figure6.gif"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"DC resistivity arrays (","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"wJF30Mohap"},{"type":"link","url":"https://gpg.geosci.xyz/_images/figure6.gif","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"image source","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"akg4XNGYoK"}],"urlSource":"https://gpg.geosci.xyz/_images/figure6.gif","key":"JS04wooLBX"},{"type":"text","value":")","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"KiIciRQgFM"}],"key":"dHm3wVXQlH"}],"key":"DeDiMLXlya"}],"enumerator":"1","key":"quvUEtGLbx"}],"data":{"type":"notebook-content"},"key":"wwT56wpKYI"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Two simple surveys in a homogeneous medium","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LQ1TVl8CNA"}],"key":"xnIY1Vrnsf"}],"key":"feC0t1h8y4"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Our first step is to create two simple surveys, Wenner alpha and Wenner beta. Each of theses surveys will contain one pair of current electrodes and one pair of potential electrodes only. The extension to any number of current/potential electrodes is straightforward and will be left as an exercise.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tufDYAqUFH"}],"key":"d61Io5vPyC"}],"data":{"type":"notebook-content"},"key":"mVurvLzreZ"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"# Define survey line parameters for Wenner surveys\ndata_type = \"volt\"\nsrc_list = []\n\n# Wenner alpha\nC_wenner_alpha = np.array([[-15.0, 0.0], [15.0, 0.0]])\nP_wenner_alpha = np.array([[-5.0, 0.0], [5.0, 0.0]])\n\nrx_wenner_alpha = dc.receivers.Dipole(\n    locations_m=P_wenner_alpha[0],\n    locations_n=P_wenner_alpha[1],\n    data_type=data_type\n)\nrx_list_wenner_alpha = [rx_wenner_alpha]\n\nsrc_list.append(\n    dc.sources.Dipole(\n        location_a=C_wenner_alpha[0],\n        location_b=C_wenner_alpha[1],\n        receiver_list=rx_list_wenner_alpha,\n    )\n)\n\n# Dipole-Dipole\nC_dipole_dipole = np.array([[-15.0, 0.0], [-5.0, 0.0]])\nP_dipole_dipole = np.array([[5.0, 0.0], [15.0, 0.0]])\n\nrx_dipole_dipole = dc.receivers.Dipole(\n    locations_m=P_dipole_dipole[0],\n    locations_n=P_dipole_dipole[1],\n    data_type=data_type\n)\nrx_list_dipole_dipole = [rx_dipole_dipole]\n\nsrc_list.append(\n    dc.sources.Dipole(\n        location_a=C_dipole_dipole[0],\n        location_b=C_dipole_dipole[1],\n        receiver_list=rx_list_dipole_dipole,\n    )\n)\n\nsurvey = dc.Survey(source_list=src_list)","key":"LmpIqVKm0a"},{"type":"output","id":"h44f8ZOaoDEY4wgSLtJx4","data":[],"key":"YKm2qjZdzy"}],"data":{"type":"notebook-code","scrolled":true,"vscode":{"languageId":"plaintext"}},"key":"y9BterYb23"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create mesh","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jWP5TkQKMw"}],"identifier":"create-mesh","label":"Create mesh","html_id":"create-mesh","implicit":true,"key":"bjSNx62c3Z"}],"data":{"type":"notebook-content"},"key":"XTRk5MRVbn"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"dh = 0.25  # base cell width\ndom_width_x = 150.0  # domain width x\ndom_width_z = 100.0  # domain width z\nnbcx = 2 ** int(np.round(np.log(dom_width_x / dh) / np.log(2.0)))\nnbcz = 2 ** int(np.round(np.log(dom_width_z / dh) / np.log(2.0)))\n\n# Define the base mesh with top at z = 0 m.\nhx = [(dh, nbcx)]\nhz = [(dh, nbcz)]\nmesh = TreeMesh([hx, hz], x0=\"CN\")\n\n# Refine core mesh region\nmesh.refine_box([-50, -50], [50, 0], levels=-1, finalize=False)\n\nmesh.finalize()","key":"H4ZfM3x3rh"},{"type":"output","id":"0Lmc_-6ICMlLl6sbWl5Bj","data":[],"key":"wVbmT0eLci"}],"data":{"type":"notebook-code","vscode":{"languageId":"plaintext"}},"key":"d5zPEa78cR"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define the conductivity model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VEKktgJc3U"}],"identifier":"define-the-conductivity-model","label":"Define the conductivity model","html_id":"define-the-conductivity-model","implicit":true,"key":"J48lAsPFVw"}],"data":{"type":"notebook-content"},"key":"XZxD7CehSU"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"background_resistivity = 50  # Ohm.m\nbackground_conductivity = 1 / background_resistivity\nnC = mesh.nC\nconductivity_model = background_conductivity * np.ones(nC)\n\nconductivity_map = maps.IdentityMap()","key":"QJITtdkDuy"},{"type":"output","id":"-5laFRfH1HPf90bMhTubj","data":[],"key":"amJUdrFXQz"}],"data":{"type":"notebook-code"},"key":"NF78DEAACJ"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"# DC simulation for a conductivity model\nsimulation_con = dc.simulation_2d.Simulation2DNodal(\n    mesh, survey=survey, sigmaMap=conductivity_map\n)","key":"rbFy6dPfBX"},{"type":"output","id":"zZM-fCPK2Mh7429tOAVGZ","data":[],"key":"OE3Ug3Btac"}],"data":{"type":"notebook-code"},"key":"Hyr1Y2aCk3"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot sensitivity","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jot7zqQHR2"}],"identifier":"plot-sensitivity","label":"Plot sensitivity","html_id":"plot-sensitivity","implicit":true,"key":"qrScevPBfa"}],"data":{"type":"notebook-content"},"key":"t7uhySDmO8"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Get the sensitivity matrix","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QgF8wx3qKj"}],"key":"CkA36qiFOy"}],"key":"oGUPjN8fHC"}],"data":{"type":"notebook-content"},"key":"dI1TCNL9EE"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"J = simulation_con.getJ(conductivity_model).copy()\nJ_wenner_alpha = J[0, :] / np.max(abs(J[0, :]))\nJ_dipole_dipole = J[1, :] / np.max(abs(J[1, :]))","key":"HWqiRSsOv7"},{"type":"output","id":"obRP539C1hceoJTZ14NBJ","data":[],"key":"TkwgPwaZah"}],"data":{"type":"notebook-code"},"key":"tNXOo60wiO"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Make plots","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ofnn3Tco5M"}],"key":"eVScE0qGoe"}],"key":"SUb4mU5Qd7"}],"data":{"type":"notebook-content"},"key":"EI96tDITDR"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"##\n#\nfig, axs = plt.subplots(1, 2, figsize=(10, 2))\nplt.jet()\n\nnorm = mpl.colors.SymLogNorm(\n    linthresh=0.005, linscale=1e-4, vmin=-1.0, vmax=1.0, base=10\n)\n\nJs = np.c_[J_wenner_alpha, J_dipole_dipole]\nC_locs = np.r_[C_wenner_alpha, C_dipole_dipole]\nP_locs = np.r_[P_wenner_alpha, P_dipole_dipole]\n\nplt_titles = [\"Wenner alpha\", \"dipole-dipole\"]\ni = 0\nfor ax in axs:\n    mesh.plot_image(Js[:, i], ax=ax, grid=False, pcolor_opts={\"norm\": norm})\n\n    xmin = -50\n    xmax = 50\n    zmin = -20\n    zmax = 0\n    ax.set_xlim(xmin, xmax)\n    ax.set_ylim(zmin, zmax)\n    ax.set_title(plt_titles[i], loc=\"left\")\n    ax.set_xlabel(\"x (m)\")\n    ax.set_ylabel(\"z (m)\")\n\n    xc = (C_locs[2 * i, 0] - xmin) / (xmax - xmin)\n    ax.annotate(\n        \"\",\n        xy=(xc, 1),\n        xycoords=\"axes fraction\",\n        xytext=(xc, 1.1),\n        arrowprops=dict(arrowstyle=\"-\u003e\", color=\"r\"),\n    )\n    xc = (C_locs[2 * i + 1, 0] - xmin) / (xmax - xmin)\n    ax.annotate(\n        \"\",\n        xy=(xc, 1),\n        xycoords=\"axes fraction\",\n        xytext=(xc, 1.1),\n        arrowprops=dict(arrowstyle=\"-\u003e\", color=\"r\"),\n    )\n    xc = (P_locs[2 * i, 0] - xmin) / (xmax - xmin)\n    ax.annotate(\n        \"\",\n        xy=(xc, 1),\n        xycoords=\"axes fraction\",\n        xytext=(xc, 1.075),\n        arrowprops=dict(arrowstyle=\"-\u003e\", color=\"b\"),\n    )\n    xc = (P_locs[2 * i + 1, 0] - xmin) / (xmax - xmin)\n    ax.annotate(\n        \"\",\n        xy=(xc, 1),\n        xycoords=\"axes fraction\",\n        xytext=(xc, 1.075),\n        arrowprops=dict(arrowstyle=\"-\u003e\", color=\"b\"),\n    )\n\n    i = i + 1\n\nax2 = fig.add_axes([0.25, -0.3, 0.5, 0.1])\ncbar = mpl.colorbar.ColorbarBase(ax2, norm=norm, orientation=\"horizontal\")\ncbar.set_label(\"Sensitivity\", rotation=0, labelpad=15, size=12)","key":"nFmqTdKWfq"},{"type":"output","id":"C58TVvTgbuco_UXt9ZjzZ","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c008aa96b4e954ee31d77df7a010d9d1","path":"/user-tutorials/build/c008aa96b4e954ee31d77df7a010d9d1.png"},"text/plain":{"content":"\u003cFigure size 1000x200 with 3 Axes\u003e","content_type":"text/plain"}}}],"key":"IcHQGczBLu"}],"data":{"type":"notebook-code"},"key":"FoUZwN7SWW"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Cumulative sensitivity of a given array","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DtElix66De"}],"key":"TzCWbxsAjI"}],"key":"QiSuU7xJpw"}],"key":"QyplJwRY7w"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Let’s experiment with another way to look at the sensitivity matrix. This time we are going to plot the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"iW71fEIyjK"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"cumulative sensitivity","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Xq9tGgVCn2"}],"key":"vYNZHYtghO"},{"type":"text","value":" ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UQGbrPo1DH"},{"type":"inlineMath","value":"CS","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eC\u003c/mi\u003e\u003cmi\u003eS\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eCS\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\"\u003eCS\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"NuX8LH7Gzs"},{"type":"text","value":" defined as\n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Ek3oDCIzp5"}],"key":"KMNvArPH00"},{"type":"math","value":"\n CS = \\frac{\\sum_{i=1}^P S_i}{\\sum_{i=1}^M S_i}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eC\u003c/mi\u003e\u003cmi\u003eS\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmunderover\u003e\u003cmo\u003e∑\u003c/mo\u003e\u003cmrow\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003cmi\u003eP\u003c/mi\u003e\u003c/munderover\u003e\u003cmsub\u003e\u003cmi\u003eS\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmunderover\u003e\u003cmo\u003e∑\u003c/mo\u003e\u003cmrow\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003cmi\u003eM\u003c/mi\u003e\u003c/munderover\u003e\u003cmsub\u003e\u003cmi\u003eS\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\n CS = \\frac{\\sum_{i=1}^P S_i}{\\sum_{i=1}^M S_i}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\"\u003eCS\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.8419em;vertical-align:-1.1709em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.6709em;\"\u003e\u003cspan style=\"top:-2.1288em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mop\"\u003e\u003cspan class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\"\u003e∑\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9812em;\"\u003e\u003cspan style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003cspan class=\"mrel mtight\"\u003e=\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.2029em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\"\u003eM\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2997em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\"\u003eS\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.6897em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mop\"\u003e\u003cspan class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\"\u003e∑\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9812em;\"\u003e\u003cspan style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003cspan class=\"mrel mtight\"\u003e=\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.2029em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\"\u003eP\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2997em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\"\u003eS\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.1709em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"7","key":"Kx6dC9rfQX"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"\nwhere ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DzloHQI61m"},{"type":"inlineMath","value":"S","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eS\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eS\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\"\u003eS\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"vdo2Bca0MN"},{"type":"text","value":" contains a particular row of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"G9UfH4WdNl"},{"type":"inlineMath","value":"\\left|J\\right|","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmo fence=\"true\"\u003e∣\u003c/mo\u003e\u003cmi\u003eJ\u003c/mi\u003e\u003cmo fence=\"true\"\u003e∣\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\left|J\\right|\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"minner\"\u003e\u003cspan class=\"mopen delimcenter\" style=\"top:0em;\"\u003e∣\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.09618em;\"\u003eJ\u003c/span\u003e\u003cspan class=\"mclose delimcenter\" style=\"top:0em;\"\u003e∣\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Ngii6CwYQD"},{"type":"text","value":" sorted in decreasing order.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"w9UVL7yrSy"}],"key":"LSqXLJfzkl"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"We took inspiration for this plot from ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"cNF0y4cdfr"},{"type":"cite","kind":"narrative","label":"Furman_2003","identifier":"https://doi.org/10.2136/vzj2003.4160","children":[{"type":"text","value":"Furman ","key":"Rs1sLttFFT"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"jN506loOXF"}],"key":"zHVLdADcR7"},{"type":"text","value":" (2003)","key":"vhytJxBEbP"}],"key":"avx2uTdA2M"},{"type":"text","value":".","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Sxea0o68JO"}],"key":"vHgveP4c2N"}],"data":{"type":"notebook-content"},"key":"vvRDFtm49N"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"# Define survey line parameters\nsurvey_type = \"dipole-dipole\"\ndimension_type = \"2D\"\ndata_type = \"volt\"\n\nsrc_list = []\nC_locs = []\nP_locs = []\n\n# Array 1\nC = np.array([[-15.0, 0.0], [-5.0, 0.0]])\nP = np.array([[5.0, 0.0], [15.0, 0.0]])\n\nC_locs.append(C)\nP_locs.append(P)\n\nrx = dc.receivers.Dipole(locations_m=P[0],\n                         locations_n=P[1],\n                         data_type=data_type)\nrx_list = [rx]\n\nsrc_list.append(\n    dc.sources.Dipole(location_a=C[0],\n                      location_b=C[1],\n                      receiver_list=rx_list)\n)\n\n# Array 2\nC = np.array([[-30.0, 0.0], [-20.0, 0.0]])\nP = np.array([[20.0, 0.0], [30.0, 0.0]])\n\nC_locs.append(C)\nP_locs.append(P)\n\nrx = dc.receivers.Dipole(locations_m=P[0],\n                         locations_n=P[1],\n                         data_type=data_type)\nrx_list = [rx]\n\nsrc_list.append(\n    dc.sources.Dipole(location_a=C[0],\n                      location_b=C[1],\n                      receiver_list=rx_list)\n)\n\n# Define survey\nsurvey = dc.Survey(src_list)","key":"hwy4U8VxBT"},{"type":"output","id":"Dnop8K1oC0RMW52rGnBza","data":[],"key":"H8vDpbfq11"}],"data":{"type":"notebook-code"},"key":"FFrvI5uma2"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"# DC simulation for a conductivity model\nsimulation_con = dc.simulation_2d.Simulation2DNodal(\n    mesh, survey=survey, sigmaMap=conductivity_map\n)","key":"eST72diGtk"},{"type":"output","id":"E6orettX3ERW3x-49migF","data":[],"key":"gSTBATwvPq"}],"data":{"type":"notebook-code"},"key":"wu1ihPBmcA"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"J = simulation_con.getJ(conductivity_model).copy()","key":"IokkCRs8e1"},{"type":"output","id":"vxxDp-8EU3l8TlD_C2t9l","data":[],"key":"DBRLiL5HF9"}],"data":{"type":"notebook-code"},"key":"LVlpAcRE5r"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"##\n# Interpolate to a regular grid for creating the plots\nxmin = -50\nxmax = 50.0\ngrid_nx = 500\nzmin = -20.0\nzmax = 0.0\ngrid_nz = 200\n[xgrid, zgrid] = np.meshgrid(\n    np.linspace(xmin, xmax, grid_nx),\n    np.linspace(zmin, zmax, grid_nz)\n)\nlocs = np.vstack([xgrid.ravel(), zgrid.ravel()])\nQ = mesh.get_interpolation_matrix(locs.T)","key":"LebMyDuHx4"},{"type":"output","id":"T2DK47--5ZPcqqUwgK5--","data":[],"key":"oOgi8yeHhJ"}],"data":{"type":"notebook-code"},"key":"IOyNDxwaEO"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"fig, axs = plt.subplots(1, 2, figsize=(10, 2))\nlevels = [0.95, 0.7, 0.5, 0.2]\n\ni = 0\nfor ax in axs:\n    Js = Q @ J[i, :].T\n    ##\n    # Fill cells with corresponding\n    # cumulative sensitivity values\n    Z = np.ones(grid_nz * grid_nx)\n\n    N = np.size(Js)\n    CS_all = np.sum(abs(Js))\n    Js_sort_idx = (-abs(Js)).argsort()[:N]\n    Js_sort = abs(Js[Js_sort_idx])\n    for perc in levels:\n        CS = 0\n        for j in range(N):\n            CS = CS + abs(Js_sort[j]) / CS_all\n            if CS \u003e= perc:\n                break\n        Z[Js_sort_idx[0: j + 1]] = perc\n\n    Z = Z.reshape((grid_nz, grid_nx))\n\n    ##\n    # Plot\n    ax.contourf(xgrid, zgrid, Z,\n                levels=np.sort(levels), cmap=\"GnBu_r\")\n    ccs = ax.contour(\n        xgrid, zgrid, Z,\n        levels=np.sort(levels),\n        colors=\"w\", linewidths=0.75\n    )\n    ax.clabel(ccs, ccs.levels,\n              inline=False,\n              fmt=\"%2.1f\", fontsize=10, colors=\"k\")\n\n    ##\n    # Plot electrodes locations\n    xc = (C_locs[i][0, 0] - xmin) / (xmax - xmin)\n    ax.annotate(\n        \"\",\n        xy=(xc, 1),\n        xycoords=\"axes fraction\",\n        xytext=(xc, 1.1),\n        arrowprops=dict(arrowstyle=\"-\u003e\", color=\"r\"),\n    )\n    xc = (C_locs[i][1, 0] - xmin) / (xmax - xmin)\n    ax.annotate(\n        \"\",\n        xy=(xc, 1),\n        xycoords=\"axes fraction\",\n        xytext=(xc, 1.1),\n        arrowprops=dict(arrowstyle=\"-\u003e\", color=\"r\"),\n    )\n    xc = (P_locs[i][0, 0] - xmin) / (xmax - xmin)\n    ax.annotate(\n        \"\",\n        xy=(xc, 1),\n        xycoords=\"axes fraction\",\n        xytext=(xc, 1.075),\n        arrowprops=dict(arrowstyle=\"-\u003e\", color=\"b\"),\n    )\n    xc = (P_locs[i][1, 0] - xmin) / (xmax - xmin)\n    ax.annotate(\n        \"\",\n        xy=(xc, 1),\n        xycoords=\"axes fraction\",\n        xytext=(xc, 1.075),\n        arrowprops=dict(arrowstyle=\"-\u003e\", color=\"b\"),\n    )\n\n    i = i + 1\n\nax2 = fig.add_axes([0.25, -0.3, 0.5, 0.1])\ncbar = mpl.colorbar.ColorbarBase(ax2,\n                                 orientation=\"horizontal\",\n                                 cmap=\"GnBu_r\")\ncbar.set_label(\"Cumulative normalized sensitivity\",\n               rotation=0, labelpad=15, size=12)","key":"yRou8ObTSh"},{"type":"output","id":"4AMObOrHBB_90ustDxAJC","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"20ce122ca7ebe786d0b6502b7da8cb0c","path":"/user-tutorials/build/20ce122ca7ebe786d0b6502b7da8cb0c.png"},"text/plain":{"content":"\u003cFigure size 1000x200 with 3 Axes\u003e","content_type":"text/plain"}}}],"key":"NgtBFhdVbx"}],"data":{"type":"notebook-code"},"key":"oL4cmm8qUr"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Real data example: The Century Deposit DC resistivity inversion","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Jf65FJ8JqF"}],"identifier":"real-data-example-the-century-deposit-dc-resistivity-inversion","label":"Real data example: The Century Deposit DC resistivity inversion","html_id":"real-data-example-the-century-deposit-dc-resistivity-inversion","implicit":true,"key":"n4AL9hAKOL"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this section we perform a sensitivity analysis for the solution obtained in the inversion of a real data set. We will build upon the tutorial that can be found at ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WI7BbYmV77"},{"type":"link","url":"https://github.com/simpeg/transform-2020-simpeg","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"transform2020","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Lz72V8dJIt"}],"urlSource":"https://github.com/simpeg/transform-2020-simpeg","error":true,"key":"CFVcXtKyQC"},{"type":"text","value":" created by Lindsey Heagy. You are also welcome to watch her associated presentation on youtube: ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"upwodEOKyF"},{"type":"link","url":"https://www.youtube.com/watch?v=jZ7Sj9cnnso\u0026t=3250s","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Tutorial: Geophysical Inversion in SimPEG","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ED1xSy3VyO"}],"urlSource":"https://www.youtube.com/watch?v=jZ7Sj9cnnso\u0026t=3250s","key":"S6TljsrmfZ"}],"key":"BPASa7U31I"}],"data":{"type":"notebook-content"},"key":"NxbqspPW6W"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Initial setup","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KAuSsdfPNt"}],"identifier":"initial-setup","label":"Initial setup","html_id":"initial-setup","implicit":true,"key":"UdYc6roPl1"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We will perform the following steps:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jpZURrIMyz"}],"key":"HoZLQ0jQd9"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Read information about the survey from a data file on disk","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"bZ6kyedPCW"}],"key":"sYI899dNxh"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Create a python dictionary containing:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"fhudNOvfxG"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"a_locations: the positive source electrode locations (numpy array)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"T8tgwnhaXL"}],"key":"fF6KlB8Qud"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"b_locations: the negative source electrode locations (numpy array)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"bmGK4YFF6T"}],"key":"qK9JawrAbY"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"m_locations: the receiver locations (list of numpy arrays)","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Y8uWuVBIL5"}],"key":"tSq6uoVQM0"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"n_locations: the receiver locations (list of numpy arrays)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"UqpmKFmFk2"}],"key":"RymA53OCxd"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"observed_data: observed data (list of numpy arrays)","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"HBcFpBnB6x"}],"key":"frMsdbsCtD"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"standard_deviations: assigned standard deviations (list of numpy arrays)","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"D07x3CXEwa"}],"key":"JD1rhaYNNb"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"n_sources: number of sources (int)","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"spqBf39KPy"}],"key":"lkVBViQuDd"}],"key":"tB953XuYw4"}],"key":"mX15o2F6gr"}],"key":"sdM6Jb25qv"}],"data":{"type":"notebook-content"},"key":"DfFTdX5Co1"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"line = \"46800E\"\ndc_data_file = f\"./century/{line}/{line[:-1]}POT.OBS\"\n\n\ndef read_dcip_data(filename, verbose=False):\n    \"\"\"Read in a .OBS file from the Century data set into a python dictionary.\n\n    The format is the old UBC-GIF DCIP format.\n\n    Parameters\n    ----------\n    filename : str\n        Path to the file to be parsed\n\n    verbose: bool\n        Print some things?\n\n\n    Returns\n    -------\n    dict\n        A dictionary with the locations of\n        - a_locations: the positive source electrode locations (numpy array)\n        - b_locations: the negative source electrode locations (numpy array)\n        - m_locations: the receiver locations (list of numpy arrays)\n        - n_locations: the receiver locations (list of numpy arrays)\n        - observed_data: observed data (list of numpy arrays)\n        - standard_deviations: assigned stds (list of numpy arrays)\n        - n_sources: number of sources (int)\n    \"\"\"\n    # read in the text file as a numpy array of\n    # strings (each row is an entry)\n    contents = np.genfromtxt(filename, delimiter=\" \\n\", dtype=\"U\")\n\n    # the second line has the number of sources,\n    # current, and data type (voltages if 1)\n    n_sources = int(contents[1].split()[0])\n\n    if verbose is True:\n        print(f\"number of sources: {n_sources}\")\n\n    # initialize storage for the electrode\n    # locations and data\n    a_locations = np.zeros(n_sources)\n    b_locations = np.zeros(n_sources)\n    m_locations = []\n    n_locations = []\n    observed_data = []\n    standard_deviations = []\n\n    # index to track where we have read in content\n    content_index = 1\n\n    # loop over sources\n    for i in range(n_sources):\n        # start by reading in the source info\n        content_index = content_index + 1  # read the next line\n        a_location, b_location, nrx = contents[\n            content_index\n        ].split()  # this is a string\n\n        # convert the strings to a float for locations\n        # and an int for the number of receivers\n        a_locations[i] = float(a_location)\n        b_locations[i] = float(b_location)\n        nrx = int(nrx)\n\n        # initialize space for receiver locations,\n        # observed data associated with this source\n        m_locations_i, n_locations_i = np.zeros(nrx), np.zeros(nrx)\n        observed_data_i, standard_deviations_i = np.zeros(nrx), np.zeros(nrx)\n\n        # read in the receiver info\n        for j in range(nrx):\n            content_index = content_index + 1  # read the next line\n            (m_location,\n             n_location,\n             datum, std) = contents[content_index].split()\n\n            # convert the locations and data to floats, and store them\n            m_locations_i[j] = float(m_location)\n            n_locations_i[j] = float(n_location)\n            observed_data_i[j] = float(datum)\n            standard_deviations_i[j] = float(std)\n\n        # append the receiver info to the lists\n        m_locations.append(m_locations_i)\n        n_locations.append(n_locations_i)\n        observed_data.append(observed_data_i)\n        standard_deviations.append(standard_deviations_i)\n\n    return {\n        \"a_locations\": a_locations,\n        \"b_locations\": b_locations,\n        \"m_locations\": m_locations,\n        \"n_locations\": n_locations,\n        \"observed_data\": observed_data,\n        \"standard_deviations\": standard_deviations,\n        \"n_sources\": n_sources,\n    }\n\n\ndc_data_dict = read_dcip_data(dc_data_file)","key":"raYDbk9j2g"},{"type":"output","id":"HujkGa70E9G5c0o3rfkNB","data":[],"key":"QGreLbbHJi"}],"data":{"type":"notebook-code"},"key":"z4co29znnm"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create survey","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mzV1Tc2dgA"}],"identifier":"create-survey","label":"Create survey","html_id":"create-survey","implicit":true,"key":"vZ33PLFYJK"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here we create a SimPEG Survey object representing the experiment layout.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nprr6B061I"}],"key":"sla1lRsq78"}],"data":{"type":"notebook-content"},"key":"L30sUPYmtl"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"# initialize an empty list for each\nsource_list = []\n\nfor i in range(dc_data_dict[\"n_sources\"]):\n    # receiver electrode locations in 2D\n    m_locs = np.vstack(\n        [dc_data_dict[\"m_locations\"][i],\n         np.zeros_like(dc_data_dict[\"m_locations\"][i])]\n    ).T\n    n_locs = np.vstack(\n        [dc_data_dict[\"n_locations\"][i],\n         np.zeros_like(dc_data_dict[\"n_locations\"][i])]\n    ).T\n\n    # construct the receiver object\n    receivers = dc.receivers.Dipole(locations_m=m_locs, locations_n=n_locs)\n\n    # construct the source\n    source = dc.sources.Dipole(\n        location_a=np.r_[dc_data_dict[\"a_locations\"][i], 0.0],\n        location_b=np.r_[dc_data_dict[\"b_locations\"][i], 0.0],\n        receiver_list=[receivers],\n    )\n\n    # append the new source to the source list\n    source_list.append(source)\n\nsurvey = dc.Survey(source_list=source_list)\n\ndc_data = Data(\n    survey=survey,\n    dobs=np.hstack(dc_data_dict[\"observed_data\"]),\n    standard_deviation=np.hstack(dc_data_dict[\"standard_deviations\"]),\n)","key":"k9Fvd5hkQf"},{"type":"output","id":"yUCmaL__sah7NY6NQcPOn","data":[],"key":"d5CsBnWZOZ"}],"data":{"type":"notebook-code"},"key":"z3MLvqcIe5"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Forward simulation components","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"peeSx1wOYp"}],"identifier":"forward-simulation-components","label":"Forward simulation components","html_id":"forward-simulation-components","implicit":true,"key":"XVKza7HNPl"}],"data":{"type":"notebook-content"},"key":"ohwOB7MQrE"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Mesh design","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cP2O3LNWJQ"}],"key":"mFFwK8wzZR"}],"key":"q8ltuF3Z5v"}],"key":"FY4poKQpxt"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We will create a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UPSp3rGEUE"},{"type":"link","url":"https://discretize.simpeg.xyz/en/main","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"discretize","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CnP8NMvWdH"}],"urlSource":"https://discretize.simpeg.xyz/en/main","key":"hdfwx1AvRz"},{"type":"text","value":" TensorMesh.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eWdK914T4x"}],"key":"OMX8V2TPms"}],"data":{"type":"notebook-content"},"key":"vHLc2nI0sV"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"min_electrode_spacing = np.min(\n    np.abs(survey.locations_a[:, 0] - survey.locations_b[:, 0])\n)\nn_cells_per_spacing = 4\n\ndx = min_electrode_spacing / n_cells_per_spacing\ndz = min_electrode_spacing / n_cells_per_spacing\n\nelectrode_locations = np.c_[\n    survey.locations_a,\n    survey.locations_b,\n    survey.locations_m,\n    survey.locations_n,\n]\n\nunique_locations = np.unique(\n    np.reshape(electrode_locations, (4 * survey.nD, 2)), axis=0\n)\n\ncore_domain_x = np.r_[unique_locations[:, 0].min(),\n                      unique_locations[:, 0].max()]\n\n# find the maximum spacing between source, receiver midpoints\nmid_ab = (survey.locations_a + survey.locations_b) / 2\nmid_mn = (survey.locations_m + survey.locations_n) / 2\nseparation_ab_mn = np.abs(mid_ab - mid_mn)\nmax_separation = separation_ab_mn.max()\n\ncore_domain_z = np.r_[-max_separation / 3.0, 0.0]\n\nn_core_extra = 4\nn_core_x = np.ceil(np.diff(core_domain_x) / dx) +\\\n           n_core_extra * 2  # on each side\nn_core_z = np.ceil(np.diff(core_domain_z) / dz) +\\\n           n_core_extra  # just below\n\npadding_factor = 1.3\nn_pad_x = 10\nn_pad_z = 10\n\nhx = [(dx, n_pad_x, -padding_factor),\n      (dx, n_core_x), (dx, n_pad_x, padding_factor)]\nhz = [(dz, n_pad_z, -padding_factor), (dz, n_core_z)]\n\nmesh = TensorMesh([hx, hz])\n\n# origin of the mesh\nmesh_hx = mesh.h[0]\nmesh_hy = mesh.h[1]\nmesh.x0 = np.r_[\n    -mesh_hx[: n_pad_x + n_core_extra].sum() +\n    core_domain_x.min(), -mesh_hy.sum()\n]","key":"z84w9pxBfk"},{"type":"output","id":"Udzx-up6t2EmyV5GTIyTu","data":[],"key":"KWzSDVgDAq"}],"data":{"type":"notebook-code"},"key":"ryMqY8SPLo"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"SimPEG forward simulation objects creation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wgZDk0ff0i"}],"key":"aeSU12HEy5"}],"key":"Z4pi4GuJcw"}],"key":"QkzY250DwJ"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The SimPEG simulation object for this particular problem is an object of type ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rZxZQF0Nni"},{"type":"link","url":"https://docs.simpeg.xyz/content/api/generated/SimPEG.electromagnetics.static.resistivity.Simulation2DNodal.html#simpeg.electromagnetics.static.resistivity.simulation2dnodal","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"SimPEG​.electromagnetics​.static​.resistivity​.Simulation2DNodal","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"la8pT1pFQD"}],"urlSource":"myst:SimPEG#SimPEG.electromagnetics.static.resistivity.Simulation2DNodal","internal":false,"protocol":"myst","key":"RKnLi5AVTN"},{"type":"text","value":". We will also work with the natual logarithm of the conductivity.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Z656RjfuR6"}],"key":"hBNiwiaBVY"}],"data":{"type":"notebook-content"},"key":"qBLvwGxHwE"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"# forward simulation\n# Use Exponential Map: m = log(rho)\nmapping = maps.ExpMap(mesh)\n\n# Generate 2.5D DC problem\nsimulation_dc = dc.Simulation2DNodal(\n    mesh, rhoMap=mapping, solver=Solver, survey=survey, storeJ=True\n)","key":"cFZtxX3xs5"},{"type":"output","id":"hHAox5JZDEI-Fy4ZzqPJf","data":[],"key":"bUKEDBlgUN"}],"data":{"type":"notebook-code"},"key":"cZpB5CS98M"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Inversion","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uxURMhzOVU"}],"identifier":"inversion","label":"Inversion","html_id":"inversion","implicit":true,"key":"DUtTfAeHlF"}],"data":{"type":"notebook-content"},"key":"nilflpukPO"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Inversion: Data misfit","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HiJgi6gDdD"}],"key":"U3Le91K5OO"}],"key":"EZ9uaHgNzb"}],"key":"ObGcor4W5d"}],"data":{"type":"notebook-content"},"key":"W8bcOKvYvZ"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"dmisfit = data_misfit.L2DataMisfit(data=dc_data, simulation=simulation_dc)","key":"HyY37CznBC"},{"type":"output","id":"ox5NQinUTViY6GtDD76a7","data":[],"key":"kamDAct5tP"}],"data":{"type":"notebook-code"},"key":"J7xMjISsO8"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Inversion: Regularization","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RyShwbyLb3"}],"key":"v2YrDZX1xW"}],"key":"C0mkvPQMAa"}],"key":"NPxp7P83kJ"}],"data":{"type":"notebook-content"},"key":"yfAiNAFNh3"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"mesh_hx = mesh.h[0]\nreg = regularization.WeightedLeastSquares(\n    mesh,\n    alpha_s=1.0\n    / mesh_hx.min() ** 2,  # we will talk about\n                           # these choices in notebook 3 on inversion\n    alpha_x=1,\n    alpha_y=1,  # since this is a 2D problem, the second dimension is \"y\"\n)","key":"W0lbqVxNHk"},{"type":"output","id":"hbpTERsRBmZm7nJeU3zWt","data":[],"key":"r1WRRaG6Vs"}],"data":{"type":"notebook-code"},"key":"HMS3UhFrdX"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Inversion: Final touches","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XBvFnirlrP"}],"key":"NfQNmIcms8"}],"key":"lhmKBJLDe8"}],"key":"TDfZ1wqykS"}],"data":{"type":"notebook-content"},"key":"sSlVAjWubN"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"opt = optimization.InexactGaussNewton(maxIter=20, maxIterCG=20)\ninv_prob = inverse_problem.BaseInvProblem(dmisfit, reg, opt)\n\n# directives\nbeta_est = directives.BetaEstimate_ByEig(beta0_ratio=1)\n\n# coolFac = 4\ncoolFac = 1\nbeta_schedule = directives.BetaSchedule(coolingFactor=coolFac,\n                                        coolingRate=2)\ntarget = directives.TargetMisfit()\n\ninv = inversion.BaseInversion(inv_prob,\n                              directiveList=[beta_est,\n                                             beta_schedule, target])","key":"o4IDALM5jc"},{"type":"output","id":"C_Ey3dVm3uY9_ba-x6HJM","data":[],"key":"GM1D0qUYkT"}],"data":{"type":"notebook-code"},"key":"mT0nJF5LlW"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Inversion: (Finally) run the inversion","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cxw2zohnj4"}],"key":"GV7xtER3Bt"}],"key":"I6M2Kr5mFl"}],"key":"wiM7Bu6pS3"}],"data":{"type":"notebook-content"},"key":"ZfurC1w2Ri"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"apparent_resistivity = dc_utils.apparent_resistivity_from_voltage(\n    dc_data.survey, dc_data.dobs\n)\nrho0 = np.median(apparent_resistivity)\nm0 = np.ones(mesh.nC) * np.log(rho0)\n# Run inversion\nmopt = inv.run(m0)","key":"WFQG95YQQ4"},{"type":"output","id":"0AU-hTTCCkEixSHsnWsiJ","data":[{"name":"stdout","output_type":"stream","text":"SimPEG.InvProblem will set Regularization.reference_model to m0.\nSimPEG.InvProblem will set Regularization.reference_model to m0.\nSimPEG.InvProblem will set Regularization.reference_model to m0.\nSimPEG.InvProblem will set Regularization.reference_model to m0.\nSimPEG.InvProblem will set Regularization.reference_model to m0.\n\n                        SimPEG.InvProblem is setting bfgsH0 to the inverse of the eval2Deriv.\n                        ***Done using same Solver, and solver_opts as the Simulation2DNodal problem***\n                        \nmodel has any nan: 0\n============================ Inexact Gauss Newton ============================\n  #     beta     phi_d     phi_m       f      |proj(x-g)-x|  LS    Comment   \n-----------------------------------------------------------------------------\nx0 has any nan: 0\n   0  7.54e+00  9.17e+03  0.00e+00  9.17e+03    3.14e+03      0              \n   1  7.54e+00  1.86e+03  4.92e+01  2.24e+03    4.76e+02      0              \n   2  7.54e+00  6.81e+02  1.11e+02  1.51e+03    6.74e+01      0   Skip BFGS  \n   3  7.54e+00  5.80e+02  1.19e+02  1.48e+03    1.29e+01      0   Skip BFGS  \n   4  7.54e+00  5.49e+02  1.23e+02  1.48e+03    4.21e+00      0   Skip BFGS  \n   5  7.54e+00  5.47e+02  1.23e+02  1.48e+03    2.95e+00      0              \n   6  7.54e+00  5.45e+02  1.24e+02  1.48e+03    2.64e+00      0              \n   7  7.54e+00  5.45e+02  1.24e+02  1.48e+03    2.45e+00      0              \n   8  7.54e+00  5.45e+02  1.24e+02  1.48e+03    2.22e+00      0              \n   9  7.54e+00  5.44e+02  1.24e+02  1.48e+03    1.88e+00      0              \n  10  7.54e+00  5.46e+02  1.24e+02  1.48e+03    1.60e+00      0              \n  11  7.54e+00  5.44e+02  1.24e+02  1.48e+03    1.08e+00      0              \n  12  7.54e+00  5.45e+02  1.24e+02  1.48e+03    8.76e-01      0              \n  13  7.54e+00  5.44e+02  1.24e+02  1.48e+03    7.13e-01      0              \n  14  7.54e+00  5.45e+02  1.24e+02  1.48e+03    6.15e-01      0              \n  15  7.54e+00  5.44e+02  1.24e+02  1.48e+03    5.47e-01      0              \n  16  7.54e+00  5.44e+02  1.24e+02  1.48e+03    5.31e-01      0              \n  17  7.54e+00  5.44e+02  1.24e+02  1.48e+03    4.72e-02      1              \n------------------------- STOP! -------------------------\n1 : |fc-fOld| = 3.4446e-03 \u003c= tolF*(1+|f0|) = 9.1722e+02\n1 : |xc-x_last| = 1.4126e-02 \u003c= tolX*(1+|x0|) = 3.0775e+01\n1 : |proj(x-g)-x|    = 4.7157e-02 \u003c= tolG          = 1.0000e-01\n0 : |proj(x-g)-x|    = 4.7157e-02 \u003c= 1e3*eps       = 1.0000e-02\n0 : maxIter   =      20    \u003c= iter          =     17\n------------------------- DONE! -------------------------\n"}],"key":"kQbJW4Fiyz"}],"data":{"type":"notebook-code","scrolled":true},"key":"clUSosYXjl"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Inversion: Show solution","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aYmI6G6wSg"}],"key":"wmHsEhpRcR"}],"key":"IcJU2fC900"}],"key":"mTbWexpSY1"}],"data":{"type":"notebook-content"},"key":"e8OTqXQmda"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"def load_leapfrog_geologic_section(filename=\"./century/geologic_section.csv\"):\n    \"\"\"Load the geologic cross section.\"\"\"\n    fid = open(filename, \"r\")\n    lines = fid.readlines()\n    data = []\n    data_tmp = []\n    for line in lines[2:]:\n        line_data = line.split(\",\")[:3]\n        if \"End\" in line:\n            data.append(np.vstack(data_tmp)[:, [0, 2]])\n            data_tmp = []\n        else:\n            data_tmp.append(np.array(line_data, dtype=float))\n    return data","key":"LevpcgqWku"},{"type":"output","id":"FTsMz6UosBn51N0ufk9fC","data":[],"key":"BQzP6imhP6"}],"data":{"type":"notebook-code"},"key":"PTrhhqRt2j"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"geologic_section = load_leapfrog_geologic_section()","key":"euB5viL2cB"},{"type":"output","id":"J4NfuJJAopcoL-gXo5hMb","data":[],"key":"jNT0KX0sOe"}],"data":{"type":"notebook-code"},"key":"NnaLanPCwn"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(1, 1, figsize=(10, 5))\nrho = mapping * mopt\nnorm = LogNorm(vmin=1e1, vmax=1e3)\n\nout = mesh.plot_image(\n    rho,\n    pcolor_opts={\"norm\": norm, \"cmap\": \"Spectral\"},\n    ax=ax,\n)\n\nfor data in geologic_section:\n    ax.plot(data[:, 0], data[:, 1], \"k--\", alpha=0.5)\n\nax.set_xlim(core_domain_x)\nax.set_ylim((-400, 0))\ncb = plt.colorbar(out[0], fraction=0.05,\n                  orientation=\"horizontal\", ax=ax, pad=0.2)\ncb.set_label(\"Resistivity ($\\\\Omega$m)\")\nax.set_xlabel(\"Easting (m)\")\nax.set_ylabel(\"Elevation (m)\")\nax.set_aspect(1.5)  # some vertical exxageration\nplt.tight_layout()","key":"n7gawOuy04"},{"type":"output","id":"JS9C2QCR_41F3kqR9FOON","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9e223b7194a3a233bbb8cead25651b8a","path":"/user-tutorials/build/9e223b7194a3a233bbb8cead25651b8a.png"},"text/plain":{"content":"\u003cFigure size 1000x500 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"wIlpTkNUpb"}],"data":{"type":"notebook-code"},"key":"OFqv96kF32"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Sensitivity analysis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p7TV6JUu9g"}],"identifier":"sensitivity-analysis","label":"Sensitivity analysis","html_id":"sensitivity-analysis","implicit":true,"key":"kmHusI69Et"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The sensitivity matrix for the DC inverse problem just formulated is defined as\n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"g04lxE0VCH"}],"key":"rzCuW3E8Im"},{"type":"math","value":"\nJ_{ij} = \\frac{\\partial d_i}{\\partial ln \\sigma_j}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003eJ\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmi\u003ej\u003c/mi\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmsub\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi mathvariant=\"normal\"\u003e∂\u003c/mi\u003e\u003cmi\u003el\u003c/mi\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmsub\u003e\u003cmi\u003eσ\u003c/mi\u003e\u003cmi\u003ej\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\nJ_{ij} = \\frac{\\partial d_i}{\\partial ln \\sigma_j}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.09618em;\"\u003eJ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\"\u003eij\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.3435em;vertical-align:-0.9721em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3714em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.01968em;\"\u003el\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eσ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\" style=\"margin-right:0.05556em;\"\u003e∂\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9721em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"8","key":"LOLQiOnmCW"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"\nwhere ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"npJGOhGxB7"},{"type":"inlineMath","value":"d_i","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ed_i\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"wnHNJnASM2"},{"type":"text","value":" correspond to the ith data functional and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PA9gbQthtx"},{"type":"inlineMath","value":"\\sigma_j","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003eσ\u003c/mi\u003e\u003cmi\u003ej\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\sigma_j\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eσ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"T9tMjjRuuz"},{"type":"text","value":" is the electrical conductivity in the jth cell of our mesh.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SCIPqxmM9U"}],"key":"OAkBiFSvCg"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"SimPEG simulation classes offer a method called getJ which we will use to have access to the sensitivity matrix. With ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"oU49f7Dm8L"},{"type":"inlineMath","value":"J","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eJ\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eJ\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.09618em;\"\u003eJ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"zJqp0R2nDO"},{"type":"text","value":" in our hands we can explore its content in a number of different ways as illustrated in the sections below.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"rNuAA4GVmH"}],"key":"V0kdURIIEE"}],"data":{"type":"notebook-content"},"key":"pq78KzCgHv"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Get the sensitivity matrix","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EcezwobQq9"}],"key":"HolmFFA3G4"}],"key":"fBuXCkhGjl"}],"key":"S3avrMkzwq"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The first step is to get a copy of the sensitivity matrix ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BMnx8jzh8W"},{"type":"inlineMath","value":"J","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eJ\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eJ\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.09618em;\"\u003eJ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"TuMZQzvGzk"},{"type":"text","value":", what we can acomplish by calling the method getJ().","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"G5YzRqhM5W"}],"key":"Vz5vI4HPBy"}],"data":{"type":"notebook-content"},"key":"VdnQrFpQ0i"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"simulation_dc._Jmatrix = None  # Force computation of new sensitivity matrix\nJ = simulation_dc.getJ(mopt).copy()","key":"XkWI7Kxetq"},{"type":"output","id":"GRZxwy67XBETmMvSkDuDy","data":[],"key":"oB5NvP09no"}],"data":{"type":"notebook-code"},"key":"ZNgI59VjOb"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Average sensitivity","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HJkI5NQzLL"}],"key":"Wor5rUUKJg"}],"key":"kDQGlRC6zs"}],"key":"QpTQhot0i0"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"There are many different ways in which we could look at the information contained in ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aerwctcXxN"},{"type":"inlineMath","value":"J","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eJ\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eJ\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.09618em;\"\u003eJ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"wOvVruPdKz"},{"type":"text","value":". Let’s use the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"d5ovXKYPHc"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"average sensitivity","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aRsZTiawYE"}],"key":"GbFWay0LlF"},{"type":"text","value":" ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FZYuhV9Hzl"},{"type":"inlineMath","value":"s_j","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003es\u003c/mi\u003e\u003cmi\u003ej\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003es_j\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003es\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"nsQgr3aiuy"},{"type":"text","value":" as defined in ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TYUWTDYGYN"},{"type":"cite","kind":"narrative","label":"Devriese_2016","identifier":"https://doi.org/10.1190/segam2016-13842655.1","children":[{"type":"text","value":"Devriese \u0026 Oldenburg (2016)","key":"t8nNHmCwH3"}],"key":"afOgqQXrzU"},{"type":"text","value":",\n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oEjfTmoiVz"}],"key":"tX9HuKbCf1"},{"type":"math","value":"\ns_j = \\frac{1}{nV_j}\\sum_{i=1}^n\\left|J_{ij}\\right|.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003es\u003c/mi\u003e\u003cmi\u003ej\u003c/mi\u003e\u003c/msub\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmfrac\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmsub\u003e\u003cmi\u003eV\u003c/mi\u003e\u003cmi\u003ej\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003cmunderover\u003e\u003cmo\u003e∑\u003c/mo\u003e\u003cmrow\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003c/munderover\u003e\u003cmrow\u003e\u003cmo fence=\"true\"\u003e∣\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003eJ\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmi\u003ej\u003c/mi\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003cmo fence=\"true\"\u003e∣\u003c/mo\u003e\u003c/mrow\u003e\u003cmi mathvariant=\"normal\"\u003e.\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\ns_j = \\frac{1}{nV_j}\\sum_{i=1}^n\\left|J_{ij}\\right|.\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003es\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.9291em;vertical-align:-1.2777em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3214em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.22222em;\"\u003eV\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9721em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mop op-limits\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.6514em;\"\u003e\u003cspan style=\"top:-1.8723em;margin-left:0em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.05em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003cspan class=\"mrel mtight\"\u003e=\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.05em;\"\u003e\u003c/span\u003e\u003cspan\u003e\u003cspan class=\"mop op-symbol large-op\"\u003e∑\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-4.3em;margin-left:0em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.05em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.2777em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"minner\"\u003e\u003cspan class=\"mopen delimcenter\" style=\"top:0em;\"\u003e∣\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.09618em;\"\u003eJ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\"\u003eij\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose delimcenter\" style=\"top:0em;\"\u003e∣\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e.\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"9","key":"qb2diakwWw"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"\nIt will give us a global qualitative/semi-quantitative view on how the survey layout defined for this inversion problem is sampling the subsurface in the region of interest.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kVcN25r6NF"}],"key":"ylq3stMCZM"}],"data":{"type":"notebook-content"},"key":"bNLMcZTHRN"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"##\n# Define the average sensitivity sj\nVj = mesh.cell_volumes\nn, m = J.shape\nsj = np.log10(np.divide(np.sum(abs(J), axis=0), n * Vj))","key":"x3HFvGLwHy"},{"type":"output","id":"O3JSxR9T9m7SgLjXbpxnx","data":[],"key":"ZUSo3DC05s"}],"data":{"type":"notebook-code"},"key":"QEY5Aa5zpe"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"# Plot\nfig, ax = plt.subplots(1, 1, figsize=(10, 5))\nplt.jet()\nout = mesh.plot_image(sj, ax=ax)\n\nfor data in geologic_section:\n    ax.plot(data[:, 0], data[:, 1], \"k--\", alpha=0.5)\n\nax.set_xlim(core_domain_x)\nax.set_ylim((-400, 0))\ncb = plt.colorbar(out[0], fraction=0.05,\n                  orientation=\"horizontal\", ax=ax, pad=0.2)\ncb.set_label(\"Average sensitivity\")\nax.set_xlabel(\"Easting (m)\")\nax.set_ylabel(\"Elevation (m)\")\nax.set_aspect(1.5)  # some vertical exxageration\nplt.tight_layout()","key":"chw8Z4mV2C"},{"type":"output","id":"qoIe2AHLCEHux4VTvzPEE","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ba8c3a9dab3315bf14799c2eaa65c082","path":"/user-tutorials/build/ba8c3a9dab3315bf14799c2eaa65c082.png"},"text/plain":{"content":"\u003cFigure size 1000x500 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"qesUNkrwVN"}],"data":{"type":"notebook-code"},"key":"ETNy0rInDm"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Conclusions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fXWTRsdKuY"}],"identifier":"conclusions","label":"Conclusions","html_id":"conclusions","implicit":true,"key":"QYFrCGI4oS"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this tutorial we used the resources avaiable in SimPEG for computing and ploting the sensitivity matrix. We used the DC resistivity problem as a motivation example and analysed the sensitivity patterns for a homogeneous half space using two different survey layouts. We also applied this technique for a DC resistivity real data inversion scenario. This kind of analysis can help us decide upon the most appropriate electrode array to use for a particular exploration project. It is also a valuable tool to have in our toolbox for performing the assessment of the solutions obtained after the application of some inversion algorithm as illustrated by the real case example.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lAz4kPSYQv"}],"key":"unSC32doAm"}],"data":{"type":"notebook-content"},"key":"adrOIRtz5w"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Acknowledgements","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hZVTgIqUb5"}],"identifier":"acknowledgements","label":"Acknowledgements","html_id":"acknowledgements","implicit":true,"key":"Zwjr0cUajh"}],"data":{"type":"notebook-content"},"key":"zWEG7X4jnM"}],"key":"rp8TElCiUr"},"references":{"cite":{"order":["Furman_2003","Devriese_2016"],"data":{"Furman_2003":{"number":1,"doi":"10.2136/vzj2003.4160","html":"Furman, A., Ferré, T. P. A., \u0026 Warrick, A. W. (2003). A Sensitivity Analysis of Electrical Resistivity Tomography Array Types Using Analytical Element Modeling. \u003ci\u003eVadose Zone Journal\u003c/i\u003e, \u003ci\u003e2\u003c/i\u003e(3), 416–423. \u003ca target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.2136/vzj2003.4160\"\u003e10.2136/vzj2003.4160\u003c/a\u003e"},"Devriese_2016":{"number":2,"doi":"10.1190/segam2016-13842655.1","html":"Devriese, S., \u0026 Oldenburg, D. (2016, September). Application of sensitivity analysis in DC resistivity monitoring of SAGD steam chambers. \u003ci\u003eSEG Technical Program Expanded Abstracts 2016\u003c/i\u003e. \u003ca target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1190/segam2016-13842655.1\"\u003e10.1190/segam2016-13842655.1\u003c/a\u003e"}}}},"footer":{"navigation":{"prev":{"title":"Uncertainty and Resolution analysis","url":"/uran-index","group":"SimPEG User Tutorials"}}},"domain":"http://localhost:3000"}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":false,"v2_headers":true,"v2_meta":false,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/user-tutorials/build/manifest-FDC5A112.js";
import * as route0 from "/user-tutorials/build/root-2CYAF5SQ.js";
import * as route1 from "/user-tutorials/build/routes/$-ZDWRJY4B.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/user-tutorials/build/entry.client-K6EYMIDZ.js");</script></body></html>